<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">

<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1"/>
  <meta name="generator" content="distill" />

  <style type="text/css">
  /* Hide doc at startup (prevent jankiness while JS renders/transforms) */
  body {
    visibility: hidden;
  }
  </style>

 <!--radix_placeholder_import_source-->
 <!--/radix_placeholder_import_source-->

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ad0000; } /* Alert */
code span.an { color: #5e5e5e; } /* Annotation */
code span.at { color: #20794d; } /* Attribute */
code span.bn { color: #ad0000; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007ba5; } /* ControlFlow */
code span.ch { color: #20794d; } /* Char */
code span.cn { color: #8f5902; } /* Constant */
code span.co { color: #5e5e5e; } /* Comment */
code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
code span.dt { color: #ad0000; } /* DataType */
code span.dv { color: #ad0000; } /* DecVal */
code span.er { color: #ad0000; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #ad0000; } /* Float */
code span.fu { color: #4758ab; } /* Function */
code span.im { } /* Import */
code span.in { color: #5e5e5e; } /* Information */
code span.kw { color: #007ba5; } /* Keyword */
code span.op { color: #5e5e5e; } /* Operator */
code span.ot { color: #007ba5; } /* Other */
code span.pp { color: #ad0000; } /* Preprocessor */
code span.sc { color: #20794d; } /* SpecialChar */
code span.ss { color: #20794d; } /* SpecialString */
code span.st { color: #20794d; } /* String */
code span.va { color: #111111; } /* Variable */
code span.vs { color: #20794d; } /* VerbatimString */
code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
</style>

  <!--radix_placeholder_meta_tags-->
  <title>Tan's Advent of Code: Solutions for AOC 2020</title>

  <meta property="description" itemprop="description" content="My first Advent of Code!"/>



  <!--  https://developers.facebook.com/docs/sharing/webmasters#markup -->
  <meta property="og:title" content="Tan&#39;s Advent of Code: Solutions for AOC 2020"/>
  <meta property="og:type" content="article"/>
  <meta property="og:description" content="My first Advent of Code!"/>
  <meta property="og:locale" content="en_US"/>
  <meta property="og:site_name" content="Tan&#39;s Advent of Code"/>

  <!--  https://dev.twitter.com/cards/types/summary -->
  <meta property="twitter:card" content="summary"/>
  <meta property="twitter:title" content="Tan&#39;s Advent of Code: Solutions for AOC 2020"/>
  <meta property="twitter:description" content="My first Advent of Code!"/>

  <!--/radix_placeholder_meta_tags-->
  <!--radix_placeholder_rmarkdown_metadata-->

  <script type="text/json" id="radix-rmarkdown-metadata">
  {"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["title","description"]}},"value":[{"type":"character","attributes":{},"value":["Solutions for AOC 2020"]},{"type":"character","attributes":{},"value":["My first Advent of Code!"]}]}
  </script>
  <!--/radix_placeholder_rmarkdown_metadata-->
  <!--radix_placeholder_navigation_in_header-->
  <meta name="distill:offset" content=""/>

  <script type="application/javascript">

    window.headroom_prevent_pin = false;

    window.document.addEventListener("DOMContentLoaded", function (event) {

      // initialize headroom for banner
      var header = $('header').get(0);
      var headerHeight = header.offsetHeight;
      var headroom = new Headroom(header, {
        tolerance: 5,
        onPin : function() {
          if (window.headroom_prevent_pin) {
            window.headroom_prevent_pin = false;
            headroom.unpin();
          }
        }
      });
      headroom.init();
      if(window.location.hash)
        headroom.unpin();
      $(header).addClass('headroom--transition');

      // offset scroll location for banner on hash change
      // (see: https://github.com/WickyNilliams/headroom.js/issues/38)
      window.addEventListener("hashchange", function(event) {
        window.scrollTo(0, window.pageYOffset - (headerHeight + 25));
      });

      // responsive menu
      $('.distill-site-header').each(function(i, val) {
        var topnav = $(this);
        var toggle = topnav.find('.nav-toggle');
        toggle.on('click', function() {
          topnav.toggleClass('responsive');
        });
      });

      // nav dropdowns
      $('.nav-dropbtn').click(function(e) {
        $(this).next('.nav-dropdown-content').toggleClass('nav-dropdown-active');
        $(this).parent().siblings('.nav-dropdown')
           .children('.nav-dropdown-content').removeClass('nav-dropdown-active');
      });
      $("body").click(function(e){
        $('.nav-dropdown-content').removeClass('nav-dropdown-active');
      });
      $(".nav-dropdown").click(function(e){
        e.stopPropagation();
      });
    });
  </script>

  <style type="text/css">

  /* Theme (user-documented overrideables for nav appearance) */

  .distill-site-nav {
    color: rgba(255, 255, 255, 0.8);
    background-color: #0F2E3D;
    font-size: 15px;
    font-weight: 300;
  }

  .distill-site-nav a {
    color: inherit;
    text-decoration: none;
  }

  .distill-site-nav a:hover {
    color: white;
  }

  @media print {
    .distill-site-nav {
      display: none;
    }
  }

  .distill-site-header {

  }

  .distill-site-footer {

  }


  /* Site Header */

  .distill-site-header {
    width: 100%;
    box-sizing: border-box;
    z-index: 3;
  }

  .distill-site-header .nav-left {
    display: inline-block;
    margin-left: 8px;
  }

  @media screen and (max-width: 768px) {
    .distill-site-header .nav-left {
      margin-left: 0;
    }
  }


  .distill-site-header .nav-right {
    float: right;
    margin-right: 8px;
  }

  .distill-site-header a,
  .distill-site-header .title {
    display: inline-block;
    text-align: center;
    padding: 14px 10px 14px 10px;
  }

  .distill-site-header .title {
    font-size: 18px;
    min-width: 150px;
  }

  .distill-site-header .logo {
    padding: 0;
  }

  .distill-site-header .logo img {
    display: none;
    max-height: 20px;
    width: auto;
    margin-bottom: -4px;
  }

  .distill-site-header .nav-image img {
    max-height: 18px;
    width: auto;
    display: inline-block;
    margin-bottom: -3px;
  }



  @media screen and (min-width: 1000px) {
    .distill-site-header .logo img {
      display: inline-block;
    }
    .distill-site-header .nav-left {
      margin-left: 20px;
    }
    .distill-site-header .nav-right {
      margin-right: 20px;
    }
    .distill-site-header .title {
      padding-left: 12px;
    }
  }


  .distill-site-header .nav-toggle {
    display: none;
  }

  .nav-dropdown {
    display: inline-block;
    position: relative;
  }

  .nav-dropdown .nav-dropbtn {
    border: none;
    outline: none;
    color: rgba(255, 255, 255, 0.8);
    padding: 16px 10px;
    background-color: transparent;
    font-family: inherit;
    font-size: inherit;
    font-weight: inherit;
    margin: 0;
    margin-top: 1px;
    z-index: 2;
  }

  .nav-dropdown-content {
    display: none;
    position: absolute;
    background-color: white;
    min-width: 200px;
    border: 1px solid rgba(0,0,0,0.15);
    border-radius: 4px;
    box-shadow: 0px 8px 16px 0px rgba(0,0,0,0.1);
    z-index: 1;
    margin-top: 2px;
    white-space: nowrap;
    padding-top: 4px;
    padding-bottom: 4px;
  }

  .nav-dropdown-content hr {
    margin-top: 4px;
    margin-bottom: 4px;
    border: none;
    border-bottom: 1px solid rgba(0, 0, 0, 0.1);
  }

  .nav-dropdown-active {
    display: block;
  }

  .nav-dropdown-content a, .nav-dropdown-content .nav-dropdown-header {
    color: black;
    padding: 6px 24px;
    text-decoration: none;
    display: block;
    text-align: left;
  }

  .nav-dropdown-content .nav-dropdown-header {
    display: block;
    padding: 5px 24px;
    padding-bottom: 0;
    text-transform: uppercase;
    font-size: 14px;
    color: #999999;
    white-space: nowrap;
  }

  .nav-dropdown:hover .nav-dropbtn {
    color: white;
  }

  .nav-dropdown-content a:hover {
    background-color: #ddd;
    color: black;
  }

  .nav-right .nav-dropdown-content {
    margin-left: -45%;
    right: 0;
  }

  @media screen and (max-width: 768px) {
    .distill-site-header a, .distill-site-header .nav-dropdown  {display: none;}
    .distill-site-header a.nav-toggle {
      float: right;
      display: block;
    }
    .distill-site-header .title {
      margin-left: 0;
    }
    .distill-site-header .nav-right {
      margin-right: 0;
    }
    .distill-site-header {
      overflow: hidden;
    }
    .nav-right .nav-dropdown-content {
      margin-left: 0;
    }
  }


  @media screen and (max-width: 768px) {
    .distill-site-header.responsive {position: relative; min-height: 500px; }
    .distill-site-header.responsive a.nav-toggle {
      position: absolute;
      right: 0;
      top: 0;
    }
    .distill-site-header.responsive a,
    .distill-site-header.responsive .nav-dropdown {
      display: block;
      text-align: left;
    }
    .distill-site-header.responsive .nav-left,
    .distill-site-header.responsive .nav-right {
      width: 100%;
    }
    .distill-site-header.responsive .nav-dropdown {float: none;}
    .distill-site-header.responsive .nav-dropdown-content {position: relative;}
    .distill-site-header.responsive .nav-dropdown .nav-dropbtn {
      display: block;
      width: 100%;
      text-align: left;
    }
  }

  /* Site Footer */

  .distill-site-footer {
    width: 100%;
    overflow: hidden;
    box-sizing: border-box;
    z-index: 3;
    margin-top: 30px;
    padding-top: 30px;
    padding-bottom: 30px;
    text-align: center;
  }

  /* Headroom */

  d-title {
    padding-top: 6rem;
  }

  @media print {
    d-title {
      padding-top: 4rem;
    }
  }

  .headroom {
    z-index: 1000;
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
  }

  .headroom--transition {
    transition: all .4s ease-in-out;
  }

  .headroom--unpinned {
    top: -100px;
  }

  .headroom--pinned {
    top: 0;
  }

  /* adjust viewport for navbar height */
  /* helps vertically center bootstrap (non-distill) content */
  .min-vh-100 {
    min-height: calc(100vh - 100px) !important;
  }

  </style>

  <script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
  <link href="site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet"/>
  <link href="site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet"/>
  <script src="site_libs/headroom-0.9.4/headroom.min.js"></script>
  <script src="site_libs/autocomplete-0.37.1/autocomplete.min.js"></script>
  <script src="site_libs/fuse-6.4.1/fuse.min.js"></script>

  <script type="application/javascript">

  function getMeta(metaName) {
    var metas = document.getElementsByTagName('meta');
    for (let i = 0; i < metas.length; i++) {
      if (metas[i].getAttribute('name') === metaName) {
        return metas[i].getAttribute('content');
      }
    }
    return '';
  }

  function offsetURL(url) {
    var offset = getMeta('distill:offset');
    return offset ? offset + '/' + url : url;
  }

  function createFuseIndex() {

    // create fuse index
    var options = {
      keys: [
        { name: 'title', weight: 20 },
        { name: 'categories', weight: 15 },
        { name: 'description', weight: 10 },
        { name: 'contents', weight: 5 },
      ],
      ignoreLocation: true,
      threshold: 0
    };
    var fuse = new window.Fuse([], options);

    // fetch the main search.json
    return fetch(offsetURL('search.json'))
      .then(function(response) {
        if (response.status == 200) {
          return response.json().then(function(json) {
            // index main articles
            json.articles.forEach(function(article) {
              fuse.add(article);
            });
            // download collections and index their articles
            return Promise.all(json.collections.map(function(collection) {
              return fetch(offsetURL(collection)).then(function(response) {
                if (response.status === 200) {
                  return response.json().then(function(articles) {
                    articles.forEach(function(article) {
                      fuse.add(article);
                    });
                  })
                } else {
                  return Promise.reject(
                    new Error('Unexpected status from search index request: ' +
                              response.status)
                  );
                }
              });
            })).then(function() {
              return fuse;
            });
          });

        } else {
          return Promise.reject(
            new Error('Unexpected status from search index request: ' +
                        response.status)
          );
        }
      });
  }

  window.document.addEventListener("DOMContentLoaded", function (event) {

    // get search element (bail if we don't have one)
    var searchEl = window.document.getElementById('distill-search');
    if (!searchEl)
      return;

    createFuseIndex()
      .then(function(fuse) {

        // make search box visible
        searchEl.classList.remove('hidden');

        // initialize autocomplete
        var options = {
          autoselect: true,
          hint: false,
          minLength: 2,
        };
        window.autocomplete(searchEl, options, [{
          source: function(query, callback) {
            const searchOptions = {
              isCaseSensitive: false,
              shouldSort: true,
              minMatchCharLength: 2,
              limit: 10,
            };
            var results = fuse.search(query, searchOptions);
            callback(results
              .map(function(result) { return result.item; })
            );
          },
          templates: {
            suggestion: function(suggestion) {
              var img = suggestion.preview && Object.keys(suggestion.preview).length > 0
                ? `<img src="${offsetURL(suggestion.preview)}"</img>`
                : '';
              var html = `
                <div class="search-item">
                  <h3>${suggestion.title}</h3>
                  <div class="search-item-description">
                    ${suggestion.description || ''}
                  </div>
                  <div class="search-item-preview">
                    ${img}
                  </div>
                </div>
              `;
              return html;
            }
          }
        }]).on('autocomplete:selected', function(event, suggestion) {
          window.location.href = offsetURL(suggestion.path);
        });
        // remove inline display style on autocompleter (we want to
        // manage responsive display via css)
        $('.algolia-autocomplete').css("display", "");
      })
      .catch(function(error) {
        console.log(error);
      });

  });

  </script>

  <style type="text/css">

  .nav-search {
    font-size: x-small;
  }

  /* Algolioa Autocomplete */

  .algolia-autocomplete {
    display: inline-block;
    margin-left: 10px;
    vertical-align: sub;
    background-color: white;
    color: black;
    padding: 6px;
    padding-top: 8px;
    padding-bottom: 0;
    border-radius: 6px;
    border: 1px #0F2E3D solid;
    width: 180px;
  }


  @media screen and (max-width: 768px) {
    .distill-site-nav .algolia-autocomplete {
      display: none;
      visibility: hidden;
    }
    .distill-site-nav.responsive .algolia-autocomplete {
      display: inline-block;
      visibility: visible;
    }
    .distill-site-nav.responsive .algolia-autocomplete .aa-dropdown-menu {
      margin-left: 0;
      width: 400px;
      max-height: 400px;
    }
  }

  .algolia-autocomplete .aa-input, .algolia-autocomplete .aa-hint {
    width: 90%;
    outline: none;
    border: none;
  }

  .algolia-autocomplete .aa-hint {
    color: #999;
  }
  .algolia-autocomplete .aa-dropdown-menu {
    width: 550px;
    max-height: 70vh;
    overflow-x: visible;
    overflow-y: scroll;
    padding: 5px;
    margin-top: 3px;
    margin-left: -150px;
    background-color: #fff;
    border-radius: 5px;
    border: 1px solid #999;
    border-top: none;
  }

  .algolia-autocomplete .aa-dropdown-menu .aa-suggestion {
    cursor: pointer;
    padding: 5px 4px;
    border-bottom: 1px solid #eee;
  }

  .algolia-autocomplete .aa-dropdown-menu .aa-suggestion:last-of-type {
    border-bottom: none;
    margin-bottom: 2px;
  }

  .algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item {
    overflow: hidden;
    font-size: 0.8em;
    line-height: 1.4em;
  }

  .algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item h3 {
    font-size: 1rem;
    margin-block-start: 0;
    margin-block-end: 5px;
  }

  .algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item-description {
    display: inline-block;
    overflow: hidden;
    height: 2.8em;
    width: 80%;
    margin-right: 4%;
  }

  .algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item-preview {
    display: inline-block;
    width: 15%;
  }

  .algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item-preview img {
    height: 3em;
    width: auto;
    display: none;
  }

  .algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item-preview img[src] {
    display: initial;
  }

  .algolia-autocomplete .aa-dropdown-menu .aa-suggestion.aa-cursor {
    background-color: #eee;
  }
  .algolia-autocomplete .aa-dropdown-menu .aa-suggestion em {
    font-weight: bold;
    font-style: normal;
  }

  </style>


  <!--/radix_placeholder_navigation_in_header-->
  <!--radix_placeholder_distill-->

  <style type="text/css">

  body {
    background-color: white;
  }

  .pandoc-table {
    width: 100%;
  }

  .pandoc-table>caption {
    margin-bottom: 10px;
  }

  .pandoc-table th:not([align]) {
    text-align: left;
  }

  .pagedtable-footer {
    font-size: 15px;
  }

  d-byline .byline {
    grid-template-columns: 2fr 2fr;
  }

  d-byline .byline h3 {
    margin-block-start: 1.5em;
  }

  d-byline .byline .authors-affiliations h3 {
    margin-block-start: 0.5em;
  }

  .authors-affiliations .orcid-id {
    width: 16px;
    height:16px;
    margin-left: 4px;
    margin-right: 4px;
    vertical-align: middle;
    padding-bottom: 2px;
  }

  d-title .dt-tags {
    margin-top: 1em;
    grid-column: text;
  }

  .dt-tags .dt-tag {
    text-decoration: none;
    display: inline-block;
    color: rgba(0,0,0,0.6);
    padding: 0em 0.4em;
    margin-right: 0.5em;
    margin-bottom: 0.4em;
    font-size: 70%;
    border: 1px solid rgba(0,0,0,0.2);
    border-radius: 3px;
    text-transform: uppercase;
    font-weight: 500;
  }

  d-article table.gt_table td,
  d-article table.gt_table th {
    border-bottom: none;
  }

  .html-widget {
    margin-bottom: 2.0em;
  }

  .l-screen-inset {
    padding-right: 16px;
  }

  .l-screen .caption {
    margin-left: 10px;
  }

  .shaded {
    background: rgb(247, 247, 247);
    padding-top: 20px;
    padding-bottom: 20px;
    border-top: 1px solid rgba(0, 0, 0, 0.1);
    border-bottom: 1px solid rgba(0, 0, 0, 0.1);
  }

  .shaded .html-widget {
    margin-bottom: 0;
    border: 1px solid rgba(0, 0, 0, 0.1);
  }

  .shaded .shaded-content {
    background: white;
  }

  .text-output {
    margin-top: 0;
    line-height: 1.5em;
  }

  .hidden {
    display: none !important;
  }

  d-article {
    padding-top: 2.5rem;
    padding-bottom: 30px;
  }

  d-appendix {
    padding-top: 30px;
  }

  d-article>p>img {
    width: 100%;
  }

  d-article h2 {
    margin: 1rem 0 1.5rem 0;
  }

  d-article h3 {
    margin-top: 1.5rem;
  }

  d-article iframe {
    border: 1px solid rgba(0, 0, 0, 0.1);
    margin-bottom: 2.0em;
    width: 100%;
  }

  /* Tweak code blocks */

  d-article div.sourceCode code,
  d-article pre code {
    font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
  }

  d-article pre,
  d-article div.sourceCode,
  d-article div.sourceCode pre {
    overflow: auto;
  }

  d-article div.sourceCode {
    background-color: white;
  }

  d-article div.sourceCode pre {
    padding-left: 10px;
    font-size: 12px;
    border-left: 2px solid rgba(0,0,0,0.1);
  }

  d-article pre {
    font-size: 12px;
    color: black;
    background: none;
    margin-top: 0;
    text-align: left;
    white-space: pre;
    word-spacing: normal;
    word-break: normal;
    word-wrap: normal;
    line-height: 1.5;

    -moz-tab-size: 4;
    -o-tab-size: 4;
    tab-size: 4;

    -webkit-hyphens: none;
    -moz-hyphens: none;
    -ms-hyphens: none;
    hyphens: none;
  }

  d-article pre a {
    border-bottom: none;
  }

  d-article pre a:hover {
    border-bottom: none;
    text-decoration: underline;
  }

  d-article details {
    grid-column: text;
    margin-bottom: 0.8em;
  }

  @media(min-width: 768px) {

  d-article pre,
  d-article div.sourceCode,
  d-article div.sourceCode pre {
    overflow: visible !important;
  }

  d-article div.sourceCode pre {
    padding-left: 18px;
    font-size: 14px;
  }

  d-article pre {
    font-size: 14px;
  }

  }

  figure img.external {
    background: white;
    border: 1px solid rgba(0, 0, 0, 0.1);
    box-shadow: 0 1px 8px rgba(0, 0, 0, 0.1);
    padding: 18px;
    box-sizing: border-box;
  }

  /* CSS for d-contents */

  .d-contents {
    grid-column: text;
    color: rgba(0,0,0,0.8);
    font-size: 0.9em;
    padding-bottom: 1em;
    margin-bottom: 1em;
    padding-bottom: 0.5em;
    margin-bottom: 1em;
    padding-left: 0.25em;
    justify-self: start;
  }

  @media(min-width: 1000px) {
    .d-contents.d-contents-float {
      height: 0;
      grid-column-start: 1;
      grid-column-end: 4;
      justify-self: center;
      padding-right: 3em;
      padding-left: 2em;
    }
  }

  .d-contents nav h3 {
    font-size: 18px;
    margin-top: 0;
    margin-bottom: 1em;
  }

  .d-contents li {
    list-style-type: none
  }

  .d-contents nav > ul {
    padding-left: 0;
  }

  .d-contents ul {
    padding-left: 1em
  }

  .d-contents nav ul li {
    margin-top: 0.6em;
    margin-bottom: 0.2em;
  }

  .d-contents nav a {
    font-size: 13px;
    border-bottom: none;
    text-decoration: none
    color: rgba(0, 0, 0, 0.8);
  }

  .d-contents nav a:hover {
    text-decoration: underline solid rgba(0, 0, 0, 0.6)
  }

  .d-contents nav > ul > li > a {
    font-weight: 600;
  }

  .d-contents nav > ul > li > ul {
    font-weight: inherit;
  }

  .d-contents nav > ul > li > ul > li {
    margin-top: 0.2em;
  }


  .d-contents nav ul {
    margin-top: 0;
    margin-bottom: 0.25em;
  }

  .d-article-with-toc h2:nth-child(2) {
    margin-top: 0;
  }


  /* Figure */

  .figure {
    position: relative;
    margin-bottom: 2.5em;
    margin-top: 1.5em;
  }

  .figure img {
    width: 100%;
  }

  .figure .caption {
    color: rgba(0, 0, 0, 0.6);
    font-size: 12px;
    line-height: 1.5em;
  }

  .figure img.external {
    background: white;
    border: 1px solid rgba(0, 0, 0, 0.1);
    box-shadow: 0 1px 8px rgba(0, 0, 0, 0.1);
    padding: 18px;
    box-sizing: border-box;
  }

  .figure .caption a {
    color: rgba(0, 0, 0, 0.6);
  }

  .figure .caption b,
  .figure .caption strong, {
    font-weight: 600;
    color: rgba(0, 0, 0, 1.0);
  }

  /* Citations */

  d-article .citation {
    color: inherit;
    cursor: inherit;
  }

  div.hanging-indent{
    margin-left: 1em; text-indent: -1em;
  }

  /* Citation hover box */

  .tippy-box[data-theme~=light-border] {
    background-color: rgba(250, 250, 250, 0.95);
  }

  .tippy-content > p {
    margin-bottom: 0;
    padding: 2px;
  }


  /* Tweak 1000px media break to show more text */

  @media(min-width: 1000px) {
    .base-grid,
    distill-header,
    d-title,
    d-abstract,
    d-article,
    d-appendix,
    distill-appendix,
    d-byline,
    d-footnote-list,
    d-citation-list,
    distill-footer {
      grid-template-columns: [screen-start] 1fr [page-start kicker-start] 80px [middle-start] 50px [text-start kicker-end] 65px 65px 65px 65px 65px 65px 65px 65px [text-end gutter-start] 65px [middle-end] 65px [page-end gutter-end] 1fr [screen-end];
      grid-column-gap: 16px;
    }

    .grid {
      grid-column-gap: 16px;
    }

    d-article {
      font-size: 1.06rem;
      line-height: 1.7em;
    }
    figure .caption, .figure .caption, figure figcaption {
      font-size: 13px;
    }
  }

  @media(min-width: 1180px) {
    .base-grid,
    distill-header,
    d-title,
    d-abstract,
    d-article,
    d-appendix,
    distill-appendix,
    d-byline,
    d-footnote-list,
    d-citation-list,
    distill-footer {
      grid-template-columns: [screen-start] 1fr [page-start kicker-start] 60px [middle-start] 60px [text-start kicker-end] 60px 60px 60px 60px 60px 60px 60px 60px [text-end gutter-start] 60px [middle-end] 60px [page-end gutter-end] 1fr [screen-end];
      grid-column-gap: 32px;
    }

    .grid {
      grid-column-gap: 32px;
    }
  }


  /* Get the citation styles for the appendix (not auto-injected on render since
     we do our own rendering of the citation appendix) */

  d-appendix .citation-appendix,
  .d-appendix .citation-appendix {
    font-size: 11px;
    line-height: 15px;
    border-left: 1px solid rgba(0, 0, 0, 0.1);
    padding-left: 18px;
    border: 1px solid rgba(0,0,0,0.1);
    background: rgba(0, 0, 0, 0.02);
    padding: 10px 18px;
    border-radius: 3px;
    color: rgba(150, 150, 150, 1);
    overflow: hidden;
    margin-top: -12px;
    white-space: pre-wrap;
    word-wrap: break-word;
  }

  /* Include appendix styles here so they can be overridden */

  d-appendix {
    contain: layout style;
    font-size: 0.8em;
    line-height: 1.7em;
    margin-top: 60px;
    margin-bottom: 0;
    border-top: 1px solid rgba(0, 0, 0, 0.1);
    color: rgba(0,0,0,0.5);
    padding-top: 60px;
    padding-bottom: 48px;
  }

  d-appendix h3 {
    grid-column: page-start / text-start;
    font-size: 15px;
    font-weight: 500;
    margin-top: 1em;
    margin-bottom: 0;
    color: rgba(0,0,0,0.65);
  }

  d-appendix h3 + * {
    margin-top: 1em;
  }

  d-appendix ol {
    padding: 0 0 0 15px;
  }

  @media (min-width: 768px) {
    d-appendix ol {
      padding: 0 0 0 30px;
      margin-left: -30px;
    }
  }

  d-appendix li {
    margin-bottom: 1em;
  }

  d-appendix a {
    color: rgba(0, 0, 0, 0.6);
  }

  d-appendix > * {
    grid-column: text;
  }

  d-appendix > d-footnote-list,
  d-appendix > d-citation-list,
  d-appendix > distill-appendix {
    grid-column: screen;
  }

  /* Include footnote styles here so they can be overridden */

  d-footnote-list {
    contain: layout style;
  }

  d-footnote-list > * {
    grid-column: text;
  }

  d-footnote-list a.footnote-backlink {
    color: rgba(0,0,0,0.3);
    padding-left: 0.5em;
  }



  /* Anchor.js */

  .anchorjs-link {
    /*transition: all .25s linear; */
    text-decoration: none;
    border-bottom: none;
  }
  *:hover > .anchorjs-link {
    margin-left: -1.125em !important;
    text-decoration: none;
    border-bottom: none;
  }

  /* Social footer */

  .social_footer {
    margin-top: 30px;
    margin-bottom: 0;
    color: rgba(0,0,0,0.67);
  }

  .disqus-comments {
    margin-right: 30px;
  }

  .disqus-comment-count {
    border-bottom: 1px solid rgba(0, 0, 0, 0.4);
    cursor: pointer;
  }

  #disqus_thread {
    margin-top: 30px;
  }

  .article-sharing a {
    border-bottom: none;
    margin-right: 8px;
  }

  .article-sharing a:hover {
    border-bottom: none;
  }

  .sidebar-section.subscribe {
    font-size: 12px;
    line-height: 1.6em;
  }

  .subscribe p {
    margin-bottom: 0.5em;
  }


  .article-footer .subscribe {
    font-size: 15px;
    margin-top: 45px;
  }


  .sidebar-section.custom {
    font-size: 12px;
    line-height: 1.6em;
  }

  .custom p {
    margin-bottom: 0.5em;
  }

  /* Styles for listing layout (hide title) */
  .layout-listing d-title, .layout-listing .d-title {
    display: none;
  }

  /* Styles for posts lists (not auto-injected) */


  .posts-with-sidebar {
    padding-left: 45px;
    padding-right: 45px;
  }

  .posts-list .description h2,
  .posts-list .description p {
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
  }

  .posts-list .description h2 {
    font-weight: 700;
    border-bottom: none;
    padding-bottom: 0;
  }

  .posts-list h2.post-tag {
    border-bottom: 1px solid rgba(0, 0, 0, 0.2);
    padding-bottom: 12px;
  }
  .posts-list {
    margin-top: 60px;
    margin-bottom: 24px;
  }

  .posts-list .post-preview {
    text-decoration: none;
    overflow: hidden;
    display: block;
    border-bottom: 1px solid rgba(0, 0, 0, 0.1);
    padding: 24px 0;
  }

  .post-preview-last {
    border-bottom: none !important;
  }

  .posts-list .posts-list-caption {
    grid-column: screen;
    font-weight: 400;
  }

  .posts-list .post-preview h2 {
    margin: 0 0 6px 0;
    line-height: 1.2em;
    font-style: normal;
    font-size: 24px;
  }

  .posts-list .post-preview p {
    margin: 0 0 12px 0;
    line-height: 1.4em;
    font-size: 16px;
  }

  .posts-list .post-preview .thumbnail {
    box-sizing: border-box;
    margin-bottom: 24px;
    position: relative;
    max-width: 500px;
  }
  .posts-list .post-preview img {
    width: 100%;
    display: block;
  }

  .posts-list .metadata {
    font-size: 12px;
    line-height: 1.4em;
    margin-bottom: 18px;
  }

  .posts-list .metadata > * {
    display: inline-block;
  }

  .posts-list .metadata .publishedDate {
    margin-right: 2em;
  }

  .posts-list .metadata .dt-authors {
    display: block;
    margin-top: 0.3em;
    margin-right: 2em;
  }

  .posts-list .dt-tags {
    display: block;
    line-height: 1em;
  }

  .posts-list .dt-tags .dt-tag {
    display: inline-block;
    color: rgba(0,0,0,0.6);
    padding: 0.3em 0.4em;
    margin-right: 0.2em;
    margin-bottom: 0.4em;
    font-size: 60%;
    border: 1px solid rgba(0,0,0,0.2);
    border-radius: 3px;
    text-transform: uppercase;
    font-weight: 500;
  }

  .posts-list img {
    opacity: 1;
  }

  .posts-list img[data-src] {
    opacity: 0;
  }

  .posts-more {
    clear: both;
  }


  .posts-sidebar {
    font-size: 16px;
  }

  .posts-sidebar h3 {
    font-size: 16px;
    margin-top: 0;
    margin-bottom: 0.5em;
    font-weight: 400;
    text-transform: uppercase;
  }

  .sidebar-section {
    margin-bottom: 30px;
  }

  .categories ul {
    list-style-type: none;
    margin: 0;
    padding: 0;
  }

  .categories li {
    color: rgba(0, 0, 0, 0.8);
    margin-bottom: 0;
  }

  .categories li>a {
    border-bottom: none;
  }

  .categories li>a:hover {
    border-bottom: 1px solid rgba(0, 0, 0, 0.4);
  }

  .categories .active {
    font-weight: 600;
  }

  .categories .category-count {
    color: rgba(0, 0, 0, 0.4);
  }


  @media(min-width: 768px) {
    .posts-list .post-preview h2 {
      font-size: 26px;
    }
    .posts-list .post-preview .thumbnail {
      float: right;
      width: 30%;
      margin-bottom: 0;
    }
    .posts-list .post-preview .description {
      float: left;
      width: 45%;
    }
    .posts-list .post-preview .metadata {
      float: left;
      width: 20%;
      margin-top: 8px;
    }
    .posts-list .post-preview p {
      margin: 0 0 12px 0;
      line-height: 1.5em;
      font-size: 16px;
    }
    .posts-with-sidebar .posts-list {
      float: left;
      width: 75%;
    }
    .posts-with-sidebar .posts-sidebar {
      float: right;
      width: 20%;
      margin-top: 60px;
      padding-top: 24px;
      padding-bottom: 24px;
    }
  }


  /* Improve display for browsers without grid (IE/Edge <= 15) */

  .downlevel {
    line-height: 1.6em;
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
    margin: 0;
  }

  .downlevel .d-title {
    padding-top: 6rem;
    padding-bottom: 1.5rem;
  }

  .downlevel .d-title h1 {
    font-size: 50px;
    font-weight: 700;
    line-height: 1.1em;
    margin: 0 0 0.5rem;
  }

  .downlevel .d-title p {
    font-weight: 300;
    font-size: 1.2rem;
    line-height: 1.55em;
    margin-top: 0;
  }

  .downlevel .d-byline {
    padding-top: 0.8em;
    padding-bottom: 0.8em;
    font-size: 0.8rem;
    line-height: 1.8em;
  }

  .downlevel .section-separator {
    border: none;
    border-top: 1px solid rgba(0, 0, 0, 0.1);
  }

  .downlevel .d-article {
    font-size: 1.06rem;
    line-height: 1.7em;
    padding-top: 1rem;
    padding-bottom: 2rem;
  }


  .downlevel .d-appendix {
    padding-left: 0;
    padding-right: 0;
    max-width: none;
    font-size: 0.8em;
    line-height: 1.7em;
    margin-bottom: 0;
    color: rgba(0,0,0,0.5);
    padding-top: 40px;
    padding-bottom: 48px;
  }

  .downlevel .footnotes ol {
    padding-left: 13px;
  }

  .downlevel .base-grid,
  .downlevel .distill-header,
  .downlevel .d-title,
  .downlevel .d-abstract,
  .downlevel .d-article,
  .downlevel .d-appendix,
  .downlevel .distill-appendix,
  .downlevel .d-byline,
  .downlevel .d-footnote-list,
  .downlevel .d-citation-list,
  .downlevel .distill-footer,
  .downlevel .appendix-bottom,
  .downlevel .posts-container {
    padding-left: 40px;
    padding-right: 40px;
  }

  @media(min-width: 768px) {
    .downlevel .base-grid,
    .downlevel .distill-header,
    .downlevel .d-title,
    .downlevel .d-abstract,
    .downlevel .d-article,
    .downlevel .d-appendix,
    .downlevel .distill-appendix,
    .downlevel .d-byline,
    .downlevel .d-footnote-list,
    .downlevel .d-citation-list,
    .downlevel .distill-footer,
    .downlevel .appendix-bottom,
    .downlevel .posts-container {
    padding-left: 150px;
    padding-right: 150px;
    max-width: 900px;
  }
  }

  .downlevel pre code {
    display: block;
    border-left: 2px solid rgba(0, 0, 0, .1);
    padding: 0 0 0 20px;
    font-size: 14px;
  }

  .downlevel code, .downlevel pre {
    color: black;
    background: none;
    font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
    text-align: left;
    white-space: pre;
    word-spacing: normal;
    word-break: normal;
    word-wrap: normal;
    line-height: 1.5;

    -moz-tab-size: 4;
    -o-tab-size: 4;
    tab-size: 4;

    -webkit-hyphens: none;
    -moz-hyphens: none;
    -ms-hyphens: none;
    hyphens: none;
  }

  .downlevel .posts-list .post-preview {
    color: inherit;
  }



  </style>

  <script type="application/javascript">

  function is_downlevel_browser() {
    if (bowser.isUnsupportedBrowser({ msie: "12", msedge: "16"},
                                   window.navigator.userAgent)) {
      return true;
    } else {
      return window.load_distill_framework === undefined;
    }
  }

  // show body when load is complete
  function on_load_complete() {

    // add anchors
    if (window.anchors) {
      window.anchors.options.placement = 'left';
      window.anchors.add('d-article > h2, d-article > h3, d-article > h4, d-article > h5');
    }


    // set body to visible
    document.body.style.visibility = 'visible';

    // force redraw for leaflet widgets
    if (window.HTMLWidgets) {
      var maps = window.HTMLWidgets.findAll(".leaflet");
      $.each(maps, function(i, el) {
        var map = this.getMap();
        map.invalidateSize();
        map.eachLayer(function(layer) {
          if (layer instanceof L.TileLayer)
            layer.redraw();
        });
      });
    }

    // trigger 'shown' so htmlwidgets resize
    $('d-article').trigger('shown');
  }

  function init_distill() {

    init_common();

    // create front matter
    var front_matter = $('<d-front-matter></d-front-matter>');
    $('#distill-front-matter').wrap(front_matter);

    // create d-title
    $('.d-title').changeElementType('d-title');

    // create d-byline
    var byline = $('<d-byline></d-byline>');
    $('.d-byline').replaceWith(byline);

    // create d-article
    var article = $('<d-article></d-article>');
    $('.d-article').wrap(article).children().unwrap();

    // move posts container into article
    $('.posts-container').appendTo($('d-article'));

    // create d-appendix
    $('.d-appendix').changeElementType('d-appendix');

    // flag indicating that we have appendix items
    var appendix = $('.appendix-bottom').children('h3').length > 0;

    // replace footnotes with <d-footnote>
    $('.footnote-ref').each(function(i, val) {
      appendix = true;
      var href = $(this).attr('href');
      var id = href.replace('#', '');
      var fn = $('#' + id);
      var fn_p = $('#' + id + '>p');
      fn_p.find('.footnote-back').remove();
      var text = fn_p.html();
      var dtfn = $('<d-footnote></d-footnote>');
      dtfn.html(text);
      $(this).replaceWith(dtfn);
    });
    // remove footnotes
    $('.footnotes').remove();

    // move refs into #references-listing
    $('#references-listing').replaceWith($('#refs'));

    $('h1.appendix, h2.appendix').each(function(i, val) {
      $(this).changeElementType('h3');
    });
    $('h3.appendix').each(function(i, val) {
      var id = $(this).attr('id');
      $('.d-contents a[href="#' + id + '"]').parent().remove();
      appendix = true;
      $(this).nextUntil($('h1, h2, h3')).addBack().appendTo($('d-appendix'));
    });

    // show d-appendix if we have appendix content
    $("d-appendix").css('display', appendix ? 'grid' : 'none');

    // localize layout chunks to just output
    $('.layout-chunk').each(function(i, val) {

      // capture layout
      var layout = $(this).attr('data-layout');

      // apply layout to markdown level block elements
      var elements = $(this).children().not('details, div.sourceCode, pre, script');
      elements.each(function(i, el) {
        var layout_div = $('<div class="' + layout + '"></div>');
        if (layout_div.hasClass('shaded')) {
          var shaded_content = $('<div class="shaded-content"></div>');
          $(this).wrap(shaded_content);
          $(this).parent().wrap(layout_div);
        } else {
          $(this).wrap(layout_div);
        }
      });


      // unwrap the layout-chunk div
      $(this).children().unwrap();
    });

    // remove code block used to force  highlighting css
    $('.distill-force-highlighting-css').parent().remove();

    // remove empty line numbers inserted by pandoc when using a
    // custom syntax highlighting theme
    $('code.sourceCode a:empty').remove();

    // load distill framework
    load_distill_framework();

    // wait for window.distillRunlevel == 4 to do post processing
    function distill_post_process() {

      if (!window.distillRunlevel || window.distillRunlevel < 4)
        return;

      // hide author/affiliations entirely if we have no authors
      var front_matter = JSON.parse($("#distill-front-matter").html());
      var have_authors = front_matter.authors && front_matter.authors.length > 0;
      if (!have_authors)
        $('d-byline').addClass('hidden');

      // article with toc class
      $('.d-contents').parent().addClass('d-article-with-toc');

      // strip links that point to #
      $('.authors-affiliations').find('a[href="#"]').removeAttr('href');

      // add orcid ids
      $('.authors-affiliations').find('.author').each(function(i, el) {
        var orcid_id = front_matter.authors[i].orcidID;
        if (orcid_id) {
          var a = $('<a></a>');
          a.attr('href', 'https://orcid.org/' + orcid_id);
          var img = $('<img></img>');
          img.addClass('orcid-id');
          img.attr('alt', 'ORCID ID');
          img.attr('src','data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo1N0NEMjA4MDI1MjA2ODExOTk0QzkzNTEzRjZEQTg1NyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozM0NDOEJGNEZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozM0NDOEJGM0ZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkZDN0YxMTc0MDcyMDY4MTE5NUZFRDc5MUM2MUUwNEREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjU3Q0QyMDgwMjUyMDY4MTE5OTRDOTM1MTNGNkRBODU3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+84NovQAAAR1JREFUeNpiZEADy85ZJgCpeCB2QJM6AMQLo4yOL0AWZETSqACk1gOxAQN+cAGIA4EGPQBxmJA0nwdpjjQ8xqArmczw5tMHXAaALDgP1QMxAGqzAAPxQACqh4ER6uf5MBlkm0X4EGayMfMw/Pr7Bd2gRBZogMFBrv01hisv5jLsv9nLAPIOMnjy8RDDyYctyAbFM2EJbRQw+aAWw/LzVgx7b+cwCHKqMhjJFCBLOzAR6+lXX84xnHjYyqAo5IUizkRCwIENQQckGSDGY4TVgAPEaraQr2a4/24bSuoExcJCfAEJihXkWDj3ZAKy9EJGaEo8T0QSxkjSwORsCAuDQCD+QILmD1A9kECEZgxDaEZhICIzGcIyEyOl2RkgwAAhkmC+eAm0TAAAAABJRU5ErkJggg==');
          a.append(img);
          $(this).append(a);
        }
      });

      // hide elements of author/affiliations grid that have no value
      function hide_byline_column(caption) {
        $('d-byline').find('h3:contains("' + caption + '")').parent().css('visibility', 'hidden');
      }

      // affiliations
      var have_affiliations = false;
      for (var i = 0; i<front_matter.authors.length; ++i) {
        var author = front_matter.authors[i];
        if (author.affiliation !== "&nbsp;") {
          have_affiliations = true;
          break;
        }
      }
      if (!have_affiliations)
        $('d-byline').find('h3:contains("Affiliations")').css('visibility', 'hidden');

      // published date
      if (!front_matter.publishedDate)
        hide_byline_column("Published");

      // document object identifier
      var doi = $('d-byline').find('h3:contains("DOI")');
      var doi_p = doi.next().empty();
      if (!front_matter.doi) {
        // if we have a citation and valid citationText then link to that
        if ($('#citation').length > 0 && front_matter.citationText) {
          doi.html('Citation');
          $('<a href="#citation"></a>')
            .text(front_matter.citationText)
            .appendTo(doi_p);
        } else {
          hide_byline_column("DOI");
        }
      } else {
        $('<a></a>')
           .attr('href', "https://doi.org/" + front_matter.doi)
           .html(front_matter.doi)
           .appendTo(doi_p);
      }

       // change plural form of authors/affiliations
      if (front_matter.authors.length === 1) {
        var grid = $('.authors-affiliations');
        grid.children('h3:contains("Authors")').text('Author');
        grid.children('h3:contains("Affiliations")').text('Affiliation');
      }

      // remove d-appendix and d-footnote-list local styles
      $('d-appendix > style:first-child').remove();
      $('d-footnote-list > style:first-child').remove();

      // move appendix-bottom entries to the bottom
      $('.appendix-bottom').appendTo('d-appendix').children().unwrap();
      $('.appendix-bottom').remove();

      // hoverable references
      $('span.citation[data-cites]').each(function() {
        var refHtml = $('#ref-' + $(this).attr('data-cites')).html();
        window.tippy(this, {
          allowHTML: true,
          content: refHtml,
          maxWidth: 500,
          interactive: true,
          interactiveBorder: 10,
          theme: 'light-border',
          placement: 'bottom-start'
        });
      });

      // clear polling timer
      clearInterval(tid);

      // show body now that everything is ready
      on_load_complete();
    }

    var tid = setInterval(distill_post_process, 50);
    distill_post_process();

  }

  function init_downlevel() {

    init_common();

     // insert hr after d-title
    $('.d-title').after($('<hr class="section-separator"/>'));

    // check if we have authors
    var front_matter = JSON.parse($("#distill-front-matter").html());
    var have_authors = front_matter.authors && front_matter.authors.length > 0;

    // manage byline/border
    if (!have_authors)
      $('.d-byline').remove();
    $('.d-byline').after($('<hr class="section-separator"/>'));
    $('.d-byline a').remove();

    // remove toc
    $('.d-contents').remove();

    // move appendix elements
    $('h1.appendix, h2.appendix').each(function(i, val) {
      $(this).changeElementType('h3');
    });
    $('h3.appendix').each(function(i, val) {
      $(this).nextUntil($('h1, h2, h3')).addBack().appendTo($('.d-appendix'));
    });


    // inject headers into references and footnotes
    var refs_header = $('<h3></h3>');
    refs_header.text('References');
    $('#refs').prepend(refs_header);

    var footnotes_header = $('<h3></h3');
    footnotes_header.text('Footnotes');
    $('.footnotes').children('hr').first().replaceWith(footnotes_header);

    // move appendix-bottom entries to the bottom
    $('.appendix-bottom').appendTo('.d-appendix').children().unwrap();
    $('.appendix-bottom').remove();

    // remove appendix if it's empty
    if ($('.d-appendix').children().length === 0)
      $('.d-appendix').remove();

    // prepend separator above appendix
    $('.d-appendix').before($('<hr class="section-separator" style="clear: both"/>'));

    // trim code
    $('pre>code').each(function(i, val) {
      $(this).html($.trim($(this).html()));
    });

    // move posts-container right before article
    $('.posts-container').insertBefore($('.d-article'));

    $('body').addClass('downlevel');

    on_load_complete();
  }


  function init_common() {

    // jquery plugin to change element types
    (function($) {
      $.fn.changeElementType = function(newType) {
        var attrs = {};

        $.each(this[0].attributes, function(idx, attr) {
          attrs[attr.nodeName] = attr.nodeValue;
        });

        this.replaceWith(function() {
          return $("<" + newType + "/>", attrs).append($(this).contents());
        });
      };
    })(jQuery);

    // prevent underline for linked images
    $('a > img').parent().css({'border-bottom' : 'none'});

    // mark non-body figures created by knitr chunks as 100% width
    $('.layout-chunk').each(function(i, val) {
      var figures = $(this).find('img, .html-widget');
      if ($(this).attr('data-layout') !== "l-body") {
        figures.css('width', '100%');
      } else {
        figures.css('max-width', '100%');
        figures.filter("[width]").each(function(i, val) {
          var fig = $(this);
          fig.css('width', fig.attr('width') + 'px');
        });

      }
    });

    // auto-append index.html to post-preview links in file: protocol
    // and in rstudio ide preview
    $('.post-preview').each(function(i, val) {
      if (window.location.protocol === "file:")
        $(this).attr('href', $(this).attr('href') + "index.html");
    });

    // get rid of index.html references in header
    if (window.location.protocol !== "file:") {
      $('.distill-site-header a[href]').each(function(i,val) {
        $(this).attr('href', $(this).attr('href').replace("index.html", "./"));
      });
    }

    // add class to pandoc style tables
    $('tr.header').parent('thead').parent('table').addClass('pandoc-table');
    $('.kable-table').children('table').addClass('pandoc-table');

    // add figcaption style to table captions
    $('caption').parent('table').addClass("figcaption");

    // initialize posts list
    if (window.init_posts_list)
      window.init_posts_list();

    // implmement disqus comment link
    $('.disqus-comment-count').click(function() {
      window.headroom_prevent_pin = true;
      $('#disqus_thread').toggleClass('hidden');
      if (!$('#disqus_thread').hasClass('hidden')) {
        var offset = $(this).offset();
        $(window).resize();
        $('html, body').animate({
          scrollTop: offset.top - 35
        });
      }
    });
  }

  document.addEventListener('DOMContentLoaded', function() {
    if (is_downlevel_browser())
      init_downlevel();
    else
      window.addEventListener('WebComponentsReady', init_distill);
  });

  </script>

  <style type="text/css">
  /* base variables */

  /* Edit the CSS properties in this file to create a custom
     Distill theme. Only edit values in the right column
     for each row; values shown are the CSS defaults.
     To return any property to the default,
     you may set its value to: unset
     All rows must end with a semi-colon.                      */

  /* Optional: embed custom fonts here with `@import`          */
  /* This must remain at the top of this file.                 */



  html {
    /*-- Main font sizes --*/
    --title-size:      50px;
    --body-size:       1.06rem;
    --code-size:       14px;
    --aside-size:      12px;
    --fig-cap-size:    13px;
    /*-- Main font colors --*/
    --title-color:     #000000;
    --header-color:    rgba(0, 0, 0, 0.8);
    --body-color:      rgba(0, 0, 0, 0.8);
    --aside-color:     rgba(0, 0, 0, 0.6);
    --fig-cap-color:   rgba(0, 0, 0, 0.6);
    /*-- Specify custom fonts ~~~ must be imported above   --*/
    --heading-font:    sans-serif;
    --mono-font:       monospace;
    --body-font:       sans-serif;
    --navbar-font:     sans-serif;  /* websites + blogs only */
  }

  /*-- ARTICLE METADATA --*/
  d-byline {
    --heading-size:    0.6rem;
    --heading-color:   rgba(0, 0, 0, 0.5);
    --body-size:       0.8rem;
    --body-color:      rgba(0, 0, 0, 0.8);
  }

  /*-- ARTICLE TABLE OF CONTENTS --*/
  .d-contents {
    --heading-size:    18px;
    --contents-size:   13px;
  }

  /*-- ARTICLE APPENDIX --*/
  d-appendix {
    --heading-size:    15px;
    --heading-color:   rgba(0, 0, 0, 0.65);
    --text-size:       0.8em;
    --text-color:      rgba(0, 0, 0, 0.5);
  }

  /*-- WEBSITE HEADER + FOOTER --*/
  /* These properties only apply to Distill sites and blogs  */

  .distill-site-header {
    --title-size:       18px;
    --text-color:       rgba(255, 255, 255, 0.8);
    --text-size:        15px;
    --hover-color:      white;
    --bkgd-color:       #0F2E3D;
  }

  .distill-site-footer {
    --text-color:       rgba(255, 255, 255, 0.8);
    --text-size:        15px;
    --hover-color:      white;
    --bkgd-color:       #0F2E3D;
  }

  /*-- Additional custom styles --*/
  /* Add any additional CSS rules below                      */
  </style>
  <style type="text/css">
  /* base variables */

  /* Edit the CSS properties in this file to create a custom
     Distill theme. Only edit values in the right column
     for each row; values shown are the CSS defaults.
     To return any property to the default,
     you may set its value to: unset
     All rows must end with a semi-colon.                      */

  /* Optional: embed custom fonts here with `@import`          */
  /* This must remain at the top of this file.                 */

  @import url('https://fonts.googleapis.com/css2?family=Bai+Jamjuree:wght@400;700&family=IBM+Plex+Sans:wght@400;700&family=JetBrains+Mono&display=swap');

  html {
    /*-- Main font sizes --*/
    --title-size:      50px;
    --body-size:       1.06rem;
    --code-size:       14px;
    --aside-size:      12px;
    --fig-cap-size:    13px;
    /*-- Main font colors --*/
    --title-color:     #000000;
    --header-color:    rgba(0, 0, 0, 0.8);
    --body-color:      rgba(0, 0, 0, 0.8);
    --aside-color:     rgba(0, 0, 0, 0.6);
    --fig-cap-color:   rgba(0, 0, 0, 0.6);
    /*-- Specify custom fonts ~~~ must be imported above   --*/
    --heading-font:    'Bai Jamjuree', sans-serif;
    --mono-font:       'Fira Mono', monospace;
    --body-font:       'IBM Plex Sans', sans-serif;
    --navbar-font:     'Bai Jamjuree', sans-serif;  /* websites + blogs only */
  }

  /*-- ARTICLE METADATA --*/
  d-byline {
    --heading-size:    0.6rem;
    --heading-color:   rgba(0, 0, 0, 0.5);
    --body-size:       0.8rem;
    --body-color:      rgba(0, 0, 0, 0.8);
  }

  /*-- ARTICLE TABLE OF CONTENTS --*/
  .d-contents {
    --heading-size:    18px;
    --contents-size:   13px;
  }

  /*-- ARTICLE APPENDIX --*/
  d-appendix {
    --heading-size:    15px;
    --heading-color:   rgba(0, 0, 0, 0.65);
    --text-size:       0.8em;
    --text-color:      rgba(0, 0, 0, 0.5);
  }

  /*-- WEBSITE HEADER + FOOTER --*/
  /* These properties only apply to Distill sites and blogs  */

  .distill-site-header {
    --title-size:       18px;
    --text-color:       rgba(255, 255, 255, 1);
    --text-size:        15px;
    --hover-color:      white;
    --bkgd-color:       #0F2E3D;
  }

  .distill-site-footer {
    --text-color:       rgba(255, 255, 255, 0.8);
    --text-size:        15px;
    --hover-color:      white;
    --bkgd-color:       #0F2E3D;
  }

  /*-- Additional custom styles --*/
  /* Add any additional CSS rules below                      */

  * {
    font-family: 'IBM Plex Sans', sans-serif;
  }

  h1,h2,h3,h4,h5,h6,.d-title,.distill-site-header {
    font-family: 'Bai Jamjuree', sans-serif;
  }

  .rt-search{
    align-self: flex-start;
  }</style>
  <style type="text/css">
  /* base style */

  /* FONT FAMILIES */

  :root {
    --heading-default: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
    --mono-default: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
    --body-default: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
  }

  body,
  .posts-list .post-preview p,
  .posts-list .description p {
    font-family: var(--body-font), var(--body-default);
  }

  h1, h2, h3, h4, h5, h6,
  .posts-list .post-preview h2,
  .posts-list .description h2 {
    font-family: var(--heading-font), var(--heading-default);
  }

  d-article div.sourceCode code,
  d-article pre code {
    font-family: var(--mono-font), var(--mono-default);
  }


  /*-- TITLE --*/
  d-title h1,
  .posts-list > h1 {
    color: var(--title-color, black);
  }

  d-title h1 {
    font-size: var(--title-size, 50px);
  }

  /*-- HEADERS --*/
  d-article h1,
  d-article h2,
  d-article h3,
  d-article h4,
  d-article h5,
  d-article h6 {
    color: var(--header-color, rgba(0, 0, 0, 0.8));
  }

  /*-- BODY --*/
  d-article > p,  /* only text inside of <p> tags */
  d-article > ul, /* lists */
  d-article > ol {
    color: var(--body-color, rgba(0, 0, 0, 0.8));
    font-size: var(--body-size, 1.06rem);
  }


  /*-- CODE --*/
  d-article div.sourceCode code,
  d-article pre code {
    font-size: var(--code-size, 14px);
  }

  /*-- ASIDE --*/
  d-article aside {
    font-size: var(--aside-size, 12px);
    color: var(--aside-color, rgba(0, 0, 0, 0.6));
  }

  /*-- FIGURE CAPTIONS --*/
  figure .caption,
  figure figcaption,
  .figure .caption {
    font-size: var(--fig-cap-size, 13px);
    color: var(--fig-cap-color, rgba(0, 0, 0, 0.6));
  }

  /*-- METADATA --*/
  d-byline h3 {
    font-size: var(--heading-size, 0.6rem);
    color: var(--heading-color, rgba(0, 0, 0, 0.5));
  }

  d-byline {
    font-size: var(--body-size, 0.8rem);
    color: var(--body-color, rgba(0, 0, 0, 0.8));
  }

  d-byline a,
  d-article d-byline a {
    color: var(--body-color, rgba(0, 0, 0, 0.8));
  }

  /*-- TABLE OF CONTENTS --*/
  .d-contents nav h3 {
    font-size: var(--heading-size, 18px);
  }

  .d-contents nav a {
    font-size: var(--contents-size, 13px);
  }

  /*-- APPENDIX --*/
  d-appendix h3 {
    font-size: var(--heading-size, 15px);
    color: var(--heading-color, rgba(0, 0, 0, 0.65));
  }

  d-appendix {
    font-size: var(--text-size, 0.8em);
    color: var(--text-color, rgba(0, 0, 0, 0.5));
  }

  d-appendix d-footnote-list a.footnote-backlink {
    color: var(--text-color, rgba(0, 0, 0, 0.5));
  }

  /*-- WEBSITE HEADER + FOOTER --*/
  .distill-site-header .title {
    font-size: var(--title-size, 18px);
    font-family: var(--navbar-font), var(--heading-default);
  }

  .distill-site-header a,
  .nav-dropdown .nav-dropbtn {
    font-family: var(--navbar-font), var(--heading-default);
  }

  .nav-dropdown .nav-dropbtn {
    color: var(--text-color, rgba(255, 255, 255, 0.8));
    font-size: var(--text-size, 15px);
  }

  .distill-site-header a:hover,
  .nav-dropdown:hover .nav-dropbtn {
    color: var(--hover-color, white);
  }

  .distill-site-header {
    font-size: var(--text-size, 15px);
    color: var(--text-color, rgba(255, 255, 255, 0.8));
    background-color: var(--bkgd-color, #0F2E3D);
  }

  .distill-site-footer {
    font-size: var(--text-size, 15px);
    color: var(--text-color, rgba(255, 255, 255, 0.8));
    background-color: var(--bkgd-color, #0F2E3D);
  }

  .distill-site-footer a:hover {
    color: var(--hover-color, white);
  }</style>
  <!--/radix_placeholder_distill-->
  <script src="site_libs/header-attrs-2.11/header-attrs.js"></script>
  <script src="site_libs/popper-2.6.0/popper.min.js"></script>
  <link href="site_libs/tippy-6.2.7/tippy.css" rel="stylesheet" />
  <link href="site_libs/tippy-6.2.7/tippy-light-border.css" rel="stylesheet" />
  <script src="site_libs/tippy-6.2.7/tippy.umd.min.js"></script>
  <script src="site_libs/anchor-4.2.2/anchor.min.js"></script>
  <script src="site_libs/bowser-1.9.3/bowser.min.js"></script>
  <script src="site_libs/webcomponents-2.0.0/webcomponents.js"></script>
  <script src="site_libs/distill-2.2.21/template.v2.js"></script>
  <!--radix_placeholder_site_in_header-->
  <!--/radix_placeholder_site_in_header-->


</head>

<body>

<!--radix_placeholder_front_matter-->

<script id="distill-front-matter" type="text/json">
{"title":"Solutions for AOC 2020","description":"My first Advent of Code!","authors":[]}
</script>

<!--/radix_placeholder_front_matter-->
<!--radix_placeholder_navigation_before_body-->
<header class="header header--fixed" role="banner">
<nav class="distill-site-nav distill-site-header">
<div class="nav-left">
<a href="index.html" class="title">Tan's Advent of Code</a>
</div>
<div class="nav-right">
<a href="index.html">Home</a>
<a href="2015.html">2015</a>
<a href="2016.html">2016</a>
<a href="2017.html">2017</a>
<a href="2018.html">2018</a>
<a href="2019.html">2019</a>
<a href="2020.html">2020</a>
<a href="2021.html">2021</a>
<a href="https://github.com/tanho63/aoc.elf">aoc.elf</a>
<a href="https://github.com/tanho63/advent_of_code" aria-label="Link to source">
<i class="fab fa-github" aria-hidden="true"></i>
</a>
<a href="javascript:void(0);" class="nav-toggle">&#9776;</a>
</div>
</nav>
</header>
<!--/radix_placeholder_navigation_before_body-->
<!--radix_placeholder_site_before_body-->
<!--/radix_placeholder_site_before_body-->

<div class="d-title">
<h1>Solutions for AOC 2020</h1>
<!--radix_placeholder_categories-->
<!--/radix_placeholder_categories-->
<p><p>My first Advent of Code!</p></p>
</div>


<div class="d-article">
<div class="d-contents d-contents-float">
<nav class="l-text toc figcaption" id="TOC">
<h3>Contents</h3>
<ul>
<li><a href="#solutions">Solutions</a></li>
</ul>
</nav>
</div>
<h1 id="solutions">Solutions</h1>
<div class="layout-chunk" data-layout="l-body">
<h2 id="day-1">Day 1</h2>
<p><a href="https://adventofcode.com/2020/day/1" class="uri">https://adventofcode.com/2020/day/1</a></p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>knitr</span><span class='fu'>::</span><span class='va'><a href='https://rdrr.io/pkg/knitr/man/opts_chunk.html'>opts_chunk</a></span><span class='op'>$</span><span class='fu'>set</span><span class='op'>(</span>echo <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>

<span class='fu'><a href='https://rdrr.io/r/base/message.html'>suppressPackageStartupMessages</a></span><span class='op'>(</span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://tidyverse.tidyverse.org'>tidyverse</a></span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<h3 id="day-1-report-repair">— Day 1: Report Repair —</h3>
<p><a href="https://adventofcode.com/2020/day/1" class="uri">https://adventofcode.com/2020/day/1</a></p>
<blockquote>
<p>Specifically, they need you to <em>find the two entries that sum to <code>2020</code></em> and then multiply those two numbers together.</p>
</blockquote>
<h3 id="data">Data</h3>
<p>Copy-paste + datapasta’s Fiddle Selection. (Thank you, Miles!)</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>input_data</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span>
  <span class='fl'>1630</span>, <span class='fl'>1801</span>, <span class='fl'>1917</span>, <span class='fl'>1958</span>, <span class='fl'>1953</span>, <span class='fl'>1521</span>, <span class='fl'>1990</span>, <span class='fl'>1959</span>, <span class='fl'>1543</span>, <span class='fl'>1798</span>, 
  <span class='fl'>638</span>, <span class='fl'>1499</span>, <span class='fl'>1977</span>, <span class='fl'>1433</span>, <span class='fl'>1532</span>, <span class='fl'>1780</span>, <span class='fl'>1559</span>, <span class='fl'>1866</span>, <span class='fl'>1962</span>, <span class='fl'>1999</span>, 
  <span class='fl'>1623</span>, <span class='fl'>1772</span>, <span class='fl'>1730</span>, <span class='fl'>1670</span>, <span class='fl'>1791</span>, <span class='fl'>1947</span>, <span class='fl'>1961</span>, <span class='fl'>1523</span>, <span class='fl'>959</span>, <span class='fl'>1998</span>, 
  <span class='fl'>1693</span>, <span class='fl'>1490</span>, <span class='fl'>1712</span>, <span class='fl'>910</span>, <span class='fl'>1635</span>, <span class='fl'>1837</span>, <span class='fl'>586</span>, <span class='fl'>1590</span>, <span class='fl'>1741</span>, <span class='fl'>1739</span>, 
  <span class='fl'>1660</span>, <span class='fl'>1883</span>, <span class='fl'>1777</span>, <span class='fl'>1734</span>, <span class='fl'>1413</span>, <span class='fl'>1456</span>, <span class='fl'>1511</span>, <span class='fl'>1957</span>, <span class='fl'>1738</span>, <span class='fl'>1685</span>, 
  <span class='fl'>1677</span>, <span class='fl'>1419</span>, <span class='fl'>1566</span>, <span class='fl'>1639</span>, <span class='fl'>1578</span>, <span class='fl'>1922</span>, <span class='fl'>1856</span>, <span class='fl'>1946</span>, <span class='fl'>1965</span>, <span class='fl'>1649</span>, 
  <span class='fl'>1854</span>, <span class='fl'>1610</span>, <span class='fl'>1806</span>, <span class='fl'>1424</span>, <span class='fl'>1616</span>, <span class='fl'>218</span>, <span class='fl'>1678</span>, <span class='fl'>1992</span>, <span class='fl'>1985</span>, <span class='fl'>903</span>, 
  <span class='fl'>1626</span>, <span class='fl'>1412</span>, <span class='fl'>1964</span>, <span class='fl'>671</span>, <span class='fl'>1692</span>, <span class='fl'>1571</span>, <span class='fl'>1690</span>, <span class='fl'>1587</span>, <span class='fl'>1933</span>, <span class='fl'>1367</span>, 
  <span class='fl'>1585</span>, <span class='fl'>1575</span>, <span class='fl'>498</span>, <span class='fl'>1601</span>, <span class='fl'>2005</span>, <span class='fl'>1711</span>, <span class='fl'>1948</span>, <span class='fl'>1991</span>, <span class='fl'>1580</span>, <span class='fl'>1704</span>, 
  <span class='fl'>207</span>, <span class='fl'>1560</span>, <span class='fl'>1867</span>, <span class='fl'>1600</span>, <span class='fl'>1594</span>, <span class='fl'>1930</span>, <span class='fl'>1541</span>, <span class='fl'>1832</span>, <span class='fl'>1613</span>, <span class='fl'>1599</span>, 
  <span class='fl'>1757</span>, <span class='fl'>71</span>, <span class='fl'>1534</span>, <span class='fl'>1940</span>, <span class='fl'>1982</span>, <span class='fl'>1960</span>, <span class='fl'>1530</span>, <span class='fl'>1908</span>, <span class='fl'>1857</span>, <span class='fl'>1410</span>, 
  <span class='fl'>1987</span>, <span class='fl'>1526</span>, <span class='fl'>1546</span>, <span class='fl'>2002</span>, <span class='fl'>1923</span>, <span class='fl'>1972</span>, <span class='fl'>1752</span>, <span class='fl'>1984</span>, <span class='fl'>1754</span>, <span class='fl'>1916</span>, 
  <span class='fl'>1942</span>, <span class='fl'>1980</span>, <span class='fl'>1608</span>, <span class='fl'>1398</span>, <span class='fl'>1438</span>, <span class='fl'>1955</span>, <span class='fl'>1968</span>, <span class='fl'>1799</span>, <span class='fl'>1976</span>, <span class='fl'>1847</span>, 
  <span class='fl'>1775</span>, <span class='fl'>1904</span>, <span class='fl'>1983</span>, <span class='fl'>1945</span>, <span class='fl'>1554</span>, <span class='fl'>1486</span>, <span class='fl'>1527</span>, <span class='fl'>1884</span>, <span class='fl'>1553</span>, <span class='fl'>1736</span>, 
  <span class='fl'>1561</span>, <span class='fl'>1513</span>, <span class='fl'>1695</span>, <span class='fl'>1431</span>, <span class='fl'>1997</span>, <span class='fl'>1405</span>, <span class='fl'>1872</span>, <span class='fl'>1434</span>, <span class='fl'>1679</span>, <span class='fl'>1609</span>, 
  <span class='fl'>105</span>, <span class='fl'>1582</span>, <span class='fl'>1795</span>, <span class='fl'>1826</span>, <span class='fl'>1886</span>, <span class='fl'>1472</span>, <span class='fl'>2007</span>, <span class='fl'>1617</span>, <span class='fl'>1978</span>, <span class='fl'>1669</span>, 
  <span class='fl'>1764</span>, <span class='fl'>1865</span>, <span class='fl'>1773</span>, <span class='fl'>1993</span>, <span class='fl'>1666</span>, <span class='fl'>1583</span>, <span class='fl'>2009</span>, <span class='fl'>1969</span>, <span class='fl'>2001</span>, <span class='fl'>1659</span>, 
  <span class='fl'>1833</span>, <span class='fl'>1713</span>, <span class='fl'>1893</span>, <span class='fl'>2000</span>, <span class='fl'>1520</span>, <span class='fl'>1652</span>, <span class='fl'>1437</span>, <span class='fl'>1556</span>, <span class='fl'>1633</span>, <span class='fl'>1386</span>, 
  <span class='fl'>1819</span>, <span class='fl'>1973</span>, <span class='fl'>1426</span>, <span class='fl'>1975</span>, <span class='fl'>2010</span>, <span class='fl'>1863</span>, <span class='fl'>1593</span>, <span class='fl'>1996</span>, <span class='fl'>1796</span>, <span class='fl'>1986</span>, 
  <span class='fl'>1995</span>, <span class='fl'>657</span>, <span class='fl'>1784</span>, <span class='fl'>1644</span>, <span class='fl'>1941</span>, <span class='fl'>1596</span>, <span class='fl'>1849</span>, <span class='fl'>1065</span>, <span class='fl'>1927</span>, <span class='fl'>1525</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<h3 id="part-one-find-a-solution-where-the-sum-of-two-entries-equals-2020.">Part One: Find a solution where the sum of two entries equals 2020.</h3>
<p>The first solution that comes to mind is finding the difference each entry and 2020, and then left-joining the entries onto this difference.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>pair_2020</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://tibble.tidyverse.org/reference/tibble.html'>tibble</a></span><span class='op'>(</span>expense <span class='op'>=</span> <span class='va'>input_data</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>difference <span class='op'>=</span> <span class='fl'>2020</span> <span class='op'>-</span> <span class='va'>expense</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate-joins.html'>left_join</a></span><span class='op'>(</span>
    x <span class='op'>=</span> <span class='va'>.</span>,
    y <span class='op'>=</span> <span class='va'>.</span>,
    by <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"expense"</span><span class='op'>=</span><span class='st'>"difference"</span><span class='op'>)</span>
  <span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='op'>!</span><span class='fu'><a href='https://rdrr.io/r/base/NA.html'>is.na</a></span><span class='op'>(</span><span class='va'>expense.y</span><span class='op'>)</span><span class='op'>)</span>

<span class='va'>pair_2020</span>
</code></pre>
</div>
<pre><code># A tibble: 2 x 3
  expense difference expense.y
    &lt;dbl&gt;      &lt;dbl&gt;     &lt;dbl&gt;
1     586       1434      1434
2    1434        586       586</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>pair_2020</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>multiply <span class='op'>=</span> <span class='va'>expense</span> <span class='op'>*</span> <span class='va'>expense.y</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/distinct.html'>distinct</a></span><span class='op'>(</span><span class='va'>multiply</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/pull.html'>pull</a></span><span class='op'>(</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>[1] 840324</code></pre>
</div>
<h3 id="part-two-find-a-solution-where-the-sum-of-three-entries-equals-2020">Part Two: Find a solution where the sum of three entries equals 2020</h3>
<p>Okay, I can’t use the first solution here, so now I’ll hit crossing to make a big dataframe, then sum it all afterwards and filter to where sum == 2020.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>triple_2020</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://tidyr.tidyverse.org/reference/expand.html'>crossing</a></span><span class='op'>(</span>first <span class='op'>=</span> <span class='va'>input_data</span>, 
                        second <span class='op'>=</span> <span class='va'>input_data</span>, 
                        third <span class='op'>=</span> <span class='va'>input_data</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>total <span class='op'>=</span> <span class='va'>first</span> <span class='op'>+</span> <span class='va'>second</span> <span class='op'>+</span> <span class='va'>third</span>,
         product <span class='op'>=</span> <span class='va'>first</span> <span class='op'>*</span> <span class='va'>second</span> <span class='op'>*</span> <span class='va'>third</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>total</span> <span class='op'>==</span> <span class='fl'>2020</span><span class='op'>)</span>

<span class='va'>triple_2020</span>
</code></pre>
</div>
<pre><code># A tibble: 6 x 5
  first second third total   product
  &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;     &lt;dbl&gt;
1   207    903   910  2020 170098110
2   207    910   903  2020 170098110
3   903    207   910  2020 170098110
4   903    910   207  2020 170098110
5   910    207   903  2020 170098110
6   910    903   207  2020 170098110</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>triple_2020</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/distinct.html'>distinct</a></span><span class='op'>(</span><span class='va'>product</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/pull.html'>pull</a></span><span class='op'>(</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>[1] 170098110</code></pre>
</div>
<div class="sourceCode" id="cb5"><pre class="sourceCode r distill-force-highlighting-css"><code class="sourceCode r"></code></pre></div>
<h2 id="day-2">Day 2</h2>
<p><a href="https://adventofcode.com/2020/day/2" class="uri">https://adventofcode.com/2020/day/2</a></p>
<p>Day two!</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://tidyverse.tidyverse.org'>tidyverse</a></span><span class='op'>)</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://github.com/sfirke/janitor'>janitor</a></span><span class='op'>)</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://here.r-lib.org/'>here</a></span><span class='op'>)</span>

<span class='fu'>knitr</span><span class='fu'>::</span><span class='va'><a href='https://rdrr.io/pkg/knitr/man/opts_chunk.html'>opts_chunk</a></span><span class='op'>$</span><span class='fu'>set</span><span class='op'>(</span>echo <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<h3 id="problem">Problem</h3>
<blockquote>
<p>To try to debug the problem, they have created a list (your puzzle input) of passwords (according to the corrupted database) and the corporate policy when that password was set.</p>
<p>For example, suppose you have the following list:</p>
<ul>
<li>1-3 a: abcde</li>
<li>1-3 b: cdefg</li>
<li>2-9 c: ccccccccc</li>
</ul>
<p>Each line gives the password policy and then the password. The password policy indicates the lowest and highest number of times a given letter must appear for the password to be valid. For example, 1-3 a means that the password must contain a at least 1 time and at most 3 times.</p>
<p>In the above example, 2 passwords are valid. The middle password, cdefg, is not; it contains no instances of b, but needs at least 1. The first and third passwords are valid: they contain one a or nine c, both within the limits of their respective policies.</p>
</blockquote>
<h3 id="input-data">Input Data</h3>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>input_data</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/utils/read.table.html'>read.delim</a></span><span class='op'>(</span><span class='st'>"day-02.txt"</span>,header <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<h3 id="how-many-passwords-are-valid">How many passwords are valid?</h3>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>password_table_one</span> <span class='op'>&lt;-</span> <span class='va'>input_data</span> <span class='op'><a href='https://rdrr.io/pkg/janitor/man/pipe.html'>%&gt;%</a></span> 
  <span class='fu'><a href='https://tidyr.tidyverse.org/reference/separate.html'>separate</a></span><span class='op'>(</span><span class='fl'>1</span>,into <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"qty"</span>,<span class='st'>"character"</span>,<span class='st'>"password"</span><span class='op'>)</span>,sep <span class='op'>=</span> <span class='st'>" "</span><span class='op'>)</span> <span class='op'><a href='https://rdrr.io/pkg/janitor/man/pipe.html'>%&gt;%</a></span> 
  <span class='fu'><a href='https://tidyr.tidyverse.org/reference/separate.html'>separate</a></span><span class='op'>(</span><span class='va'>qty</span>, into <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"min"</span>,<span class='st'>"max"</span><span class='op'>)</span>, sep <span class='op'>=</span> <span class='st'>"-"</span>,convert <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span> <span class='op'><a href='https://rdrr.io/pkg/janitor/man/pipe.html'>%&gt;%</a></span> 
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>character <span class='op'>=</span> <span class='fu'><a href='https://stringr.tidyverse.org/reference/str_remove.html'>str_remove</a></span><span class='op'>(</span><span class='va'>character</span>,<span class='st'>":"</span><span class='op'>)</span>,
         password <span class='op'>=</span> <span class='fu'><a href='https://stringr.tidyverse.org/reference/str_split.html'>str_split</a></span><span class='op'>(</span><span class='va'>password</span>,<span class='st'>""</span><span class='op'>)</span>,
         count <span class='op'>=</span> <span class='fu'><a href='https://purrr.tidyverse.org/reference/map2.html'>map2_dbl</a></span><span class='op'>(</span><span class='va'>password</span>,<span class='va'>character</span>,<span class='op'>~</span><span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='va'>.x</span> <span class='op'><a href='https://rdrr.io/r/base/match.html'>%in%</a></span> <span class='va'>.y</span><span class='op'>)</span><span class='op'>)</span>,
         valid <span class='op'>=</span> <span class='va'>count</span> <span class='op'>&lt;=</span> <span class='va'>max</span> <span class='op'>&amp;</span> <span class='va'>count</span> <span class='op'>&gt;=</span><span class='va'>min</span><span class='op'>)</span>

<span class='fu'><a href='https://rdrr.io/r/utils/head.html'>head</a></span><span class='op'>(</span><span class='va'>password_table_one</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>  min max character
1   1   4         j
2   2   4         w
3   1  13         b
4  10  11         x
5  13  14         d
6  16  18         s
                                              password count valid
1                   j, j, j, q, z, m, g, b, j, w, p, j     5 FALSE
2                                     s, c, k, w, w, f     2  TRUE
3          b, c, b, b, b, b, b, b, b, b, b, b, h, b, b    13  TRUE
4             x, j, x, x, x, x, x, x, x, x, z, x, x, x    12 FALSE
5             d, d, d, d, d, d, d, d, d, d, d, d, d, d    14  TRUE
6 k, s, t, t, b, j, s, s, t, p, n, s, v, t, c, j, n, x     4 FALSE</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='va'>password_table_one</span><span class='op'>$</span><span class='va'>valid</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>[1] 418</code></pre>
</div>
<h3 id="part-two-how-many-passwords-are-valid-under-the-second-policy">Part Two: how many passwords are valid under the second policy?</h3>
<blockquote>
<p>While it appears you validated the passwords correctly, they don’t seem to be what the Official Toboggan Corporate Authentication System is expecting.</p>
<p>The shopkeeper suddenly realizes that he just accidentally explained the password policy rules from his old job at the sled rental place down the street! The Official Toboggan Corporate Policy actually works a little differently.</p>
<p>Each policy actually describes two positions in the password, where 1 means the first character, 2 means the second character, and so on. (Be careful; Toboggan Corporate Policies have no concept of “index zero”!) Exactly one of these positions must contain the given letter. Other occurrences of the letter are irrelevant for the purposes of policy enforcement.</p>
</blockquote>
<blockquote>
<p>Given the same example list from above:</p>
</blockquote>
<blockquote>
<ul>
<li>1-3 a: abcde is valid: position 1 contains a and position 3 does not.</li>
<li>1-3 b: cdefg is invalid: neither position 1 nor position 3 contains b.</li>
<li>2-9 c: ccccccccc is invalid: both position 2 and position 9 contain c.</li>
</ul>
</blockquote>
<blockquote>
<p>How many passwords are valid according to the new interpretation of the policies?</p>
</blockquote>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>password_table_two</span> <span class='op'>&lt;-</span> <span class='va'>input_data</span> <span class='op'><a href='https://rdrr.io/pkg/janitor/man/pipe.html'>%&gt;%</a></span> 
  <span class='fu'><a href='https://tidyr.tidyverse.org/reference/separate.html'>separate</a></span><span class='op'>(</span><span class='fl'>1</span>,into <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"qty"</span>,<span class='st'>"character"</span>,<span class='st'>"password"</span><span class='op'>)</span>,sep <span class='op'>=</span> <span class='st'>" "</span><span class='op'>)</span> <span class='op'><a href='https://rdrr.io/pkg/janitor/man/pipe.html'>%&gt;%</a></span> 
  <span class='fu'><a href='https://tidyr.tidyverse.org/reference/separate.html'>separate</a></span><span class='op'>(</span><span class='va'>qty</span>, into <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"pos1"</span>,<span class='st'>"pos2"</span><span class='op'>)</span>, sep <span class='op'>=</span> <span class='st'>"-"</span>,convert <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span> <span class='op'><a href='https://rdrr.io/pkg/janitor/man/pipe.html'>%&gt;%</a></span> 
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>character <span class='op'>=</span> <span class='fu'><a href='https://stringr.tidyverse.org/reference/str_remove.html'>str_remove</a></span><span class='op'>(</span><span class='va'>character</span>,<span class='st'>":"</span><span class='op'>)</span>,
         password <span class='op'>=</span> <span class='fu'><a href='https://stringr.tidyverse.org/reference/str_split.html'>str_split</a></span><span class='op'>(</span><span class='va'>password</span>,<span class='st'>""</span><span class='op'>)</span>,
         password <span class='op'>=</span> <span class='fu'><a href='https://purrr.tidyverse.org/reference/map2.html'>pmap</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span><span class='va'>password</span>,<span class='va'>pos1</span>,<span class='va'>pos2</span><span class='op'>)</span>,<span class='op'>~</span><span class='fu'>magrittr</span><span class='fu'>::</span><span class='fu'><a href='https://magrittr.tidyverse.org/reference/aliases.html'>extract</a></span><span class='op'>(</span><span class='va'>..1</span>,<span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='va'>..2</span>,<span class='va'>..3</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>,
         count <span class='op'>=</span> <span class='fu'><a href='https://purrr.tidyverse.org/reference/map2.html'>map2_dbl</a></span><span class='op'>(</span><span class='va'>password</span>,<span class='va'>character</span>, <span class='op'>~</span><span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='va'>.x</span> <span class='op'><a href='https://rdrr.io/r/base/match.html'>%in%</a></span> <span class='va'>.y</span><span class='op'>)</span><span class='op'>)</span>,
         valid <span class='op'>=</span> <span class='va'>count</span> <span class='op'>==</span> <span class='fl'>1</span><span class='op'>)</span>

<span class='fu'><a href='https://rdrr.io/r/utils/head.html'>head</a></span><span class='op'>(</span><span class='va'>password_table_two</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>  pos1 pos2 character password count valid
1    1    4         j     j, q     1  TRUE
2    2    4         w     c, w     1  TRUE
3    1   13         b     b, h     1  TRUE
4   10   11         x     x, z     1  TRUE
5   13   14         d     d, d     2 FALSE
6   16   18         s     j, x     0 FALSE</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='va'>password_table_two</span><span class='op'>$</span><span class='va'>valid</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>[1] 616</code></pre>
</div>
<div class="sourceCode" id="cb10"><pre class="sourceCode r distill-force-highlighting-css"><code class="sourceCode r"></code></pre></div>
<h2 id="day-3">Day 3</h2>
<p><a href="https://adventofcode.com/2020/day/3" class="uri">https://adventofcode.com/2020/day/3</a></p>
<p>Day three!</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://tidyverse.tidyverse.org'>tidyverse</a></span><span class='op'>)</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://here.r-lib.org/'>here</a></span><span class='op'>)</span>

<span class='fu'>knitr</span><span class='fu'>::</span><span class='va'><a href='https://rdrr.io/pkg/knitr/man/opts_chunk.html'>opts_chunk</a></span><span class='op'>$</span><span class='fu'>set</span><span class='op'>(</span>echo <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<h3 id="problem-1">Problem</h3>
<blockquote>
<p>You start on the open square (.) in the top-left corner and need to reach the bottom (below the bottom-most row on your map).</p>
<p>The toboggan can only follow a few specific slopes (you opted for a cheaper model that prefers rational numbers); start by counting all the trees you would encounter for the slope right 3, down 1:</p>
<p>From your starting position at the top-left, check the position that is right 3 and down 1. Then, check the position that is right 3 and down 1 from there, and so on until you go past the bottom of the map.</p>
<p>Starting at the top-left corner of your map and following a slope of right 3 and down 1, how many trees would you encounter?</p>
</blockquote>
<h3 id="input-data-1">Input Data</h3>
<p>Converting to a matrix of 1s and 0s, where “#” is 1 and “.” is 0</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>input_matrix</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://readr.tidyverse.org/reference/read_table.html'>read_table</a></span><span class='op'>(</span><span class='st'>"day-03.txt"</span>,col_names <span class='op'>=</span> <span class='st'>"x"</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='fu'><a href='https://stringr.tidyverse.org/reference/str_split.html'>str_split</a></span><span class='op'>(</span><span class='va'>x</span>,<span class='st'>""</span><span class='op'>)</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
  <span class='fu'><a href='https://tidyr.tidyverse.org/reference/hoist.html'>unnest_wider</a></span><span class='op'>(</span><span class='va'>x</span>,names_sep <span class='op'>=</span> <span class='st'>"_"</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate_all.html'>mutate_all</a></span><span class='op'>(</span><span class='op'>~</span><span class='fu'><a href='https://dplyr.tidyverse.org/reference/case_when.html'>case_when</a></span><span class='op'>(</span><span class='va'>.x</span> <span class='op'>==</span> <span class='st'>"#"</span> <span class='op'>~</span> <span class='fl'>1</span>, <span class='va'>.x</span> <span class='op'>==</span> <span class='st'>"."</span> <span class='op'>~</span> <span class='fl'>0</span><span class='op'>)</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
  <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>as.matrix</a></span><span class='op'>(</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<h3 id="problem-1-1">Problem 1</h3>
<blockquote>
<p>Starting at the top-left corner of your map and following a slope of right 3 and down 1, how many trees would you encounter?</p>
</blockquote>
<p>Key here is that the pattern repeats to the right until you get down to the bottom, i.e. until you access row 323 in this case.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>input_rows</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>nrow</a></span><span class='op'>(</span><span class='va'>input_matrix</span><span class='op'>)</span>

<span class='va'>input_rows</span>
</code></pre>
</div>
<pre><code>[1] 323</code></pre>
</div>
<p>So 323 is the goal rows, and that means we’ll need ~ 969 columns. We can tackle this cbind with a while loop.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>input_columns</span> <span class='op'>&lt;-</span> <span class='va'>input_rows</span> <span class='op'>*</span> <span class='fl'>3</span>

<span class='va'>wide_matrix</span> <span class='op'>&lt;-</span> <span class='va'>input_matrix</span>

<span class='kw'>while</span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>ncol</a></span><span class='op'>(</span><span class='va'>wide_matrix</span><span class='op'>)</span> <span class='op'>&lt;</span> <span class='va'>input_columns</span><span class='op'>)</span> <span class='va'>wide_matrix</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/cbind.html'>cbind</a></span><span class='op'>(</span><span class='va'>wide_matrix</span>,<span class='va'>input_matrix</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<p>Now building an accessor tibble with row numbers and column numbers</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>row_accessor</span> <span class='op'>&lt;-</span> <span class='fl'>2</span><span class='op'>:</span><span class='va'>input_rows</span> <span class='co'># start at 1,1 so the next row is 2</span>

<span class='va'>column_accessor</span> <span class='op'>&lt;-</span> <span class='fl'>1</span><span class='op'>:</span><span class='va'>input_rows</span> <span class='op'>*</span> <span class='fl'>3</span> <span class='op'>+</span> <span class='fl'>1</span> <span class='co'># start at 1,1 and move right three, so next column is 4</span>

<span class='va'>column_accessor</span> <span class='op'>&lt;-</span> <span class='va'>column_accessor</span><span class='op'>[</span><span class='op'>-</span><span class='fl'>323</span><span class='op'>]</span> <span class='co'># need the accessors to be same length</span>

<span class='va'>indices</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://tibble.tidyverse.org/reference/tibble.html'>tibble</a></span><span class='op'>(</span>
  row <span class='op'>=</span> <span class='va'>row_accessor</span>,
  column <span class='op'>=</span> <span class='va'>column_accessor</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>path <span class='op'>=</span> <span class='fu'><a href='https://purrr.tidyverse.org/reference/map2.html'>map2_dbl</a></span><span class='op'>(</span><span class='va'>row</span>,<span class='va'>column</span>,<span class='op'>~</span><span class='va'>wide_matrix</span><span class='op'>[</span><span class='va'>.x</span>,<span class='va'>.y</span><span class='op'>]</span><span class='op'>)</span><span class='op'>)</span>
  
<span class='fu'><a href='https://rdrr.io/r/utils/head.html'>head</a></span><span class='op'>(</span><span class='va'>indices</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code># A tibble: 6 x 3
    row column  path
  &lt;int&gt;  &lt;dbl&gt; &lt;dbl&gt;
1     2      4     1
2     3      7     1
3     4     10     1
4     5     13     1
5     6     16     1
6     7     19     1</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='va'>indices</span><span class='op'>$</span><span class='va'>path</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>[1] 280</code></pre>
</div>
<h3 id="problem-2-find-this-path-for-multiple-slopes">Problem 2: Find this path for multiple slopes</h3>
<p>Find the path for</p>
<ul>
<li>1,1</li>
<li>3,1</li>
<li>5,1</li>
<li>7,1</li>
<li>1,2</li>
</ul>
<p>A good time to generalise the previous steps!</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>fn_slope</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>right</span>,<span class='va'>down</span>,<span class='va'>matrix</span><span class='op'>)</span><span class='op'>{</span>
  
  <span class='co'># Calculate number of columns</span>
  <span class='va'>column_count</span> <span class='op'>&lt;-</span> <span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>nrow</a></span><span class='op'>(</span><span class='va'>matrix</span><span class='op'>)</span> <span class='op'>*</span> <span class='va'>right</span><span class='op'>)</span>
  
  <span class='co'># Create matrix</span>
  <span class='va'>wide_matrix</span> <span class='op'>&lt;-</span> <span class='va'>matrix</span>
  <span class='kw'>while</span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>ncol</a></span><span class='op'>(</span><span class='va'>wide_matrix</span><span class='op'>)</span> <span class='op'>&lt;</span> <span class='va'>column_count</span><span class='op'>)</span> <span class='va'>wide_matrix</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/cbind.html'>cbind</a></span><span class='op'>(</span><span class='va'>wide_matrix</span>,<span class='va'>matrix</span><span class='op'>)</span>
  
  <span class='co'># Create accessors</span>
  <span class='va'>row_accessor</span> <span class='op'>&lt;-</span> <span class='op'>(</span><span class='fl'>1</span><span class='op'>:</span><span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>nrow</a></span><span class='op'>(</span><span class='va'>matrix</span><span class='op'>)</span> <span class='op'>*</span> <span class='va'>down</span><span class='op'>)</span> <span class='op'>+</span> <span class='fl'>1</span>
  <span class='va'>row_accessor</span> <span class='op'>&lt;-</span> <span class='va'>row_accessor</span><span class='op'>[</span><span class='va'>row_accessor</span> <span class='op'>&lt;=</span><span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>nrow</a></span><span class='op'>(</span><span class='va'>matrix</span><span class='op'>)</span><span class='op'>]</span>
  
  <span class='va'>column_accessor</span> <span class='op'>&lt;-</span> <span class='op'>(</span><span class='fl'>1</span><span class='op'>:</span><span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>nrow</a></span><span class='op'>(</span><span class='va'>matrix</span><span class='op'>)</span> <span class='op'>*</span> <span class='va'>right</span><span class='op'>)</span> <span class='op'>+</span> <span class='fl'>1</span>
  <span class='va'>column_accessor</span> <span class='op'>&lt;-</span> <span class='va'>column_accessor</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>:</span><span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span><span class='op'>(</span><span class='va'>row_accessor</span><span class='op'>)</span><span class='op'>]</span>
  
  <span class='va'>x</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://tibble.tidyverse.org/reference/tibble.html'>tibble</a></span><span class='op'>(</span>row <span class='op'>=</span> <span class='va'>row_accessor</span>,
              column <span class='op'>=</span> <span class='va'>column_accessor</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
    <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>path <span class='op'>=</span> <span class='fu'><a href='https://purrr.tidyverse.org/reference/map2.html'>map2_dbl</a></span><span class='op'>(</span><span class='va'>row</span>,<span class='va'>column</span>,<span class='op'>~</span><span class='va'>wide_matrix</span><span class='op'>[</span><span class='va'>.x</span>,<span class='va'>.y</span><span class='op'>]</span><span class='op'>)</span><span class='op'>)</span>
  
  <span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='va'>x</span><span class='op'>$</span><span class='va'>path</span><span class='op'>)</span>
<span class='op'>}</span>

<span class='va'>toboggan_paths</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://tibble.tidyverse.org/reference/tibble.html'>tibble</a></span><span class='op'>(</span>right <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>,<span class='fl'>3</span>,<span class='fl'>5</span>,<span class='fl'>7</span>,<span class='fl'>1</span><span class='op'>)</span>,
                         down <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>,<span class='fl'>1</span>,<span class='fl'>1</span>,<span class='fl'>1</span>,<span class='fl'>2</span><span class='op'>)</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>paths <span class='op'>=</span> <span class='fu'><a href='https://purrr.tidyverse.org/reference/map2.html'>map2_dbl</a></span><span class='op'>(</span><span class='va'>right</span>,<span class='va'>down</span>,<span class='va'>fn_slope</span>,<span class='va'>input_matrix</span><span class='op'>)</span><span class='op'>)</span>

<span class='va'>toboggan_paths</span>
</code></pre>
</div>
<pre><code># A tibble: 5 x 3
  right  down paths
  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
1     1     1    77
2     3     1   280
3     5     1    74
4     7     1    78
5     1     2    35</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://purrr.tidyverse.org/reference/reduce.html'>reduce</a></span><span class='op'>(</span><span class='va'>toboggan_paths</span><span class='op'>$</span><span class='va'>paths</span>,<span class='va'>`*`</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>[1] 4355551200</code></pre>
</div>
<div class="sourceCode" id="cb16"><pre class="sourceCode r distill-force-highlighting-css"><code class="sourceCode r"></code></pre></div>
<h2 id="day-4">Day 4</h2>
<p><a href="https://adventofcode.com/2020/day/4" class="uri">https://adventofcode.com/2020/day/4</a></p>
<p>Day three!</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://tidyverse.tidyverse.org'>tidyverse</a></span><span class='op'>)</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://here.r-lib.org/'>here</a></span><span class='op'>)</span>

<span class='fu'>knitr</span><span class='fu'>::</span><span class='va'><a href='https://rdrr.io/pkg/knitr/man/opts_chunk.html'>opts_chunk</a></span><span class='op'>$</span><span class='fu'>set</span><span class='op'>(</span>echo <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<h3 id="problem-description">Problem Description</h3>
<blockquote>
<p>The automatic passport scanners are slow because they’re having trouble detecting which passports have all required fields. The expected fields are as follows:</p>
<pre><code>- byr (Birth Year)
- iyr (Issue Year)
- eyr (Expiration Year)
- hgt (Height)
- hcl (Hair Color)
- ecl (Eye Color)
- pid (Passport ID)
- cid (Country ID)</code></pre>
<p>Passport data is validated in batch files (your puzzle input). Each passport is represented as a sequence of key:value pairs separated by spaces or newlines. Passports are separated by blank lines.</p>
</blockquote>
<p>Count the number of valid passports - those that have <code>all required fields</code>. Treat cid as optional. In your batch file, how many passports are valid?</p>
<h3 id="input-data-2">Input Data</h3>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>input_data</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://readr.tidyverse.org/reference/read_lines.html'>read_lines</a></span><span class='op'>(</span><span class='fu'><a href='https://here.r-lib.org//reference/here.html'>here</a></span><span class='op'>(</span><span class='st'>"2020/day-04.txt"</span><span class='op'>)</span><span class='op'>)</span>

<span class='fu'><a href='https://rdrr.io/r/utils/head.html'>head</a></span><span class='op'>(</span><span class='va'>input_data</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>[1] &quot;iyr:2015 cid:189 ecl:oth byr:1947 hcl:#6c4ab1 eyr:2026&quot;                        
[2] &quot;hgt:174cm&quot;                                                                     
[3] &quot;pid:526744288&quot;                                                                 
[4] &quot;&quot;                                                                              
[5] &quot;pid:688706448 iyr:2017 hgt:162cm cid:174 ecl:grn byr:1943 hcl:#808e9e eyr:2025&quot;
[6] &quot;&quot;                                                                              </code></pre>
</div>
<p>Cleaning data into a tibble.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>df_passports</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://tibble.tidyverse.org/reference/tibble.html'>tibble</a></span><span class='op'>(</span>data <span class='op'>=</span> <span class='va'>input_data</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>blank <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/ifelse.html'>ifelse</a></span><span class='op'>(</span><span class='va'>data</span> <span class='op'>==</span> <span class='st'>""</span>,<span class='fl'>1</span>,<span class='fl'>0</span><span class='op'>)</span>,
         passport_id <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/cumsum.html'>cumsum</a></span><span class='op'>(</span><span class='va'>blank</span><span class='op'>)</span><span class='op'>+</span><span class='fl'>1</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='op'>!</span><span class='va'>blank</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/select.html'>select</a></span><span class='op'>(</span><span class='op'>-</span><span class='va'>blank</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
  <span class='fu'><a href='https://tidyr.tidyverse.org/reference/separate_rows.html'>separate_rows</a></span><span class='op'>(</span><span class='va'>data</span>, sep <span class='op'>=</span> <span class='st'>" "</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
  <span class='fu'><a href='https://tidyr.tidyverse.org/reference/separate.html'>separate</a></span><span class='op'>(</span><span class='va'>data</span>, sep <span class='op'>=</span> <span class='st'>":"</span>, into <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"key"</span>,<span class='st'>"value"</span><span class='op'>)</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
  <span class='fu'><a href='https://tidyr.tidyverse.org/reference/pivot_wider.html'>pivot_wider</a></span><span class='op'>(</span>names_from <span class='op'>=</span> <span class='va'>key</span>, values_from <span class='op'>=</span> <span class='va'>value</span><span class='op'>)</span>

<span class='fu'><a href='https://rdrr.io/r/utils/head.html'>head</a></span><span class='op'>(</span><span class='va'>df_passports</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code># A tibble: 6 x 9
  passport_id iyr   cid   ecl   byr   hcl     eyr   hgt   pid      
        &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;   &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;    
1           1 2015  189   oth   1947  #6c4ab1 2026  174cm 526744288
2           2 2017  174   grn   1943  #808e9e 2025  162cm 688706448
3           3 2019  124   oth   1933  #733820 2001  159in 111220591
4           4 2026  291   oth   1942  #fffffd 2024  159cm 812929897
5           5 2013  83    amb   1974  #ceb3a1 2028  191cm 524032739
6           6 &lt;NA&gt;  221   gry   1963  eefed5  2029  183cm 88405792 </code></pre>
</div>
<h3 id="problem-1-how-many-completenon-missing-passports">Problem 1: How many complete/non-missing passports?</h3>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>valid_p1</span> <span class='op'>&lt;-</span> <span class='va'>df_passports</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/select.html'>select</a></span><span class='op'>(</span><span class='op'>-</span><span class='va'>cid</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter_all.html'>filter_all</a></span><span class='op'>(</span><span class='op'>~</span><span class='op'>!</span><span class='fu'><a href='https://rdrr.io/r/base/NA.html'>is.na</a></span><span class='op'>(</span><span class='va'>.x</span><span class='op'>)</span><span class='op'>)</span>

<span class='fu'><a href='https://rdrr.io/r/utils/head.html'>head</a></span><span class='op'>(</span><span class='va'>valid_p1</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code># A tibble: 6 x 8
  passport_id iyr   ecl   byr   hcl     eyr   hgt   pid      
        &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;   &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;    
1           1 2015  oth   1947  #6c4ab1 2026  174cm 526744288
2           2 2017  grn   1943  #808e9e 2025  162cm 688706448
3           3 2019  oth   1933  #733820 2001  159in 111220591
4           4 2026  oth   1942  #fffffd 2024  159cm 812929897
5           5 2013  amb   1974  #ceb3a1 2028  191cm 524032739
6           7 2018  grn   1923  #18171d 2021  181cm 777881168</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>nrow</a></span><span class='op'>(</span><span class='va'>valid_p1</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>[1] 264</code></pre>
</div>
<h3 id="problem-2-validate-columns">Problem 2: Validate columns</h3>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>valid_p2</span> <span class='op'>&lt;-</span> <span class='va'>valid_p1</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate_all.html'>mutate_at</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"byr"</span>,<span class='st'>"iyr"</span>,<span class='st'>"eyr"</span><span class='op'>)</span>,<span class='va'>as.numeric</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span>
    <span class='fu'><a href='https://dplyr.tidyverse.org/reference/between.html'>between</a></span><span class='op'>(</span><span class='va'>byr</span>,<span class='fl'>1920</span>,<span class='fl'>2002</span><span class='op'>)</span>,
    <span class='fu'><a href='https://dplyr.tidyverse.org/reference/between.html'>between</a></span><span class='op'>(</span><span class='va'>iyr</span>,<span class='fl'>2010</span>,<span class='fl'>2020</span><span class='op'>)</span>,
    <span class='fu'><a href='https://dplyr.tidyverse.org/reference/between.html'>between</a></span><span class='op'>(</span><span class='va'>eyr</span>,<span class='fl'>2020</span>,<span class='fl'>2030</span><span class='op'>)</span>,
    <span class='fu'><a href='https://dplyr.tidyverse.org/reference/case_when.html'>case_when</a></span><span class='op'>(</span>
      <span class='fu'><a href='https://stringr.tidyverse.org/reference/str_starts.html'>str_ends</a></span><span class='op'>(</span><span class='va'>hgt</span>,<span class='st'>"cm"</span><span class='op'>)</span> <span class='op'>&amp;</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/between.html'>between</a></span><span class='op'>(</span><span class='fu'><a href='https://readr.tidyverse.org/reference/parse_number.html'>parse_number</a></span><span class='op'>(</span><span class='va'>hgt</span><span class='op'>)</span>,<span class='fl'>150</span>,<span class='fl'>193</span><span class='op'>)</span> <span class='op'>~</span> <span class='cn'>TRUE</span>,
      <span class='fu'><a href='https://stringr.tidyverse.org/reference/str_starts.html'>str_ends</a></span><span class='op'>(</span><span class='va'>hgt</span>,<span class='st'>"in"</span><span class='op'>)</span> <span class='op'>&amp;</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/between.html'>between</a></span><span class='op'>(</span><span class='fu'><a href='https://readr.tidyverse.org/reference/parse_number.html'>parse_number</a></span><span class='op'>(</span><span class='va'>hgt</span><span class='op'>)</span>,<span class='fl'>59</span>,<span class='fl'>76</span><span class='op'>)</span> <span class='op'>~</span> <span class='cn'>TRUE</span>,
      <span class='cn'>TRUE</span> <span class='op'>~</span> <span class='cn'>FALSE</span>
      <span class='op'>)</span>,
    <span class='fu'><a href='https://stringr.tidyverse.org/reference/str_detect.html'>str_detect</a></span><span class='op'>(</span><span class='va'>hcl</span>,<span class='st'>"^#[A-z,0-9]{6}$"</span><span class='op'>)</span>,
    <span class='va'>ecl</span> <span class='op'><a href='https://rdrr.io/r/base/match.html'>%in%</a></span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"amb"</span>,<span class='st'>"blu"</span>,<span class='st'>"brn"</span>,<span class='st'>"gry"</span>,<span class='st'>"grn"</span>,<span class='st'>"hzl"</span>,<span class='st'>"oth"</span><span class='op'>)</span>,
    <span class='fu'><a href='https://stringr.tidyverse.org/reference/str_detect.html'>str_detect</a></span><span class='op'>(</span><span class='va'>pid</span>,<span class='st'>"^[0-9]{9}$"</span><span class='op'>)</span>,
  <span class='op'>)</span>

<span class='fu'><a href='https://rdrr.io/r/utils/head.html'>head</a></span><span class='op'>(</span><span class='va'>valid_p2</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code># A tibble: 6 x 8
  passport_id   iyr ecl     byr hcl       eyr hgt   pid      
        &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt; &lt;dbl&gt; &lt;chr&gt;   &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt;    
1           1  2015 oth    1947 #6c4ab1  2026 174cm 526744288
2           2  2017 grn    1943 #808e9e  2025 162cm 688706448
3           5  2013 amb    1974 #ceb3a1  2028 191cm 524032739
4           7  2018 grn    1923 #18171d  2021 181cm 777881168
5           8  2016 gry    1941 #a5e1b5  2027 178cm 062495008
6          10  2020 blu    1925 #888785  2023 188cm 117915262</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>nrow</a></span><span class='op'>(</span><span class='va'>valid_p2</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>[1] 224</code></pre>
</div>
<div class="sourceCode" id="cb24"><pre class="sourceCode r distill-force-highlighting-css"><code class="sourceCode r"></code></pre></div>
<h2 id="day-5">Day 5</h2>
<p><a href="https://adventofcode.com/2020/day/5" class="uri">https://adventofcode.com/2020/day/5</a></p>
<p>Day five!</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://tidyverse.tidyverse.org'>tidyverse</a></span><span class='op'>)</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://here.r-lib.org/'>here</a></span><span class='op'>)</span>

<span class='fu'>knitr</span><span class='fu'>::</span><span class='va'><a href='https://rdrr.io/pkg/knitr/man/opts_chunk.html'>opts_chunk</a></span><span class='op'>$</span><span class='fu'>set</span><span class='op'>(</span>echo <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<blockquote>
<p>Instead of zones or groups, this airline uses binary space partitioning to seat people. A seat might be specified like FBFBBFFRLR, where F means “front”, B means “back”, L means “left”, and R means “right”.</p>
<p>The first 7 characters will either be F or B; these specify exactly one of the 128 rows on the plane (numbered 0 through 127). Each letter tells you which half of a region the given seat is in. Start with the whole list of rows; the first letter indicates whether the seat is in the front (0 through 63) or the back (64 through 127). The next letter indicates which half of that region the seat is in, and so on until you’re left with exactly one row.</p>
<p>The last three characters will be either L or R; these specify exactly one of the 8 columns of seats on the plane (numbered 0 through 7). The same process as above proceeds again, this time with only three steps. L means to keep the lower half, while R means to keep the upper half.</p>
<p>So, decoding FBFBBFFRLR reveals that it is the seat at row 44, column 5.</p>
<p>Every seat also has a unique seat ID: multiply the row by 8, then add the column. In this example, the seat has ID 44 * 8 + 5 = 357.</p>
</blockquote>
<h3 id="data-and-cleaning">Data and Cleaning</h3>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>input_05</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://readr.tidyverse.org/reference/read_lines.html'>read_lines</a></span><span class='op'>(</span><span class='fu'><a href='https://here.r-lib.org//reference/here.html'>here</a></span><span class='op'>(</span><span class='st'>"2020"</span>,<span class='st'>"day-05.txt"</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<h3 id="problem-1-highest-seat-id">Problem 1: highest seat ID?</h3>
<p>First, some cleaning.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>search_function</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>string</span>,<span class='va'>range</span><span class='op'>)</span><span class='op'>{</span>
  
  <span class='va'>midpoint</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span><span class='op'>(</span><span class='va'>range</span><span class='op'>)</span><span class='op'><a href='https://rdrr.io/r/base/Arithmetic.html'>%/%</a></span><span class='fl'>2</span>
  <span class='va'>accessor</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://stringr.tidyverse.org/reference/str_sub.html'>str_sub</a></span><span class='op'>(</span><span class='va'>string</span>,<span class='fl'>1</span>,<span class='fl'>1</span><span class='op'>)</span> 

  <span class='va'>new_range</span> <span class='op'>&lt;-</span> <span class='kw'><a href='https://rdrr.io/r/base/switch.html'>switch</a></span><span class='op'>(</span>
    <span class='va'>accessor</span>,
    <span class='st'>"L"</span> <span class='op'>=</span> ,
    <span class='st'>"F"</span> <span class='op'>=</span> <span class='va'>range</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>:</span><span class='va'>midpoint</span><span class='op'>]</span>,
    <span class='st'>"R"</span> <span class='op'>=</span> ,
    <span class='st'>"B"</span> <span class='op'>=</span> <span class='va'>range</span><span class='op'>[</span><span class='op'>-</span><span class='op'>(</span><span class='fl'>1</span><span class='op'>:</span><span class='va'>midpoint</span><span class='op'>)</span><span class='op'>]</span><span class='op'>)</span>

  <span class='kw'>if</span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span><span class='op'>(</span><span class='va'>new_range</span><span class='op'>)</span> <span class='op'>==</span> <span class='fl'>1</span><span class='op'>)</span> <span class='kw'><a href='https://rdrr.io/r/base/function.html'>return</a></span><span class='op'>(</span><span class='va'>new_range</span><span class='op'>)</span>
  
  <span class='va'>new_string</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://stringr.tidyverse.org/reference/str_remove.html'>str_remove</a></span><span class='op'>(</span><span class='va'>string</span>,<span class='st'>"^."</span><span class='op'>)</span>
  
  <span class='fu'>search_function</span><span class='op'>(</span><span class='va'>new_string</span>,<span class='va'>new_range</span><span class='op'>)</span>
<span class='op'>}</span>

<span class='fu'>search_function</span><span class='op'>(</span><span class='st'>"FBFBBFF"</span>,<span class='fl'>0</span><span class='op'>:</span><span class='fl'>127</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>[1] 44</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>df_boardingpasses</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://tibble.tidyverse.org/reference/tibble.html'>tibble</a></span><span class='op'>(</span>input <span class='op'>=</span> <span class='va'>input_05</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>row_string <span class='op'>=</span> <span class='fu'><a href='https://stringr.tidyverse.org/reference/str_sub.html'>str_sub</a></span><span class='op'>(</span><span class='va'>input</span>,<span class='fl'>1</span>,<span class='fl'>7</span><span class='op'>)</span>,
         seat_string <span class='op'>=</span> <span class='fu'><a href='https://stringr.tidyverse.org/reference/str_sub.html'>str_sub</a></span><span class='op'>(</span><span class='va'>input</span>,<span class='op'>-</span><span class='fl'>3</span>,<span class='op'>-</span><span class='fl'>1</span><span class='op'>)</span>,
         row <span class='op'>=</span> <span class='fu'><a href='https://purrr.tidyverse.org/reference/map.html'>map_dbl</a></span><span class='op'>(</span><span class='va'>row_string</span>,<span class='va'>search_function</span>,<span class='fl'>0</span><span class='op'>:</span><span class='fl'>127</span><span class='op'>)</span>,
         seat <span class='op'>=</span> <span class='fu'><a href='https://purrr.tidyverse.org/reference/map.html'>map_dbl</a></span><span class='op'>(</span><span class='va'>seat_string</span>,<span class='va'>search_function</span>,<span class='fl'>0</span><span class='op'>:</span><span class='fl'>7</span><span class='op'>)</span>,
         seat_id <span class='op'>=</span> <span class='va'>row</span> <span class='op'>*</span> <span class='fl'>8</span> <span class='op'>+</span> <span class='va'>seat</span><span class='op'>)</span>

<span class='fu'><a href='https://rdrr.io/r/utils/head.html'>head</a></span><span class='op'>(</span><span class='va'>df_boardingpasses</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code># A tibble: 6 x 6
  input      row_string seat_string   row  seat seat_id
  &lt;chr&gt;      &lt;chr&gt;      &lt;chr&gt;       &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt;
1 FFBFBBBRLR FFBFBBB    RLR            23     5     189
2 BBFFBFFRRR BBFFBFF    RRR           100     7     807
3 BFFFFBBRRR BFFFFBB    RRR            67     7     543
4 FFBFFBBLRR FFBFFBB    LRR            19     3     155
5 FFBFBFBLLL FFBFBFB    LLL            21     0     168
6 FFBFFBFLRR FFBFFBF    LRR            18     3     147</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/Extremes.html'>max</a></span><span class='op'>(</span><span class='va'>df_boardingpasses</span><span class='op'>$</span><span class='va'>seat_id</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>[1] 818</code></pre>
</div>
<h3 id="problem-2-your-seat">Problem 2: Your Seat</h3>
<blockquote>
<p>It’s a completely full flight, so your seat should be the only missing boarding pass in your list. However, there’s a catch: some of the seats at the very front and back of the plane don’t exist on this aircraft, so they’ll be missing from your list as well.</p>
<p>Your seat wasn’t at the very front or back, though; the seats with IDs +1 and -1 from yours will be in your list.</p>
</blockquote>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>actual_seats</span> <span class='op'>&lt;-</span>  <span class='va'>df_boardingpasses</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/arrange.html'>arrange</a></span><span class='op'>(</span><span class='va'>row</span>,<span class='va'>seat</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span>
    <span class='va'>row</span> <span class='op'>!=</span> <span class='fu'><a href='https://rdrr.io/r/base/Extremes.html'>min</a></span><span class='op'>(</span><span class='va'>row</span><span class='op'>)</span>,
    <span class='va'>row</span> <span class='op'>!=</span> <span class='fu'><a href='https://rdrr.io/r/base/Extremes.html'>max</a></span><span class='op'>(</span><span class='va'>row</span><span class='op'>)</span>
  <span class='op'>)</span>

<span class='va'>x</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq.int</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/Extremes.html'>min</a></span><span class='op'>(</span><span class='va'>actual_seats</span><span class='op'>$</span><span class='va'>seat_id</span><span class='op'>)</span>,<span class='fu'><a href='https://rdrr.io/r/base/Extremes.html'>max</a></span><span class='op'>(</span><span class='va'>actual_seats</span><span class='op'>$</span><span class='va'>seat_id</span><span class='op'>)</span><span class='op'>)</span>

<span class='va'>x</span><span class='op'>[</span><span class='op'>!</span><span class='op'>(</span><span class='va'>x</span> <span class='op'><a href='https://rdrr.io/r/base/match.html'>%in%</a></span> <span class='va'>actual_seats</span><span class='op'>$</span><span class='va'>seat_id</span><span class='op'>)</span><span class='op'>]</span>
</code></pre>
</div>
<pre><code>[1] 559</code></pre>
</div>
<div class="sourceCode" id="cb29"><pre class="sourceCode r distill-force-highlighting-css"><code class="sourceCode r"></code></pre></div>
<h2 id="day-6">Day 6</h2>
<p><a href="https://adventofcode.com/2020/day/6" class="uri">https://adventofcode.com/2020/day/6</a></p>
<p>Day six!</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://tidyverse.tidyverse.org'>tidyverse</a></span><span class='op'>)</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://here.r-lib.org/'>here</a></span><span class='op'>)</span>

<span class='fu'>knitr</span><span class='fu'>::</span><span class='va'><a href='https://rdrr.io/pkg/knitr/man/opts_chunk.html'>opts_chunk</a></span><span class='op'>$</span><span class='fu'>set</span><span class='op'>(</span>echo <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<blockquote>
<p>The form asks a series of 26 yes-or-no questions marked a through z. All you need to do is identify the questions for which anyone in your group answers “yes”. Since your group is just you, this doesn’t take very long.</p>
<p>However, the person sitting next to you seems to be experiencing a language barrier and asks if you can help. For each of the people in their group, you write down the questions for which they answer “yes”, one per line. For example:</p>
<ul>
<li>abcx</li>
<li>abcy</li>
<li>abcz</li>
</ul>
<p>In this group, there are 6 questions to which anyone answered “yes”: a, b, c, x, y, and z. (Duplicate answers to the same question don’t count extra; each question counts at most once.)</p>
</blockquote>
<h3 id="data-1">Data</h3>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>input_06</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://readr.tidyverse.org/reference/read_lines.html'>read_lines</a></span><span class='op'>(</span><span class='fu'><a href='https://here.r-lib.org//reference/here.html'>here</a></span><span class='op'>(</span><span class='st'>"2020"</span>,<span class='st'>"day-06.txt"</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<h3 id="cleaning">Cleaning</h3>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>df_surveys</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://tibble.tidyverse.org/reference/tibble.html'>tibble</a></span><span class='op'>(</span>data <span class='op'>=</span> <span class='va'>input_06</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>group_id <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/ifelse.html'>ifelse</a></span><span class='op'>(</span><span class='va'>data</span> <span class='op'>==</span> <span class='st'>""</span>,<span class='fl'>1</span>,<span class='fl'>0</span><span class='op'>)</span>,
         group_id <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/cumsum.html'>cumsum</a></span><span class='op'>(</span><span class='va'>group_id</span><span class='op'>)</span> <span class='op'>+</span> <span class='fl'>1</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>data</span><span class='op'>!=</span><span class='st'>""</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>passenger_id <span class='op'>=</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/ranking.html'>row_number</a></span><span class='op'>(</span><span class='op'>)</span>,
         data <span class='op'>=</span> <span class='fu'><a href='https://stringr.tidyverse.org/reference/str_split.html'>str_split</a></span><span class='op'>(</span><span class='va'>data</span>,<span class='st'>""</span><span class='op'>)</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
  <span class='fu'><a href='https://tidyr.tidyverse.org/reference/hoist.html'>unnest_longer</a></span><span class='op'>(</span><span class='va'>data</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<h3 id="problem-1-2">Problem 1</h3>
<p>For each group, count the number of questions to which anyone answered “yes”. What is the sum of those counts?</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>df_surveys</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/group_by.html'>group_by</a></span><span class='op'>(</span><span class='va'>group_id</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/summarise.html'>summarise</a></span><span class='op'>(</span>count <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/unique.html'>unique</a></span><span class='op'>(</span><span class='va'>data</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/summarise.html'>summarise</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='va'>count</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code># A tibble: 1 x 1
  `sum(count)`
         &lt;int&gt;
1         6310</code></pre>
</div>
<h3 id="problem-2">Problem 2</h3>
<p>Now count only where everyone in the group answered ALL the same questions.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>df_surveys</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/group_by.html'>group_by</a></span><span class='op'>(</span><span class='va'>group_id</span>, <span class='va'>data</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>answer_count <span class='op'>=</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/context.html'>n</a></span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/group_by.html'>group_by</a></span><span class='op'>(</span><span class='va'>group_id</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>group_count <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/unique.html'>unique</a></span><span class='op'>(</span><span class='va'>passenger_id</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/group_by.html'>ungroup</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>answer_count</span> <span class='op'>==</span> <span class='va'>group_count</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/group_by.html'>group_by</a></span><span class='op'>(</span><span class='va'>group_id</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/summarise.html'>summarise</a></span><span class='op'>(</span>count <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/unique.html'>unique</a></span><span class='op'>(</span><span class='va'>data</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/summarise.html'>summarise</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='va'>count</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code># A tibble: 1 x 1
  `sum(count)`
         &lt;int&gt;
1         3193</code></pre>
</div>
<p>New time PB of fifteen minutes is pretty satisfying!</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r distill-force-highlighting-css"><code class="sourceCode r"></code></pre></div>
<h2 id="day-7">Day 7</h2>
<p><a href="https://adventofcode.com/2020/day/7" class="uri">https://adventofcode.com/2020/day/7</a></p>
<p>Day seven! “Handy Haversacks”</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://tidyverse.tidyverse.org'>tidyverse</a></span><span class='op'>)</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://here.r-lib.org/'>here</a></span><span class='op'>)</span>

<span class='fu'>knitr</span><span class='fu'>::</span><span class='va'><a href='https://rdrr.io/pkg/knitr/man/opts_chunk.html'>opts_chunk</a></span><span class='op'>$</span><span class='fu'>set</span><span class='op'>(</span>echo <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<blockquote>
<p>Due to recent aviation regulations, many rules (your puzzle input) are being enforced about bags and their contents; bags must be color-coded and must contain specific quantities of other color-coded bags. Apparently, nobody responsible for these regulations considered how long they would take to enforce!</p>
<p>For example, consider the following rules:</p>
<ul>
<li>light red bags contain 1 bright white bag, 2 muted yellow bags.</li>
<li>dark orange bags contain 3 bright white bags, 4 muted yellow bags.</li>
<li>bright white bags contain 1 shiny gold bag.</li>
<li>muted yellow bags contain 2 shiny gold bags, 9 faded blue bags.</li>
<li>shiny gold bags contain 1 dark olive bag, 2 vibrant plum bags.</li>
<li>dark olive bags contain 3 faded blue bags, 4 dotted black bags.</li>
<li>vibrant plum bags contain 5 faded blue bags, 6 dotted black bags.</li>
<li>faded blue bags contain no other bags.</li>
<li>dotted black bags contain no other bags.</li>
</ul>
<p>These rules specify the required contents for 9 bag types. In this example, every faded blue bag is empty, every vibrant plum bag contains 11 bags (5 faded blue and 6 dotted black), and so on.</p>
<p>You have a shiny gold bag. If you wanted to carry it in at least one other bag, how many different bag colors would be valid for the outermost bag? (In other words: how many colors can, eventually, contain at least one shiny gold bag?)</p>
<p>In the above rules, the following options would be available to you:</p>
<ul>
<li>A bright white bag, which can hold your shiny gold bag directly.</li>
<li>A muted yellow bag, which can hold your shiny gold bag directly, plus some other bags.</li>
<li>A dark orange bag, which can hold bright white and muted yellow bags, either of which could then hold your shiny gold bag.</li>
<li>A light red bag, which can hold bright white and muted yellow bags, either of which could then hold your shiny gold bag.</li>
</ul>
<p>So, in this example, the number of bag colors that can eventually contain at least one shiny gold bag is 4.</p>
<p>How many bag colors can eventually contain at least one shiny gold bag?</p>
</blockquote>
<h3 id="data-2">Data</h3>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>input_07</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://readr.tidyverse.org/reference/read_lines.html'>read_lines</a></span><span class='op'>(</span><span class='fu'><a href='https://here.r-lib.org//reference/here.html'>here</a></span><span class='op'>(</span><span class='st'>"2020"</span>,<span class='st'>"day-07.txt"</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<h3 id="cleaning-1">Cleaning</h3>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>df_rules</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://tibble.tidyverse.org/reference/tibble.html'>tibble</a></span><span class='op'>(</span>input <span class='op'>=</span> <span class='va'>input_07</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
  <span class='fu'><a href='https://tidyr.tidyverse.org/reference/separate.html'>separate</a></span><span class='op'>(</span><span class='va'>input</span>,into <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"name"</span>,<span class='st'>"rule"</span><span class='op'>)</span>,sep <span class='op'>=</span> <span class='st'>" bags contain "</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>rule <span class='op'>=</span> <span class='fu'><a href='https://stringr.tidyverse.org/reference/str_split.html'>str_split</a></span><span class='op'>(</span><span class='va'>rule</span>,<span class='st'>"bags|bag"</span><span class='op'>)</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
  <span class='fu'><a href='https://tidyr.tidyverse.org/reference/hoist.html'>unnest_longer</a></span><span class='op'>(</span><span class='va'>rule</span><span class='op'>)</span>  <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>rule <span class='op'>=</span> <span class='fu'><a href='https://stringr.tidyverse.org/reference/str_remove.html'>str_remove</a></span><span class='op'>(</span><span class='va'>rule</span>,<span class='st'>","</span><span class='op'>)</span>,
         rule <span class='op'>=</span> <span class='fu'><a href='https://stringr.tidyverse.org/reference/str_remove.html'>str_remove</a></span><span class='op'>(</span><span class='va'>rule</span>,<span class='st'>"\\."</span><span class='op'>)</span>,
         rule <span class='op'>=</span> <span class='fu'><a href='https://stringr.tidyverse.org/reference/str_trim.html'>str_squish</a></span><span class='op'>(</span><span class='va'>rule</span><span class='op'>)</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>rule</span> <span class='op'>!=</span> <span class='st'>""</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>rule_qty <span class='op'>=</span> <span class='fu'><a href='https://readr.tidyverse.org/reference/parse_number.html'>parse_number</a></span><span class='op'>(</span><span class='va'>rule</span>,na <span class='op'>=</span> <span class='st'>"no other"</span><span class='op'>)</span>,
         rule_colour <span class='op'>=</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/if_else.html'>if_else</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/NA.html'>is.na</a></span><span class='op'>(</span><span class='va'>rule_qty</span><span class='op'>)</span>, 
                               <span class='cn'>NA_character_</span>,
                               <span class='fu'><a href='https://stringr.tidyverse.org/reference/str_remove.html'>str_remove</a></span><span class='op'>(</span><span class='va'>rule</span>,<span class='fu'><a href='https://rdrr.io/r/base/character.html'>as.character</a></span><span class='op'>(</span><span class='va'>rule_qty</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>,
         rule_colour <span class='op'>=</span> <span class='fu'><a href='https://stringr.tidyverse.org/reference/str_trim.html'>str_squish</a></span><span class='op'>(</span><span class='va'>rule_colour</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<h3 id="problem-1---how-many-bag-colours-eventually-contain-one-shiny-gold-bag">Problem 1 - how many bag colours eventually contain one shiny gold bag?</h3>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>find_parents</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>colour</span>,<span class='va'>df_rules</span><span class='op'>)</span><span class='op'>{</span>
  
  <span class='va'>x</span> <span class='op'>&lt;-</span> <span class='va'>df_rules</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
    <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>rule_colour</span> <span class='op'>==</span> <span class='va'>colour</span>, <span class='va'>rule_qty</span> <span class='op'>&gt;=</span> <span class='fl'>1</span><span class='op'>)</span>
  
  <span class='fu'><a href='https://purrr.tidyverse.org/reference/map.html'>map_dfr</a></span><span class='op'>(</span><span class='va'>x</span><span class='op'>$</span><span class='va'>name</span>,<span class='va'>find_parents</span>,<span class='va'>df_rules</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
    <span class='fu'><a href='https://dplyr.tidyverse.org/reference/bind.html'>bind_rows</a></span><span class='op'>(</span><span class='va'>x</span>,<span class='va'>.</span><span class='op'>)</span>
  
<span class='op'>}</span>

<span class='va'>parents</span> <span class='op'>&lt;-</span> <span class='fu'>find_parents</span><span class='op'>(</span><span class='st'>"shiny gold"</span>,<span class='va'>df_rules</span><span class='op'>)</span>

<span class='fu'><a href='https://rdrr.io/r/base/unique.html'>unique</a></span><span class='op'>(</span><span class='va'>parents</span><span class='op'>$</span><span class='va'>name</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> <span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span><span class='op'>(</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>[1] 119</code></pre>
</div>
<h3 id="problem-2---how-many-bags-are-inside-your-shiny-gold-bag">Problem 2 - how many bags are inside your shiny gold bag?</h3>
<p>The ultimate “I’m too tired for this shit” move is to pull out parallel processing on it. Cause ugh.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://github.com/DavisVaughan/furrr'>furrr</a></span><span class='op'>)</span> 

<span class='fu'><a href='https://rdrr.io/pkg/future/man/plan.html'>plan</a></span><span class='op'>(</span><span class='va'>multiprocess</span><span class='op'>)</span>

<span class='va'>find_children</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>colour</span>,<span class='va'>df_rules</span><span class='op'>)</span><span class='op'>{</span>
  
  <span class='va'>x</span> <span class='op'>&lt;-</span> <span class='va'>df_rules</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
    <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>name</span> <span class='op'>==</span> <span class='va'>colour</span>,<span class='op'>!</span><span class='fu'><a href='https://rdrr.io/r/base/NA.html'>is.na</a></span><span class='op'>(</span><span class='va'>rule_qty</span><span class='op'>)</span><span class='op'>)</span>
  
  <span class='kw'>if</span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>nrow</a></span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span><span class='op'>==</span><span class='fl'>0</span><span class='op'>)</span> <span class='kw'><a href='https://rdrr.io/r/base/function.html'>return</a></span><span class='op'>(</span><span class='fu'><a href='https://tibble.tidyverse.org/reference/tibble.html'>tibble</a></span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span>
  
  <span class='va'>x</span> <span class='op'>&lt;-</span> <span class='va'>x</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
    <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>rule_colour <span class='op'>=</span> <span class='fu'><a href='https://purrr.tidyverse.org/reference/map2.html'>map2</a></span><span class='op'>(</span><span class='va'>rule_colour</span>,<span class='va'>rule_qty</span>,<span class='va'>rep_len</span><span class='op'>)</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
    <span class='fu'><a href='https://tidyr.tidyverse.org/reference/hoist.html'>unnest_longer</a></span><span class='op'>(</span><span class='va'>rule_colour</span><span class='op'>)</span>
  
  <span class='va'>y</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/furrr/man/future_map.html'>future_map_dfr</a></span><span class='op'>(</span><span class='va'>x</span><span class='op'>$</span><span class='va'>rule_colour</span>,<span class='va'>find_children</span>,<span class='va'>df_rules</span><span class='op'>)</span>
  
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/bind.html'>bind_rows</a></span><span class='op'>(</span><span class='va'>x</span>,<span class='va'>y</span><span class='op'>)</span>
<span class='op'>}</span>

<span class='va'>children</span> <span class='op'>&lt;-</span> <span class='fu'>find_children</span><span class='op'>(</span><span class='st'>"shiny gold"</span>,<span class='va'>df_rules</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>nrow</a></span><span class='op'>(</span><span class='va'>children</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>[1] 155802</code></pre>
</div>
<div class="sourceCode" id="cb35"><pre class="sourceCode r distill-force-highlighting-css"><code class="sourceCode r"></code></pre></div>
<h2 id="day-8">Day 8</h2>
<p><a href="https://adventofcode.com/2020/day/8" class="uri">https://adventofcode.com/2020/day/8</a></p>
<p>Day eight! “Handheld Halting”</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://tidyverse.tidyverse.org'>tidyverse</a></span><span class='op'>)</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://here.r-lib.org/'>here</a></span><span class='op'>)</span>

<span class='fu'>knitr</span><span class='fu'>::</span><span class='va'><a href='https://rdrr.io/pkg/knitr/man/opts_chunk.html'>opts_chunk</a></span><span class='op'>$</span><span class='fu'>set</span><span class='op'>(</span>echo <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<blockquote>
<p>The boot code is represented as a text file with one instruction per line of text. Each instruction consists of an operation (acc, jmp, or nop) and an argument (a signed number like +4 or -20).</p>
<ul>
<li>acc increases or decreases a single global value called the accumulator by the value given in the argument. For example, acc +7 would increase the accumulator by 7. The accumulator starts at 0. After an acc instruction, the instruction immediately below it is executed next.</li>
<li>jmp jumps to a new instruction relative to itself. The next instruction to execute is found using the argument as an offset from the jmp instruction; for example, jmp +2 would skip the next instruction, jmp +1 would continue to the instruction immediately below it, and jmp -20 would cause the instruction 20 lines above to be executed next.</li>
<li>nop stands for No OPeration - it does nothing. The instruction immediately below it is executed next.</li>
</ul>
<p>This is an infinite loop: with this sequence of jumps, the program will run forever. The moment the program tries to run any instruction a second time, you know it will never terminate.</p>
<p>Immediately before the program would run an instruction a second time, the value in the accumulator is 5.</p>
<p>Run your copy of the boot code. Immediately before any instruction is executed a second time, what value is in the accumulator?</p>
</blockquote>
<h3 id="data-3">Data</h3>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>input_08</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://readr.tidyverse.org/reference/read_lines.html'>read_lines</a></span><span class='op'>(</span><span class='fu'><a href='https://here.r-lib.org//reference/here.html'>here</a></span><span class='op'>(</span><span class='st'>"2020"</span>,<span class='st'>"day-08.txt"</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<h3 id="cleaning-2">Cleaning</h3>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>df_codes</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://tibble.tidyverse.org/reference/tibble.html'>tibble</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>input_08</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
  <span class='fu'><a href='https://tidyr.tidyverse.org/reference/separate.html'>separate</a></span><span class='op'>(</span><span class='va'>x</span>,<span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"instruction"</span>,<span class='st'>"qty"</span><span class='op'>)</span>,sep <span class='op'>=</span> <span class='st'>" "</span>, convert <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>instruction_id <span class='op'>=</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/ranking.html'>row_number</a></span><span class='op'>(</span><span class='op'>)</span>,
         next_instruction_id <span class='op'>=</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/case_when.html'>case_when</a></span><span class='op'>(</span><span class='va'>instruction</span> <span class='op'>==</span> <span class='st'>"jmp"</span> <span class='op'>~</span> <span class='va'>instruction_id</span> <span class='op'>+</span> <span class='va'>qty</span>,
                                         <span class='cn'>TRUE</span> <span class='op'>~</span> <span class='va'>instruction_id</span> <span class='op'>+</span> <span class='fl'>1L</span><span class='op'>)</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/select.html'>select</a></span><span class='op'>(</span><span class='va'>instruction_id</span>,<span class='va'>instruction</span>,<span class='va'>qty</span>,<span class='va'>next_instruction_id</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<h3 id="problem-1-immediately-before-any-instruction-is-executed-a-second-time-what-value-is-in-the-accumulator">Problem 1: Immediately before any instruction is executed a second time, what value is in the accumulator?</h3>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>current_id</span> <span class='op'>&lt;-</span> <span class='fl'>1</span>
<span class='va'>accumulator</span> <span class='op'>&lt;-</span> <span class='fl'>0</span>
<span class='va'>error_switch</span> <span class='op'>&lt;-</span> <span class='cn'>FALSE</span>
<span class='va'>visited_codes</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://tibble.tidyverse.org/reference/tibble.html'>tibble</a></span><span class='op'>(</span><span class='op'>)</span>

<span class='kw'>while</span><span class='op'>(</span><span class='op'>!</span><span class='va'>error_switch</span><span class='op'>)</span><span class='op'>{</span>
  
  <span class='va'>current_instruction</span> <span class='op'>&lt;-</span> <span class='va'>df_codes</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
    <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>instruction_id</span> <span class='op'>==</span> <span class='va'>current_id</span><span class='op'>)</span>
  
  <span class='va'>visited_codes</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/bind.html'>bind_rows</a></span><span class='op'>(</span><span class='va'>visited_codes</span>,<span class='va'>current_instruction</span><span class='op'>)</span>
  
  <span class='kw'>if</span><span class='op'>(</span><span class='va'>current_instruction</span><span class='op'>$</span><span class='va'>instruction</span> <span class='op'>==</span> <span class='st'>"acc"</span><span class='op'>)</span> <span class='va'>accumulator</span> <span class='op'>&lt;-</span> <span class='va'>accumulator</span> <span class='op'>+</span> <span class='va'>current_instruction</span><span class='op'>$</span><span class='va'>qty</span>
  
  <span class='va'>current_id</span> <span class='op'>&lt;-</span> <span class='va'>current_instruction</span><span class='op'>$</span><span class='va'>next_instruction_id</span>
  
  <span class='kw'>if</span><span class='op'>(</span><span class='va'>current_id</span> <span class='op'><a href='https://rdrr.io/r/base/match.html'>%in%</a></span> <span class='va'>visited_codes</span><span class='op'>$</span><span class='va'>instruction_id</span><span class='op'>)</span> <span class='va'>error_switch</span> <span class='op'>&lt;-</span> <span class='cn'>TRUE</span>

<span class='op'>}</span>

<span class='va'>accumulator</span>
</code></pre>
</div>
<pre><code>[1] 1797</code></pre>
</div>
<h3 id="problem-2-fix-the-program">Problem 2: Fix the program</h3>
<p>The program has a bug where one of jmp or nop are wrong and should be the other way around, which will let the program run all of the rows. If the program exits correctly, what is the accumulator total?</p>
<p>First, create function for accumulator.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>run_accumulator</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>df_codes</span><span class='op'>)</span><span class='op'>{</span>
  
  <span class='va'>current_id</span> <span class='op'>&lt;-</span> <span class='fl'>1</span>
  <span class='va'>accumulator</span> <span class='op'>&lt;-</span> <span class='fl'>0</span>
  <span class='va'>error_switch</span> <span class='op'>&lt;-</span> <span class='cn'>FALSE</span>
  <span class='va'>visited_codes</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://tibble.tidyverse.org/reference/tibble.html'>tibble</a></span><span class='op'>(</span><span class='op'>)</span>
  <span class='va'>status</span> <span class='op'>&lt;-</span> <span class='st'>"FAIL"</span>
  
  <span class='kw'>while</span><span class='op'>(</span><span class='op'>!</span><span class='va'>error_switch</span><span class='op'>)</span><span class='op'>{</span>
    
    <span class='va'>current_instruction</span> <span class='op'>&lt;-</span> <span class='va'>df_codes</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
      <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>instruction_id</span> <span class='op'>==</span> <span class='va'>current_id</span><span class='op'>)</span>
    
    <span class='va'>visited_codes</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/bind.html'>bind_rows</a></span><span class='op'>(</span><span class='va'>visited_codes</span>,<span class='va'>current_instruction</span><span class='op'>)</span>
    
    <span class='kw'>if</span><span class='op'>(</span><span class='va'>current_instruction</span><span class='op'>$</span><span class='va'>instruction</span> <span class='op'>==</span> <span class='st'>"acc"</span><span class='op'>)</span> <span class='va'>accumulator</span> <span class='op'>&lt;-</span> <span class='va'>accumulator</span> <span class='op'>+</span> <span class='va'>current_instruction</span><span class='op'>$</span><span class='va'>qty</span>
    
    <span class='va'>current_id</span> <span class='op'>&lt;-</span> <span class='va'>current_instruction</span><span class='op'>$</span><span class='va'>next_instruction_id</span>
    
    <span class='kw'>if</span><span class='op'>(</span><span class='va'>current_id</span> <span class='op'>==</span> <span class='fl'>626</span><span class='op'>)</span> <span class='va'>error_switch</span> <span class='op'>&lt;-</span> <span class='cn'>TRUE</span>
    
    <span class='kw'>if</span><span class='op'>(</span><span class='va'>current_id</span> <span class='op'><a href='https://rdrr.io/r/base/match.html'>%in%</a></span> <span class='va'>visited_codes</span><span class='op'>$</span><span class='va'>instruction_id</span><span class='op'>)</span> <span class='va'>error_switch</span> <span class='op'>&lt;-</span> <span class='cn'>TRUE</span>
  <span class='op'>}</span>

  <span class='kw'>if</span><span class='op'>(</span><span class='va'>current_id</span> <span class='op'>==</span> <span class='fl'>626</span><span class='op'>)</span> <span class='va'>status</span> <span class='op'>&lt;-</span> <span class='st'>"SUCCESS"</span>
  
  <span class='kw'><a href='https://rdrr.io/r/base/function.html'>return</a></span><span class='op'>(</span> 
    <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>
      status <span class='op'>=</span> <span class='va'>status</span>, 
      accumulator <span class='op'>=</span> <span class='va'>accumulator</span>, 
      next_id <span class='op'>=</span> <span class='va'>current_id</span><span class='op'>)</span>
  <span class='op'>)</span>
<span class='op'>}</span>

<span class='fu'>run_accumulator</span><span class='op'>(</span><span class='va'>df_codes</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>$status
[1] &quot;FAIL&quot;

$accumulator
[1] 1797

$next_id
[1] 606</code></pre>
</div>
<p>Next, build function to switch jmp and nop, build list of dfs, run the accumulator on it and find success.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://github.com/DavisVaughan/furrr'>furrr</a></span><span class='op'>)</span>

<span class='fu'><a href='https://rdrr.io/pkg/future/man/plan.html'>plan</a></span><span class='op'>(</span><span class='va'>multisession</span><span class='op'>)</span>

<span class='va'>jmpnop_switcher</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>id</span>,<span class='va'>df_codes</span><span class='op'>)</span><span class='op'>{</span>
  
  <span class='va'>df_codes</span><span class='op'>$</span><span class='va'>instruction</span><span class='op'>[</span><span class='va'>id</span><span class='op'>]</span> <span class='op'>&lt;-</span> <span class='kw'><a href='https://rdrr.io/r/base/switch.html'>switch</a></span><span class='op'>(</span><span class='va'>df_codes</span><span class='op'>$</span><span class='va'>instruction</span><span class='op'>[</span><span class='va'>id</span><span class='op'>]</span>,
                                     <span class='st'>"jmp"</span> <span class='op'>=</span> <span class='st'>"nop"</span>,
                                     <span class='st'>"nop"</span> <span class='op'>=</span> <span class='st'>"jmp"</span><span class='op'>)</span>
  
  <span class='va'>df_codes</span> <span class='op'>&lt;-</span> <span class='va'>df_codes</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
    <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>next_instruction_id <span class='op'>=</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/case_when.html'>case_when</a></span><span class='op'>(</span><span class='va'>instruction</span> <span class='op'>==</span> <span class='st'>"jmp"</span> <span class='op'>~</span> <span class='va'>instruction_id</span> <span class='op'>+</span> <span class='va'>qty</span>,
                                           <span class='cn'>TRUE</span> <span class='op'>~</span> <span class='va'>instruction_id</span> <span class='op'>+</span> <span class='fl'>1L</span><span class='op'>)</span><span class='op'>)</span>
  
  <span class='va'>df_codes</span>
<span class='op'>}</span>

<span class='va'>jmpnop_list</span> <span class='op'>&lt;-</span> <span class='va'>df_codes</span><span class='op'>$</span><span class='va'>instruction_id</span><span class='op'>[</span><span class='va'>df_codes</span><span class='op'>$</span><span class='va'>instruction</span> <span class='op'><a href='https://rdrr.io/r/base/match.html'>%in%</a></span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"jmp"</span>,<span class='st'>"nop"</span><span class='op'>)</span><span class='op'>]</span>

<span class='va'>df_codelist</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://purrr.tidyverse.org/reference/map.html'>map</a></span><span class='op'>(</span><span class='va'>jmpnop_list</span>,<span class='va'>jmpnop_switcher</span>,<span class='va'>df_codes</span><span class='op'>)</span>

<span class='va'>x</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/furrr/man/future_map.html'>future_map_dfr</a></span><span class='op'>(</span><span class='va'>df_codelist</span>,<span class='va'>run_accumulator</span><span class='op'>)</span>

<span class='va'>x</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/arrange.html'>arrange</a></span><span class='op'>(</span><span class='fu'><a href='https://dplyr.tidyverse.org/reference/desc.html'>desc</a></span><span class='op'>(</span><span class='va'>status</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code># A tibble: 298 x 3
   status  accumulator next_id
   &lt;chr&gt;         &lt;dbl&gt;   &lt;int&gt;
 1 SUCCESS        1036     626
 2 FAIL           1818     448
 3 FAIL           1797     606
 4 FAIL           1797     606
 5 FAIL           1797     606
 6 FAIL           1797     606
 7 FAIL           1797     606
 8 FAIL           1797     606
 9 FAIL            726     606
10 FAIL            682     606
# ... with 288 more rows</code></pre>
</div>
<div class="sourceCode" id="cb39"><pre class="sourceCode r distill-force-highlighting-css"><code class="sourceCode r"></code></pre></div>
<h2 id="day-9">Day 9</h2>
<p><a href="https://adventofcode.com/2020/day/9" class="uri">https://adventofcode.com/2020/day/9</a></p>
<p>Day nine - encoding error!</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://tidyverse.tidyverse.org'>tidyverse</a></span><span class='op'>)</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://here.r-lib.org/'>here</a></span><span class='op'>)</span>

<span class='fu'>knitr</span><span class='fu'>::</span><span class='va'><a href='https://rdrr.io/pkg/knitr/man/opts_chunk.html'>opts_chunk</a></span><span class='op'>$</span><span class='fu'>set</span><span class='op'>(</span>echo <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<p>— Description —</p>
<blockquote>
<p>XMAS starts by transmitting a preamble of 25 numbers. After that, each number you receive should be the sum of any two of the 25 immediately previous numbers. The two numbers will have different values, and there might be more than one such pair.</p>
<p>For example, suppose your preamble consists of the numbers 1 through 25 in a random order. To be valid, the next number must be the sum of two of those numbers.</p>
<p>The first step of attacking the weakness in the XMAS data is to find the first number in the list (after the preamble) which is not the sum of two of the 25 numbers before it. What is the first number that does not have this property?</p>
</blockquote>
— Data —
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>input_09</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://readr.tidyverse.org/reference/read_lines.html'>read_lines</a></span><span class='op'>(</span><span class='fu'><a href='https://here.r-lib.org//reference/here.html'>here</a></span><span class='op'>(</span><span class='st'>"2020"</span>,<span class='st'>"day-09.txt"</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<p>— Cleaning —</p>
<p>Offhand, I’m going to use Davis Vaughan’s <a href="https://davisvaughan.github.io/slider/">slider</a> package to create the rolling windows for each row, and then tackle it for each problem.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://github.com/DavisVaughan/slider'>slider</a></span><span class='op'>)</span>

<span class='va'>df_cipher</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://tibble.tidyverse.org/reference/tibble.html'>tibble</a></span><span class='op'>(</span>num <span class='op'>=</span> <span class='va'>input_09</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate_all.html'>mutate_all</a></span><span class='op'>(</span><span class='va'>as.numeric</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>rolling <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/pkg/slider/man/slide.html'>slide</a></span><span class='op'>(</span><span class='va'>num</span>,<span class='op'>~</span><span class='va'>.x</span>,.before <span class='op'>=</span> <span class='fl'>24</span>, .complete <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/lead-lag.html'>lag</a></span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/slice.html'>slice</a></span><span class='op'>(</span><span class='op'>-</span><span class='op'>(</span><span class='fl'>1</span><span class='op'>:</span><span class='fl'>25</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<p>— Problem 1 —</p>
<blockquote>
<p>Find the first number which is not the sum of the two numbers before it.</p>
</blockquote>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>problem_1</span> <span class='op'>&lt;-</span> <span class='va'>df_cipher</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>rolling_sum <span class='op'>=</span> <span class='fu'><a href='https://purrr.tidyverse.org/reference/map2.html'>map2_lgl</a></span><span class='op'>(</span><span class='va'>rolling</span>,<span class='va'>num</span>, 
                                <span class='op'>~</span> <span class='fu'><a href='https://tidyr.tidyverse.org/reference/expand.html'>crossing</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>.x</span>, y <span class='op'>=</span> <span class='va'>.x</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
                                  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>sum <span class='op'>=</span> <span class='va'>x</span> <span class='op'>+</span> <span class='va'>y</span>,
                                         flag <span class='op'>=</span> <span class='va'>sum</span> <span class='op'>==</span> <span class='va'>.y</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
                                  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/summarise.html'>summarise</a></span><span class='op'>(</span>flag <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/any.html'>any</a></span><span class='op'>(</span><span class='va'>flag</span><span class='op'>)</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
                                  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/pull.html'>pull</a></span><span class='op'>(</span><span class='va'>flag</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>

<span class='va'>problem_1</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='op'>!</span><span class='va'>rolling_sum</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code># A tibble: 1 x 3
       num rolling    rolling_sum
     &lt;dbl&gt; &lt;list&gt;     &lt;lgl&gt;      
1 10884537 &lt;dbl [25]&gt; FALSE      </code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>solution_1</span> <span class='op'>&lt;-</span> <span class='va'>problem_1</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='op'>!</span><span class='va'>rolling_sum</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/pull.html'>pull</a></span><span class='op'>(</span><span class='va'>num</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<p>— Problem 2 —</p>
<blockquote>
<p>The final step in breaking the XMAS encryption relies on the invalid number you just found: you must find a contiguous set of at least two numbers in your list which sum to the invalid number from step 1.</p>
</blockquote>
<p>Back to slider again, this time using a loop to iterate the size of the rolling window upward until the solution is found.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>problem_2</span> <span class='op'>&lt;-</span> <span class='va'>df_cipher</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>num</span> <span class='op'>&lt;</span> <span class='va'>solution_1</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/select.html'>select</a></span><span class='op'>(</span><span class='va'>num</span><span class='op'>)</span>

<span class='va'>success</span> <span class='op'>&lt;-</span> <span class='cn'>FALSE</span>
<span class='va'>size</span> <span class='op'>&lt;-</span> <span class='fl'>1</span>

<span class='kw'>while</span><span class='op'>(</span><span class='op'>!</span><span class='va'>success</span><span class='op'>)</span><span class='op'>{</span>
  <span class='va'>size</span> <span class='op'>&lt;-</span> <span class='va'>size</span> <span class='op'>+</span> <span class='fl'>1</span>
  
  <span class='va'>test_solve</span> <span class='op'>&lt;-</span> <span class='va'>problem_2</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
    <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>rolling_sum <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/pkg/slider/man/slide.html'>slide_dbl</a></span><span class='op'>(</span><span class='va'>num</span>,<span class='va'>sum</span>,.complete <span class='op'>=</span> <span class='cn'>TRUE</span>,.before <span class='op'>=</span> <span class='va'>size</span> <span class='op'>-</span> <span class='fl'>1</span><span class='op'>)</span>,
           success <span class='op'>=</span> <span class='va'>rolling_sum</span> <span class='op'>==</span> <span class='va'>solution_1</span><span class='op'>)</span>
  
  <span class='va'>success</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/any.html'>any</a></span><span class='op'>(</span><span class='va'>test_solve</span><span class='op'>$</span><span class='va'>success</span>,na.rm <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>
<span class='op'>}</span>

<span class='va'>cleanup_solution</span> <span class='op'>&lt;-</span> <span class='va'>test_solve</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/slice.html'>slice</a></span><span class='op'>(</span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/which.html'>which</a></span><span class='op'>(</span><span class='va'>test_solve</span><span class='op'>$</span><span class='va'>success</span><span class='op'>)</span><span class='op'>-</span><span class='va'>size</span><span class='op'>+</span><span class='fl'>1</span><span class='op'>)</span><span class='op'>:</span><span class='fu'><a href='https://rdrr.io/r/base/which.html'>which</a></span><span class='op'>(</span><span class='va'>test_solve</span><span class='op'>$</span><span class='va'>success</span><span class='op'>)</span><span class='op'>)</span>
  
<span class='fu'><a href='https://rdrr.io/r/base/Extremes.html'>min</a></span><span class='op'>(</span><span class='va'>cleanup_solution</span><span class='op'>$</span><span class='va'>num</span><span class='op'>)</span> <span class='op'>+</span> <span class='fu'><a href='https://rdrr.io/r/base/Extremes.html'>max</a></span><span class='op'>(</span><span class='va'>cleanup_solution</span><span class='op'>$</span><span class='va'>num</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>[1] 1261309</code></pre>
</div>
<div class="sourceCode" id="cb42"><pre class="sourceCode r distill-force-highlighting-css"><code class="sourceCode r"></code></pre></div>
<h2 id="day-10">Day 10</h2>
<p><a href="https://adventofcode.com/2020/day/10" class="uri">https://adventofcode.com/2020/day/10</a></p>
<p>Day ten - Adapter Array!</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/message.html'>suppressPackageStartupMessages</a></span><span class='op'>(</span><span class='op'>{</span>
  <span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://tidyverse.tidyverse.org'>tidyverse</a></span><span class='op'>)</span>
  <span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://here.r-lib.org/'>here</a></span><span class='op'>)</span>
<span class='op'>}</span><span class='op'>)</span>

<span class='fu'>knitr</span><span class='fu'>::</span><span class='va'><a href='https://rdrr.io/pkg/knitr/man/opts_chunk.html'>opts_chunk</a></span><span class='op'>$</span><span class='fu'>set</span><span class='op'>(</span>echo <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<blockquote>
<p>Find a chain that uses all of your adapters to connect the charging outlet to your device’s built-in adapter and count the joltage differences between the charging outlet, the adapters, and your device. What is the number of 1-jolt differences multiplied by the number of 3-jolt differences?</p>
</blockquote>
— Data —
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>input_10</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://readr.tidyverse.org/reference/read_lines.html'>read_lines</a></span><span class='op'>(</span><span class='fu'><a href='https://here.r-lib.org//reference/here.html'>here</a></span><span class='op'>(</span><span class='st'>"2020"</span>,<span class='st'>"day-10.txt"</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
</div>
— Cleaning —
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>df_adapters</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://tibble.tidyverse.org/reference/tibble.html'>tibble</a></span><span class='op'>(</span>adapter <span class='op'>=</span> <span class='va'>input_10</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>adapter <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/numeric.html'>as.numeric</a></span><span class='op'>(</span><span class='va'>adapter</span><span class='op'>)</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
  <span class='fu'><a href='https://tibble.tidyverse.org/reference/add_row.html'>add_row</a></span><span class='op'>(</span>adapter <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/Extremes.html'>max</a></span><span class='op'>(</span><span class='va'>.</span><span class='op'>$</span><span class='va'>adapter</span><span class='op'>)</span><span class='op'>+</span><span class='fl'>3</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/arrange.html'>arrange</a></span><span class='op'>(</span><span class='va'>adapter</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>diff <span class='op'>=</span> <span class='va'>adapter</span> <span class='op'>-</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/lead-lag.html'>lag</a></span><span class='op'>(</span><span class='va'>adapter</span>,default <span class='op'>=</span> <span class='fl'>0</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<p>— Problem 1 —</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>p1</span> <span class='op'>&lt;-</span> <span class='va'>df_adapters</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/count.html'>count</a></span><span class='op'>(</span><span class='va'>diff</span><span class='op'>)</span>

<span class='fu'><a href='https://rdrr.io/r/base/prod.html'>prod</a></span><span class='op'>(</span><span class='va'>p1</span><span class='op'>$</span><span class='va'>n</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>[1] 2263</code></pre>
</div>
<p>— Problem 2 —</p>
<p>What is the total number of distinct ways you can arrange the adapters to connect the charging outlet to your device?</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://github.com/DavisVaughan/slider'>slider</a></span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/options.html'>options</a></span><span class='op'>(</span>scipen <span class='op'>=</span> <span class='fl'>999</span><span class='op'>)</span>

<span class='va'>p2</span> <span class='op'>&lt;-</span> <span class='va'>df_adapters</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/select.html'>select</a></span><span class='op'>(</span><span class='va'>adapter</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span>
  <span class='fu'><a href='https://tibble.tidyverse.org/reference/add_row.html'>add_row</a></span><span class='op'>(</span>adapter <span class='op'>=</span> <span class='fl'>0</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/arrange.html'>arrange</a></span><span class='op'>(</span><span class='fu'><a href='https://dplyr.tidyverse.org/reference/desc.html'>desc</a></span><span class='op'>(</span><span class='va'>adapter</span><span class='op'>)</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>
    ways <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/pkg/slider/man/slide.html'>slide</a></span><span class='op'>(</span><span class='va'>adapter</span>,<span class='op'>~</span><span class='va'>.x</span>,.before <span class='op'>=</span> <span class='fl'>3</span>,.after <span class='op'>=</span> <span class='op'>-</span><span class='fl'>1</span><span class='op'>)</span>,
    ways <span class='op'>=</span> <span class='fu'><a href='https://purrr.tidyverse.org/reference/map2.html'>map2</a></span><span class='op'>(</span><span class='va'>ways</span>,<span class='va'>adapter</span>,<span class='op'>~</span><span class='va'>.x</span><span class='op'>[</span><span class='va'>.x</span><span class='op'>-</span><span class='va'>.y</span><span class='op'>&lt;=</span><span class='fl'>3</span><span class='op'>]</span><span class='op'>)</span><span class='op'>)</span>

<span class='va'>lookup_table</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/numeric.html'>numeric</a></span><span class='op'>(</span><span class='op'>)</span>
<span class='va'>lookup_table</span><span class='op'>[[</span><span class='fu'><a href='https://rdrr.io/r/base/Extremes.html'>max</a></span><span class='op'>(</span><span class='va'>df_adapters</span><span class='op'>$</span><span class='va'>adapter</span><span class='op'>)</span><span class='op'>]</span><span class='op'>]</span> <span class='op'>&lt;-</span> <span class='fl'>1</span> <span class='co'># seed lookup_table for 166 as 1 path</span>

<span class='va'>p2</span> <span class='op'>&lt;-</span> <span class='va'>p2</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/slice.html'>slice</a></span><span class='op'>(</span><span class='op'>-</span><span class='fl'>1</span><span class='op'>)</span> <span class='co'># remove 166, ways you can plug 166 in is blank</span>

<span class='va'>sum_ways</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>ways</span>,<span class='va'>adapter</span><span class='op'>)</span><span class='op'>{</span>
  
  <span class='va'>ways</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/unlist.html'>unlist</a></span><span class='op'>(</span><span class='va'>ways</span><span class='op'>)</span>
  
  <span class='va'>total_ways</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='va'>lookup_table</span><span class='op'>[</span><span class='va'>ways</span><span class='op'>]</span><span class='op'>)</span> <span class='co'># read lookup table for each of the ways</span>
    
  <span class='va'>lookup_table</span><span class='op'>[</span><span class='va'>adapter</span><span class='op'>]</span> <span class='op'>&lt;&lt;-</span> <span class='va'>total_ways</span> <span class='co'># superassign into lookup table the total ways for this adapter</span>
  
  <span class='kw'><a href='https://rdrr.io/r/base/function.html'>return</a></span><span class='op'>(</span><span class='va'>total_ways</span><span class='op'>)</span>
<span class='op'>}</span>

<span class='va'>p2_solve</span> <span class='op'>&lt;-</span> <span class='va'>p2</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>total_ways <span class='op'>=</span> <span class='fu'><a href='https://purrr.tidyverse.org/reference/map2.html'>map2_dbl</a></span><span class='op'>(</span><span class='va'>ways</span>,<span class='va'>adapter</span>,<span class='va'>sum_ways</span><span class='op'>)</span><span class='op'>)</span>

<span class='fu'><a href='https://rdrr.io/r/base/Extremes.html'>max</a></span><span class='op'>(</span><span class='va'>p2_solve</span><span class='op'>$</span><span class='va'>total_ways</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>[1] 396857386627072</code></pre>
</div>
<div class="sourceCode" id="cb45"><pre class="sourceCode r distill-force-highlighting-css"><code class="sourceCode r"></code></pre></div>
<h2 id="day-11">Day 11</h2>
<p><a href="https://adventofcode.com/2020/day/11" class="uri">https://adventofcode.com/2020/day/11</a></p>
<p>Day eleven - seating system!</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/message.html'>suppressPackageStartupMessages</a></span><span class='op'>(</span><span class='op'>{</span>
  <span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://tidyverse.tidyverse.org'>tidyverse</a></span><span class='op'>)</span>
  <span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://here.r-lib.org/'>here</a></span><span class='op'>)</span>
  <span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://github.com/DavisVaughan/furrr'>furrr</a></span><span class='op'>)</span>
  <span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://github.com/r-lib/memoise'>memoise</a></span><span class='op'>)</span>
  
  <span class='fu'><a href='https://rdrr.io/pkg/future/man/plan.html'>plan</a></span><span class='op'>(</span><span class='va'>multisession</span><span class='op'>)</span>
  
  <span class='fu'>knitr</span><span class='fu'>::</span><span class='va'><a href='https://rdrr.io/pkg/knitr/man/opts_chunk.html'>opts_chunk</a></span><span class='op'>$</span><span class='fu'>set</span><span class='op'>(</span>echo <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>
<span class='op'>}</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<p>— Description —</p>
<blockquote>
<p>All decisions are based on the number of occupied seats adjacent to a given seat (one of the eight positions immediately up, down, left, right, or diagonal from the seat). The following rules are applied to every seat simultaneously:</p>
</blockquote>
<blockquote>
<p>If a seat is empty (L) and there are no occupied seats adjacent to it, the seat becomes occupied. If a seat is occupied (#) and four or more seats adjacent to it are also occupied, the seat becomes empty. Otherwise, the seat’s state does not change.</p>
</blockquote>
— Data —
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>input_11</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://readr.tidyverse.org/reference/read_lines.html'>read_lines</a></span><span class='op'>(</span><span class='fu'><a href='https://here.r-lib.org//reference/here.html'>here</a></span><span class='op'>(</span><span class='st'>"2020"</span>,<span class='st'>"day-11.txt"</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<p>— Cleaning —</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>seat_map</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://tibble.tidyverse.org/reference/tibble.html'>tibble</a></span><span class='op'>(</span>col <span class='op'>=</span> <span class='va'>input_11</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>col <span class='op'>=</span> <span class='fu'><a href='https://stringr.tidyverse.org/reference/str_split.html'>str_split</a></span><span class='op'>(</span><span class='va'>col</span>,<span class='st'>""</span><span class='op'>)</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
  <span class='fu'><a href='https://tidyr.tidyverse.org/reference/hoist.html'>unnest_wider</a></span><span class='op'>(</span><span class='va'>col</span>,names_sep <span class='op'>=</span> <span class='st'>"_"</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate_all.html'>mutate_all</a></span><span class='op'>(</span><span class='op'>~</span><span class='fu'><a href='https://rdrr.io/r/base/replace.html'>replace</a></span><span class='op'>(</span><span class='va'>.x</span>,<span class='va'>.x</span> <span class='op'>==</span> <span class='st'>"."</span>,<span class='cn'>NA</span><span class='op'>)</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate_all.html'>mutate_all</a></span><span class='op'>(</span><span class='op'>~</span><span class='fu'><a href='https://rdrr.io/r/base/replace.html'>replace</a></span><span class='op'>(</span><span class='va'>.x</span>,<span class='va'>.x</span> <span class='op'>==</span> <span class='st'>"L"</span>,<span class='fl'>0</span><span class='op'>)</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate_all.html'>mutate_all</a></span><span class='op'>(</span><span class='va'>as.numeric</span><span class='op'>)</span>

<span class='va'>seat_matrix</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>as.matrix</a></span><span class='op'>(</span><span class='va'>seat_map</span><span class='op'>)</span>

<span class='va'>seat_index</span> <span class='op'>&lt;-</span> <span class='va'>seat_map</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
  <span class='fu'><a href='https://tibble.tidyverse.org/reference/rownames.html'>rownames_to_column</a></span><span class='op'>(</span>var <span class='op'>=</span> <span class='st'>"row_index"</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>row_index <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/numeric.html'>as.numeric</a></span><span class='op'>(</span><span class='va'>row_index</span><span class='op'>)</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
  <span class='fu'><a href='https://tidyr.tidyverse.org/reference/pivot_longer.html'>pivot_longer</a></span><span class='op'>(</span>cols <span class='op'>=</span> <span class='op'>-</span><span class='va'>row_index</span>,names_to <span class='op'>=</span> <span class='st'>"column_index"</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>column_index <span class='op'>=</span> <span class='fu'><a href='https://readr.tidyverse.org/reference/parse_number.html'>parse_number</a></span><span class='op'>(</span><span class='va'>column_index</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<p>Functions</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>generate_adjacent</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>row_index</span>,<span class='va'>column_index</span>,<span class='va'>seat_matrix</span><span class='op'>)</span><span class='op'>{</span>
  
  <span class='va'>check</span> <span class='op'>&lt;-</span> <span class='va'>seat_matrix</span><span class='op'>[[</span><span class='va'>row_index</span>,<span class='va'>column_index</span><span class='op'>]</span><span class='op'>]</span>
  
  <span class='kw'>if</span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/NA.html'>is.na</a></span><span class='op'>(</span><span class='va'>check</span><span class='op'>)</span><span class='op'>)</span> <span class='kw'><a href='https://rdrr.io/r/base/function.html'>return</a></span><span class='op'>(</span><span class='cn'>NA</span><span class='op'>)</span>
  
  <span class='va'>r</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='va'>row_index</span> <span class='op'>-</span> <span class='fl'>1</span>, <span class='va'>row_index</span>, <span class='va'>row_index</span> <span class='op'>+</span> <span class='fl'>1</span><span class='op'>)</span>
  <span class='va'>c</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='va'>column_index</span> <span class='op'>-</span><span class='fl'>1</span>, <span class='va'>column_index</span>, <span class='va'>column_index</span> <span class='op'>+</span> <span class='fl'>1</span><span class='op'>)</span>
  
  <span class='va'>x</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://tidyr.tidyverse.org/reference/expand_grid.html'>expand_grid</a></span><span class='op'>(</span>row <span class='op'>=</span> <span class='va'>r</span>,col <span class='op'>=</span> <span class='va'>c</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
    <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='op'>!</span><span class='op'>(</span><span class='va'>row</span><span class='op'>==</span><span class='va'>row_index</span> <span class='op'>&amp;</span> <span class='va'>col</span><span class='op'>==</span><span class='va'>column_index</span><span class='op'>)</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
    <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='fu'><a href='https://dplyr.tidyverse.org/reference/between.html'>between</a></span><span class='op'>(</span><span class='va'>row</span>,<span class='fl'>1</span>,<span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>nrow</a></span><span class='op'>(</span><span class='va'>seat_matrix</span><span class='op'>)</span><span class='op'>)</span>,<span class='fu'><a href='https://dplyr.tidyverse.org/reference/between.html'>between</a></span><span class='op'>(</span><span class='va'>col</span>,<span class='fl'>1</span>,<span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>ncol</a></span><span class='op'>(</span><span class='va'>seat_matrix</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
    <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>value <span class='op'>=</span> <span class='fu'><a href='https://purrr.tidyverse.org/reference/map2.html'>map2_dbl</a></span><span class='op'>(</span><span class='va'>row</span>,<span class='va'>col</span>,<span class='op'>~</span><span class='va'>seat_matrix</span><span class='op'>[[</span><span class='va'>.x</span>,<span class='va'>.y</span><span class='op'>]</span><span class='op'>]</span><span class='op'>)</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
    <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='op'>!</span><span class='fu'><a href='https://rdrr.io/r/base/NA.html'>is.na</a></span><span class='op'>(</span><span class='va'>value</span><span class='op'>)</span><span class='op'>)</span>
    
  <span class='kw'><a href='https://rdrr.io/r/base/function.html'>return</a></span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span>
<span class='op'>}</span>

<span class='va'>get_seat</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>row</span>,<span class='va'>col</span>,<span class='va'>p1</span><span class='op'>)</span><span class='op'>{</span>
  <span class='va'>p1</span><span class='op'>[[</span><span class='va'>row</span>, <span class='va'>col</span><span class='op'>]</span><span class='op'>]</span>
<span class='op'>}</span>

<span class='va'>count_occupied</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>adjacent_seats</span>,<span class='va'>p1</span><span class='op'>)</span><span class='op'>{</span>

  <span class='kw'>if</span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/logical.html'>is.logical</a></span><span class='op'>(</span><span class='va'>adjacent_seats</span><span class='op'>)</span><span class='op'>)</span> <span class='kw'><a href='https://rdrr.io/r/base/function.html'>return</a></span><span class='op'>(</span><span class='cn'>NA</span><span class='op'>)</span>
  
  <span class='va'>x</span> <span class='op'>&lt;-</span> <span class='va'>adjacent_seats</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
    <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>value <span class='op'>=</span> <span class='fu'><a href='https://purrr.tidyverse.org/reference/map2.html'>map2_dbl</a></span><span class='op'>(</span><span class='va'>.data</span><span class='op'>$</span><span class='va'>row</span>,<span class='va'>.data</span><span class='op'>$</span><span class='va'>col</span>,<span class='va'>get_seat</span>,<span class='va'>p1</span><span class='op'>)</span><span class='op'>)</span>
  
  <span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='va'>x</span><span class='op'>$</span><span class='va'>value</span>,na.rm <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>
<span class='op'>}</span>
</code></pre>
</div>
</div>
<p>— Problem 1 —</p>
<blockquote>
<p>Simulate your seating area by applying the seating rules repeatedly until no seats change state. How many seats end up occupied?</p>
</blockquote>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>p1_index</span> <span class='op'>&lt;-</span> <span class='va'>seat_index</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>adjacent_seats <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/pkg/furrr/man/future_map2.html'>future_map2</a></span><span class='op'>(</span><span class='va'>row_index</span>,<span class='va'>column_index</span>,<span class='va'>generate_adjacent</span>,<span class='va'>seat_matrix</span><span class='op'>)</span><span class='op'>)</span>

<span class='va'>p1</span> <span class='op'>&lt;-</span> <span class='va'>seat_matrix</span>
<span class='va'>total_value</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='va'>p1</span>,na.rm <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>
<span class='va'>total_change</span> <span class='op'>&lt;-</span> <span class='fl'>1</span>
<span class='va'>iteration</span> <span class='op'>&lt;-</span> <span class='fl'>1</span>
<span class='va'>list_changes</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='op'>)</span>

<span class='kw'>while</span><span class='op'>(</span><span class='va'>total_change</span><span class='op'>!=</span><span class='fl'>0</span><span class='op'>)</span><span class='op'>{</span>
  
  <span class='va'>p1_index</span> <span class='op'>&lt;-</span> <span class='va'>p1_index</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
    <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>adjacent_status <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/pkg/furrr/man/future_map.html'>future_map_dbl</a></span><span class='op'>(</span><span class='va'>adjacent_seats</span>,<span class='va'>count_occupied</span>,<span class='va'>p1</span><span class='op'>)</span>,
           value <span class='op'>=</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/case_when.html'>case_when</a></span><span class='op'>(</span><span class='va'>adjacent_status</span> <span class='op'>==</span> <span class='fl'>0</span> <span class='op'>~</span> <span class='fl'>1</span>,
                              <span class='va'>adjacent_status</span> <span class='op'>&gt;=</span><span class='fl'>4</span> <span class='op'>~</span> <span class='fl'>0</span>,
                              <span class='cn'>TRUE</span> <span class='op'>~</span> <span class='va'>value</span><span class='op'>)</span><span class='op'>)</span>
  
  <span class='va'>p1</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span><span class='op'>(</span><span class='va'>p1_index</span><span class='op'>$</span><span class='va'>value</span>,nrow <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>nrow</a></span><span class='op'>(</span><span class='va'>seat_matrix</span><span class='op'>)</span>, ncol <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>ncol</a></span><span class='op'>(</span><span class='va'>seat_matrix</span><span class='op'>)</span>, byrow<span class='op'>=</span><span class='cn'>TRUE</span><span class='op'>)</span>
  
  <span class='va'>change</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='va'>p1</span>,na.rm <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>
  <span class='va'>total_change</span> <span class='op'>&lt;-</span> <span class='va'>change</span> <span class='op'>-</span> <span class='va'>total_value</span>
  <span class='va'>total_value</span> <span class='op'>&lt;-</span> <span class='va'>change</span>
  
  <span class='va'>list_changes</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='va'>list_changes</span>,<span class='va'>change</span><span class='op'>)</span>
  
  <span class='va'>iteration</span> <span class='op'>&lt;-</span> <span class='va'>iteration</span> <span class='op'>+</span> <span class='fl'>1</span>
  
  <span class='fu'><a href='https://rdrr.io/r/base/print.html'>print</a></span><span class='op'>(</span><span class='va'>iteration</span><span class='op'>)</span>
  
<span class='op'>}</span>
</code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>change</span> <span class='co'># last change</span>
</code></pre>
</div>
<pre><code>[1] 2243</code></pre>
</div>
<p>— Problem 2 —</p>
<blockquote>
<p>People don’t just care about adjacent seats - they care about the first seat they can see in each of those eight directions!</p>
</blockquote>
<p>So rewrite the adjacent seats function first, then rerun the loop and get seats etc. Trying matrices for faster speed.</p>
<p>Functions</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>gen_los</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>row_dir</span>,<span class='va'>col_dir</span>,<span class='va'>row_index</span>,<span class='va'>col_index</span>,<span class='va'>row_max</span>,<span class='va'>col_max</span>,<span class='va'>seat_matrix</span><span class='op'>)</span><span class='op'>{</span>
  <span class='kw'>if</span><span class='op'>(</span><span class='op'>!</span><span class='fu'><a href='https://dplyr.tidyverse.org/reference/between.html'>between</a></span><span class='op'>(</span><span class='va'>row_index</span> <span class='op'>+</span> <span class='va'>row_dir</span>,<span class='fl'>1</span>,<span class='va'>row_max</span><span class='op'>)</span><span class='op'>)</span> <span class='kw'><a href='https://rdrr.io/r/base/function.html'>return</a></span><span class='op'>(</span><span class='cn'>NULL</span><span class='op'>)</span>
  <span class='kw'>if</span><span class='op'>(</span><span class='op'>!</span><span class='fu'><a href='https://dplyr.tidyverse.org/reference/between.html'>between</a></span><span class='op'>(</span><span class='va'>col_index</span> <span class='op'>+</span> <span class='va'>col_dir</span>,<span class='fl'>1</span>,<span class='va'>col_max</span><span class='op'>)</span><span class='op'>)</span> <span class='kw'><a href='https://rdrr.io/r/base/function.html'>return</a></span><span class='op'>(</span><span class='cn'>NULL</span><span class='op'>)</span>
  
  <span class='va'>value</span> <span class='op'>&lt;-</span> <span class='va'>seat_matrix</span><span class='op'>[[</span><span class='va'>row_index</span> <span class='op'>+</span> <span class='va'>row_dir</span>,<span class='va'>col_index</span> <span class='op'>+</span> <span class='va'>col_dir</span><span class='op'>]</span><span class='op'>]</span>
  
  <span class='kw'>if</span><span class='op'>(</span><span class='op'>!</span><span class='fu'><a href='https://rdrr.io/r/base/NA.html'>is.na</a></span><span class='op'>(</span><span class='va'>value</span><span class='op'>)</span><span class='op'>)</span> <span class='kw'><a href='https://rdrr.io/r/base/function.html'>return</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>row <span class='op'>=</span> <span class='va'>row_index</span> <span class='op'>+</span> <span class='va'>row_dir</span>, col <span class='op'>=</span> <span class='va'>col_index</span> <span class='op'>+</span> <span class='va'>col_dir</span><span class='op'>)</span><span class='op'>)</span>
  
  <span class='va'>new_rowindex</span> <span class='op'>&lt;-</span> <span class='va'>row_index</span> <span class='op'>+</span> <span class='va'>row_dir</span>
  <span class='va'>new_colindex</span> <span class='op'>&lt;-</span> <span class='va'>col_index</span> <span class='op'>+</span> <span class='va'>col_dir</span>
  
  <span class='fu'>gen_los</span><span class='op'>(</span><span class='va'>row_dir</span>,<span class='va'>col_dir</span>,<span class='va'>new_rowindex</span>,<span class='va'>new_colindex</span>,<span class='va'>row_max</span>,<span class='va'>col_max</span>,<span class='va'>seat_matrix</span><span class='op'>)</span>
<span class='op'>}</span>

<span class='va'>generate_los</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>row_index</span>,<span class='va'>column_index</span>,<span class='va'>seat_matrix</span><span class='op'>)</span><span class='op'>{</span>
  
  <span class='va'>check</span> <span class='op'>&lt;-</span> <span class='va'>seat_matrix</span><span class='op'>[</span><span class='va'>row_index</span>,<span class='va'>column_index</span><span class='op'>]</span>
  
  <span class='kw'>if</span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/NA.html'>is.na</a></span><span class='op'>(</span><span class='va'>check</span><span class='op'>)</span><span class='op'>)</span> <span class='kw'><a href='https://rdrr.io/r/base/function.html'>return</a></span><span class='op'>(</span><span class='cn'>NA</span><span class='op'>)</span>
  
  <span class='va'>r</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='op'>-</span><span class='fl'>1</span>, <span class='fl'>0</span>, <span class='fl'>1</span><span class='op'>)</span>
  <span class='va'>c</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='op'>-</span><span class='fl'>1</span>, <span class='fl'>0</span>, <span class='fl'>1</span><span class='op'>)</span>
  
  <span class='va'>x</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://tidyr.tidyverse.org/reference/expand_grid.html'>expand_grid</a></span><span class='op'>(</span>row <span class='op'>=</span> <span class='va'>r</span>,col <span class='op'>=</span> <span class='va'>c</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
    <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='op'>!</span><span class='op'>(</span><span class='va'>row</span> <span class='op'>==</span> <span class='fl'>0</span> <span class='op'>&amp;</span> <span class='va'>col</span> <span class='op'>==</span> <span class='fl'>0</span><span class='op'>)</span><span class='op'>)</span>
  
  <span class='va'>y</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://purrr.tidyverse.org/reference/map2.html'>map2_dfr</a></span><span class='op'>(</span><span class='va'>x</span><span class='op'>$</span><span class='va'>row</span>,<span class='va'>x</span><span class='op'>$</span><span class='va'>col</span>,<span class='va'>gen_los</span>,<span class='va'>row_index</span>,<span class='va'>column_index</span>,<span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>nrow</a></span><span class='op'>(</span><span class='va'>seat_matrix</span><span class='op'>)</span>,<span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>ncol</a></span><span class='op'>(</span><span class='va'>seat_matrix</span><span class='op'>)</span>,<span class='va'>seat_matrix</span><span class='op'>)</span>
  
  <span class='kw'><a href='https://rdrr.io/r/base/function.html'>return</a></span><span class='op'>(</span><span class='va'>y</span><span class='op'>)</span>
<span class='op'>}</span>

<span class='co'># get_seat2 &lt;- memoise::memoise(get_seat2,cache = cache_filesystem(here("2020/day-11-cache")))</span>

<span class='va'>get_seat2</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>row</span>,<span class='va'>col</span>,<span class='va'>iteration</span><span class='op'>)</span><span class='op'>{</span>
  <span class='va'>p2</span><span class='op'>[</span><span class='va'>row</span>,<span class='va'>col</span><span class='op'>]</span>
<span class='op'>}</span>

<span class='va'>count_occupied2</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>adjacent_seats</span>,<span class='va'>iteration</span><span class='op'>)</span><span class='op'>{</span>
  
  <span class='kw'>if</span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/logical.html'>is.logical</a></span><span class='op'>(</span><span class='va'>adjacent_seats</span><span class='op'>)</span><span class='op'>)</span> <span class='kw'><a href='https://rdrr.io/r/base/function.html'>return</a></span><span class='op'>(</span><span class='cn'>NA</span><span class='op'>)</span>
  
  <span class='va'>x</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://purrr.tidyverse.org/reference/map2.html'>map2_dbl</a></span><span class='op'>(</span><span class='va'>adjacent_seats</span><span class='op'>$</span><span class='va'>row</span>,<span class='va'>adjacent_seats</span><span class='op'>$</span><span class='va'>col</span>,<span class='va'>get_seat2</span>,<span class='va'>iteration</span><span class='op'>)</span> 
  
  <span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='va'>x</span>,na.rm <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>
<span class='op'>}</span>
</code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>p2_index</span> <span class='op'>&lt;-</span> <span class='va'>seat_index</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>row_index <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/numeric.html'>as.numeric</a></span><span class='op'>(</span><span class='va'>row_index</span><span class='op'>)</span>,
         adjacent_seats <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/pkg/furrr/man/future_map2.html'>future_map2</a></span><span class='op'>(</span><span class='va'>row_index</span>,<span class='va'>column_index</span>,<span class='va'>generate_los</span>,<span class='va'>seat_matrix</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>p2</span> <span class='op'>&lt;-</span> <span class='va'>seat_matrix</span>
<span class='va'>total_value2</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='va'>p2</span>,na.rm <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>
<span class='va'>total_change2</span> <span class='op'>&lt;-</span> <span class='fl'>1</span>
<span class='va'>iteration2</span> <span class='op'>&lt;-</span> <span class='fl'>1</span>
<span class='va'>list_changes2</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='op'>)</span>

<span class='kw'>while</span><span class='op'>(</span><span class='va'>total_change2</span><span class='op'>!=</span><span class='fl'>0</span><span class='op'>)</span><span class='op'>{</span>
  
  <span class='va'>p2_index</span> <span class='op'>&lt;-</span> <span class='va'>p2_index</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
    <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>adjacent_status <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/pkg/furrr/man/future_map.html'>future_map_dbl</a></span><span class='op'>(</span><span class='va'>adjacent_seats</span>,<span class='va'>count_occupied2</span>,<span class='va'>iteration2</span><span class='op'>)</span>,
           value <span class='op'>=</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/case_when.html'>case_when</a></span><span class='op'>(</span><span class='va'>adjacent_status</span> <span class='op'>==</span> <span class='fl'>0</span> <span class='op'>~</span> <span class='fl'>1</span>,
                             <span class='va'>adjacent_status</span> <span class='op'>&gt;=</span><span class='fl'>5</span> <span class='op'>~</span> <span class='fl'>0</span>,
                             <span class='cn'>TRUE</span> <span class='op'>~</span> <span class='va'>value</span><span class='op'>)</span><span class='op'>)</span>
  
  <span class='va'>p2</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span><span class='op'>(</span><span class='va'>p2_index</span><span class='op'>$</span><span class='va'>value</span>,nrow <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>nrow</a></span><span class='op'>(</span><span class='va'>seat_matrix</span><span class='op'>)</span>, ncol <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>ncol</a></span><span class='op'>(</span><span class='va'>seat_matrix</span><span class='op'>)</span>, byrow<span class='op'>=</span><span class='cn'>TRUE</span><span class='op'>)</span>
  
  <span class='va'>change2</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='va'>p2</span>,na.rm <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>
  <span class='va'>total_change2</span> <span class='op'>&lt;-</span> <span class='va'>change2</span> <span class='op'>-</span> <span class='va'>total_value2</span>
  <span class='va'>total_value2</span> <span class='op'>&lt;-</span> <span class='va'>change2</span>
  
  <span class='va'>list_changes2</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='va'>list_changes2</span>,<span class='va'>change2</span><span class='op'>)</span>
  
  <span class='va'>iteration2</span> <span class='op'>&lt;-</span> <span class='va'>iteration2</span> <span class='op'>+</span> <span class='fl'>1</span>
  
  <span class='fu'><a href='https://rdrr.io/r/base/print.html'>print</a></span><span class='op'>(</span><span class='va'>iteration2</span><span class='op'>)</span>
  
<span class='op'>}</span>
</code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>change2</span>
</code></pre>
</div>
<pre><code>[1] 2027</code></pre>
</div>
<div class="sourceCode" id="cb48"><pre class="sourceCode r distill-force-highlighting-css"><code class="sourceCode r"></code></pre></div>
<h2 id="day-12">Day 12</h2>
<p><a href="https://adventofcode.com/2020/day/12" class="uri">https://adventofcode.com/2020/day/12</a></p>
<p>Day twelve - Rain Risk!</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/message.html'>suppressPackageStartupMessages</a></span><span class='op'>(</span><span class='op'>{</span>
  <span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://tidyverse.tidyverse.org'>tidyverse</a></span><span class='op'>)</span>
  <span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://here.r-lib.org/'>here</a></span><span class='op'>)</span>
  <span class='co'># library(slider)</span>
  <span class='co'># library(furrr)</span>
  <span class='co'># library(memoise)</span>
  
  <span class='co'># plan(multisession)</span>
  
  <span class='fu'>knitr</span><span class='fu'>::</span><span class='va'><a href='https://rdrr.io/pkg/knitr/man/opts_chunk.html'>opts_chunk</a></span><span class='op'>$</span><span class='fu'>set</span><span class='op'>(</span>echo <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>
<span class='op'>}</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<p>— Description —</p>
<blockquote>
<p>The navigation instructions (your puzzle input) consists of a sequence of single-character actions paired with integer input values. After staring at them for a few minutes, you work out what they probably mean:</p>
<ul>
<li>Action N means to move north by the given value.</li>
<li>Action S means to move south by the given value.</li>
<li>Action E means to move east by the given value.</li>
<li>Action W means to move west by the given value.</li>
<li>Action L means to turn left the given number of degrees.</li>
<li>Action R means to turn right the given number of degrees.</li>
<li>Action F means to move forward by the given value in the direction the ship is currently facing.</li>
</ul>
</blockquote>
<p>— Data —</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>input_12</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://readr.tidyverse.org/reference/read_lines.html'>read_lines</a></span><span class='op'>(</span><span class='fu'><a href='https://here.r-lib.org//reference/here.html'>here</a></span><span class='op'>(</span><span class='st'>"2020"</span>,<span class='st'>"day-12.txt"</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<p>— Cleaning —</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>instructions</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://tibble.tidyverse.org/reference/tibble.html'>tibble</a></span><span class='op'>(</span>instruction <span class='op'>=</span> <span class='va'>input_12</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span>
  <span class='fu'>tidyr</span><span class='fu'>::</span><span class='fu'><a href='https://tidyr.tidyverse.org/reference/extract.html'>extract</a></span><span class='op'>(</span><span class='va'>instruction</span>,into <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"instruction"</span>,<span class='st'>"num"</span><span class='op'>)</span>,regex <span class='op'>=</span> <span class='st'>"^([A-z])([0-9]+)"</span>,convert <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<p>— Problem 1 —</p>
<blockquote>
<p>Figure out where the navigation instructions lead. What is the Manhattan distance between that location and the ship’s starting position?</p>
</blockquote>
<p>Setting out some functions.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>move_nesw1</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>direction</span>,<span class='va'>value</span>,<span class='va'>current_position</span><span class='op'>)</span><span class='op'>{</span>
  
  <span class='kw'><a href='https://rdrr.io/r/base/switch.html'>switch</a></span><span class='op'>(</span><span class='va'>direction</span>,
         <span class='st'>"N"</span> <span class='op'>=</span> <span class='va'>current_position</span><span class='op'>$</span><span class='va'>y</span> <span class='op'>&lt;-</span> <span class='va'>current_position</span><span class='op'>$</span><span class='va'>y</span> <span class='op'>+</span> <span class='va'>value</span>,
         <span class='st'>"E"</span> <span class='op'>=</span> <span class='va'>current_position</span><span class='op'>$</span><span class='va'>x</span> <span class='op'>&lt;-</span> <span class='va'>current_position</span><span class='op'>$</span><span class='va'>x</span> <span class='op'>+</span> <span class='va'>value</span>,
         <span class='st'>"S"</span> <span class='op'>=</span> <span class='va'>current_position</span><span class='op'>$</span><span class='va'>y</span> <span class='op'>&lt;-</span> <span class='va'>current_position</span><span class='op'>$</span><span class='va'>y</span> <span class='op'>-</span> <span class='va'>value</span>,
         <span class='st'>"W"</span> <span class='op'>=</span> <span class='va'>current_position</span><span class='op'>$</span><span class='va'>x</span> <span class='op'>&lt;-</span> <span class='va'>current_position</span><span class='op'>$</span><span class='va'>x</span> <span class='op'>-</span> <span class='va'>value</span>
         <span class='op'>)</span>
  <span class='kw'><a href='https://rdrr.io/r/base/function.html'>return</a></span><span class='op'>(</span><span class='va'>current_position</span><span class='op'>)</span>
<span class='op'>}</span>

<span class='va'>move_lr1</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>direction</span>,<span class='va'>value</span>,<span class='va'>current_position</span><span class='op'>)</span><span class='op'>{</span>
  <span class='kw'><a href='https://rdrr.io/r/base/switch.html'>switch</a></span><span class='op'>(</span><span class='va'>direction</span>,
         <span class='st'>"L"</span> <span class='op'>=</span> <span class='va'>current_position</span><span class='op'>$</span><span class='va'>direction</span> <span class='op'>&lt;-</span> <span class='va'>current_position</span><span class='op'>$</span><span class='va'>direction</span> <span class='op'>+</span> <span class='va'>value</span>,
         <span class='st'>"R"</span> <span class='op'>=</span> <span class='va'>current_position</span><span class='op'>$</span><span class='va'>direction</span> <span class='op'>&lt;-</span> <span class='va'>current_position</span><span class='op'>$</span><span class='va'>direction</span> <span class='op'>-</span> <span class='va'>value</span><span class='op'>)</span>
  
  <span class='kw'>if</span><span class='op'>(</span><span class='va'>current_position</span><span class='op'>$</span><span class='va'>direction</span> <span class='op'>&gt;=</span> <span class='fl'>360</span><span class='op'>)</span> <span class='va'>current_position</span><span class='op'>$</span><span class='va'>direction</span> <span class='op'>&lt;-</span> <span class='va'>current_position</span><span class='op'>$</span><span class='va'>direction</span> <span class='op'><a href='https://rdrr.io/r/base/Arithmetic.html'>%%</a></span> <span class='fl'>360</span>
  
  <span class='kw'>if</span><span class='op'>(</span><span class='va'>current_position</span><span class='op'>$</span><span class='va'>direction</span> <span class='op'>&lt;</span> <span class='fl'>0</span><span class='op'>)</span> <span class='va'>current_position</span><span class='op'>$</span><span class='va'>direction</span> <span class='op'>&lt;-</span> <span class='va'>current_position</span><span class='op'>$</span><span class='va'>direction</span> <span class='op'>+</span> <span class='fl'>360</span>
  
  <span class='kw'><a href='https://rdrr.io/r/base/function.html'>return</a></span><span class='op'>(</span><span class='va'>current_position</span><span class='op'>)</span>
<span class='op'>}</span>

<span class='va'>move_fb1</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>value</span>,<span class='va'>current_position</span><span class='op'>)</span><span class='op'>{</span>
  
  <span class='va'>dir</span> <span class='op'>&lt;-</span> <span class='va'>current_position</span><span class='op'>$</span><span class='va'>direction</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> <span class='va'>as.character</span> 
  
  <span class='kw'><a href='https://rdrr.io/r/base/switch.html'>switch</a></span> <span class='op'>(</span><span class='va'>dir</span>,
    <span class='st'>'0'</span> <span class='op'>=</span> <span class='va'>current_position</span><span class='op'>$</span><span class='va'>x</span> <span class='op'>&lt;-</span> <span class='va'>current_position</span><span class='op'>$</span><span class='va'>x</span> <span class='op'>+</span> <span class='va'>value</span>,
    <span class='st'>'90'</span> <span class='op'>=</span> <span class='va'>current_position</span><span class='op'>$</span><span class='va'>y</span> <span class='op'>&lt;-</span> <span class='va'>current_position</span><span class='op'>$</span><span class='va'>y</span> <span class='op'>+</span> <span class='va'>value</span>,
    <span class='st'>'180'</span> <span class='op'>=</span> <span class='va'>current_position</span><span class='op'>$</span><span class='va'>x</span> <span class='op'>&lt;-</span> <span class='va'>current_position</span><span class='op'>$</span><span class='va'>x</span> <span class='op'>-</span> <span class='va'>value</span>,
    <span class='st'>'270'</span> <span class='op'>=</span> <span class='va'>current_position</span><span class='op'>$</span><span class='va'>y</span> <span class='op'>&lt;-</span> <span class='va'>current_position</span><span class='op'>$</span><span class='va'>y</span> <span class='op'>-</span> <span class='va'>value</span>
  <span class='op'>)</span>
  
  <span class='kw'><a href='https://rdrr.io/r/base/function.html'>return</a></span><span class='op'>(</span><span class='va'>current_position</span><span class='op'>)</span>
<span class='op'>}</span>

<span class='va'>decide_move1</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>current_position</span>,<span class='va'>direction</span>,<span class='va'>value</span><span class='op'>)</span><span class='op'>{</span>
  
  <span class='kw'><a href='https://rdrr.io/r/base/switch.html'>switch</a></span><span class='op'>(</span><span class='va'>direction</span>,
         <span class='st'>"L"</span> <span class='op'>=</span> ,
         <span class='st'>"R"</span> <span class='op'>=</span> <span class='fu'>move_lr1</span><span class='op'>(</span><span class='va'>direction</span>,<span class='va'>value</span>,<span class='va'>current_position</span><span class='op'>)</span>,
         <span class='st'>"F"</span> <span class='op'>=</span> <span class='fu'>move_fb1</span><span class='op'>(</span><span class='va'>value</span>,<span class='va'>current_position</span><span class='op'>)</span>,
         <span class='st'>"N"</span> <span class='op'>=</span> ,
         <span class='st'>"E"</span> <span class='op'>=</span> ,
         <span class='st'>"S"</span> <span class='op'>=</span> ,
         <span class='st'>"W"</span> <span class='op'>=</span> <span class='fu'>move_nesw1</span><span class='op'>(</span><span class='va'>direction</span>,<span class='va'>value</span>,<span class='va'>current_position</span><span class='op'>)</span><span class='op'>)</span>
<span class='op'>}</span>
</code></pre>
</div>
</div>
<p>Now run through the instructions:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>current_position</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>
  direction <span class='op'>=</span> <span class='fl'>0</span>, <span class='co'># where 0 = East</span>
  x <span class='op'>=</span> <span class='fl'>0</span>,
  y <span class='op'>=</span> <span class='fl'>0</span>
<span class='op'>)</span>
<span class='va'>positions</span> <span class='op'>&lt;-</span> <span class='va'>current_position</span>

<span class='kw'>for</span><span class='op'>(</span><span class='va'>i</span> <span class='kw'>in</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq_len</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>nrow</a></span><span class='op'>(</span><span class='va'>instructions</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span><span class='op'>{</span>

  <span class='va'>new_position</span> <span class='op'>&lt;-</span> <span class='fu'>decide_move1</span><span class='op'>(</span><span class='va'>current_position</span>,<span class='va'>instructions</span><span class='op'>$</span><span class='va'>instruction</span><span class='op'>[[</span><span class='va'>i</span><span class='op'>]</span><span class='op'>]</span>,<span class='va'>instructions</span><span class='op'>$</span><span class='va'>num</span><span class='op'>[[</span><span class='va'>i</span><span class='op'>]</span><span class='op'>]</span><span class='op'>)</span>
  
  <span class='va'>positions</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/bind.html'>bind_rows</a></span><span class='op'>(</span><span class='va'>positions</span>,<span class='va'>new_position</span><span class='op'>)</span>
  
  <span class='va'>current_position</span> <span class='op'>&lt;-</span> <span class='va'>new_position</span>
<span class='op'>}</span>
</code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>current_position</span>
</code></pre>
</div>
<pre><code>$direction
[1] 90

$x
[1] -397

$y
[1] -399</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/MathFun.html'>abs</a></span><span class='op'>(</span><span class='va'>current_position</span><span class='op'>$</span><span class='va'>x</span><span class='op'>)</span> <span class='op'>+</span> <span class='fu'><a href='https://rdrr.io/r/base/MathFun.html'>abs</a></span><span class='op'>(</span><span class='va'>current_position</span><span class='op'>$</span><span class='va'>y</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>[1] 796</code></pre>
</div>
<p>— Problem 2 —</p>
<blockquote>
<p>Figure out where the navigation instructions actually lead. What is the Manhattan distance between that location and the ship’s starting position?</p>
</blockquote>
<p>Rewriting previous functions:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>move_waypoint_nesw</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>direction</span>,<span class='va'>value</span>,<span class='va'>current_position</span><span class='op'>)</span><span class='op'>{</span>
  
  <span class='kw'><a href='https://rdrr.io/r/base/switch.html'>switch</a></span><span class='op'>(</span><span class='va'>direction</span>,
         <span class='st'>"N"</span> <span class='op'>=</span> <span class='va'>current_position</span><span class='op'>$</span><span class='va'>waypoint_y</span> <span class='op'>&lt;-</span> <span class='va'>current_position</span><span class='op'>$</span><span class='va'>waypoint_y</span> <span class='op'>+</span> <span class='va'>value</span>,
         <span class='st'>"E"</span> <span class='op'>=</span> <span class='va'>current_position</span><span class='op'>$</span><span class='va'>waypoint_x</span> <span class='op'>&lt;-</span> <span class='va'>current_position</span><span class='op'>$</span><span class='va'>waypoint_x</span> <span class='op'>+</span> <span class='va'>value</span>,
         <span class='st'>"S"</span> <span class='op'>=</span> <span class='va'>current_position</span><span class='op'>$</span><span class='va'>waypoint_y</span> <span class='op'>&lt;-</span> <span class='va'>current_position</span><span class='op'>$</span><span class='va'>waypoint_y</span> <span class='op'>-</span> <span class='va'>value</span>,
         <span class='st'>"W"</span> <span class='op'>=</span> <span class='va'>current_position</span><span class='op'>$</span><span class='va'>waypoint_x</span> <span class='op'>&lt;-</span> <span class='va'>current_position</span><span class='op'>$</span><span class='va'>waypoint_x</span> <span class='op'>-</span> <span class='va'>value</span>
         <span class='op'>)</span>
  <span class='kw'><a href='https://rdrr.io/r/base/function.html'>return</a></span><span class='op'>(</span><span class='va'>current_position</span><span class='op'>)</span>
<span class='op'>}</span>

<span class='va'>move_waypoint_lr</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>direction</span>,<span class='va'>value</span>,<span class='va'>current_position</span><span class='op'>)</span><span class='op'>{</span>

  <span class='va'>new_position</span> <span class='op'>&lt;-</span> <span class='va'>current_position</span>
  
  <span class='kw'>if</span><span class='op'>(</span><span class='va'>value</span> <span class='op'>==</span> <span class='fl'>90</span><span class='op'>)</span><span class='op'>{</span>
    <span class='kw'>if</span><span class='op'>(</span><span class='va'>direction</span> <span class='op'>==</span> <span class='st'>"L"</span><span class='op'>)</span><span class='op'>{</span>
      <span class='va'>new_position</span><span class='op'>$</span><span class='va'>waypoint_x</span> <span class='op'>&lt;-</span> <span class='va'>current_position</span><span class='op'>$</span><span class='va'>waypoint_y</span> <span class='op'>*</span> <span class='op'>-</span><span class='fl'>1</span>
      <span class='va'>new_position</span><span class='op'>$</span><span class='va'>waypoint_y</span> <span class='op'>&lt;-</span> <span class='va'>current_position</span><span class='op'>$</span><span class='va'>waypoint_x</span>
    <span class='op'>}</span>
    <span class='kw'>if</span><span class='op'>(</span><span class='va'>direction</span> <span class='op'>==</span> <span class='st'>"R"</span><span class='op'>)</span><span class='op'>{</span>
      <span class='va'>new_position</span><span class='op'>$</span><span class='va'>waypoint_x</span> <span class='op'>&lt;-</span> <span class='va'>current_position</span><span class='op'>$</span><span class='va'>waypoint_y</span> 
      <span class='va'>new_position</span><span class='op'>$</span><span class='va'>waypoint_y</span> <span class='op'>&lt;-</span> <span class='va'>current_position</span><span class='op'>$</span><span class='va'>waypoint_x</span> <span class='op'>*</span> <span class='op'>-</span><span class='fl'>1</span>
    <span class='op'>}</span>
  <span class='op'>}</span>
  
  <span class='kw'>if</span><span class='op'>(</span><span class='va'>value</span> <span class='op'>==</span> <span class='fl'>180</span><span class='op'>)</span><span class='op'>{</span>
    <span class='va'>new_position</span><span class='op'>$</span><span class='va'>waypoint_x</span> <span class='op'>&lt;-</span> <span class='va'>current_position</span><span class='op'>$</span><span class='va'>waypoint_x</span> <span class='op'>*</span> <span class='op'>-</span><span class='fl'>1</span>
    <span class='va'>new_position</span><span class='op'>$</span><span class='va'>waypoint_y</span> <span class='op'>&lt;-</span> <span class='va'>current_position</span><span class='op'>$</span><span class='va'>waypoint_y</span> <span class='op'>*</span> <span class='op'>-</span><span class='fl'>1</span>
  <span class='op'>}</span>
  
  <span class='kw'>if</span><span class='op'>(</span><span class='va'>value</span> <span class='op'>==</span> <span class='fl'>270</span><span class='op'>)</span><span class='op'>{</span>
    <span class='kw'>if</span><span class='op'>(</span><span class='va'>direction</span> <span class='op'>==</span> <span class='st'>"R"</span><span class='op'>)</span><span class='op'>{</span>
      <span class='va'>new_position</span><span class='op'>$</span><span class='va'>waypoint_x</span> <span class='op'>&lt;-</span> <span class='va'>current_position</span><span class='op'>$</span><span class='va'>waypoint_y</span> <span class='op'>*</span> <span class='op'>-</span><span class='fl'>1</span>
      <span class='va'>new_position</span><span class='op'>$</span><span class='va'>waypoint_y</span> <span class='op'>&lt;-</span> <span class='va'>current_position</span><span class='op'>$</span><span class='va'>waypoint_x</span>
    <span class='op'>}</span>
    <span class='kw'>if</span><span class='op'>(</span><span class='va'>direction</span> <span class='op'>==</span> <span class='st'>"L"</span><span class='op'>)</span><span class='op'>{</span>
      <span class='va'>new_position</span><span class='op'>$</span><span class='va'>waypoint_x</span> <span class='op'>&lt;-</span> <span class='va'>current_position</span><span class='op'>$</span><span class='va'>waypoint_y</span> 
      <span class='va'>new_position</span><span class='op'>$</span><span class='va'>waypoint_y</span> <span class='op'>&lt;-</span> <span class='va'>current_position</span><span class='op'>$</span><span class='va'>waypoint_x</span> <span class='op'>*</span> <span class='op'>-</span><span class='fl'>1</span>
    <span class='op'>}</span>
  <span class='op'>}</span>
  
  <span class='kw'><a href='https://rdrr.io/r/base/function.html'>return</a></span><span class='op'>(</span><span class='va'>new_position</span><span class='op'>)</span>
<span class='op'>}</span>

<span class='va'>move_fb_waypoint</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>value</span>,<span class='va'>current_position</span><span class='op'>)</span><span class='op'>{</span>
  
  <span class='va'>dir</span> <span class='op'>&lt;-</span> <span class='va'>current_position</span><span class='op'>$</span><span class='va'>direction</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> <span class='va'>as.character</span> 
  
  <span class='va'>current_position</span><span class='op'>$</span><span class='va'>ship_x</span> <span class='op'>&lt;-</span> <span class='va'>current_position</span><span class='op'>$</span><span class='va'>ship_x</span> <span class='op'>+</span> <span class='op'>(</span><span class='va'>value</span> <span class='op'>*</span> <span class='va'>current_position</span><span class='op'>$</span><span class='va'>waypoint_x</span><span class='op'>)</span>
  <span class='va'>current_position</span><span class='op'>$</span><span class='va'>ship_y</span> <span class='op'>&lt;-</span> <span class='va'>current_position</span><span class='op'>$</span><span class='va'>ship_y</span> <span class='op'>+</span> <span class='op'>(</span><span class='va'>value</span> <span class='op'>*</span> <span class='va'>current_position</span><span class='op'>$</span><span class='va'>waypoint_y</span><span class='op'>)</span>
  
  <span class='kw'><a href='https://rdrr.io/r/base/function.html'>return</a></span><span class='op'>(</span><span class='va'>current_position</span><span class='op'>)</span>
<span class='op'>}</span>

<span class='va'>decide_move2</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>current_position</span>,<span class='va'>direction</span>,<span class='va'>value</span><span class='op'>)</span><span class='op'>{</span>
  
  <span class='kw'><a href='https://rdrr.io/r/base/switch.html'>switch</a></span><span class='op'>(</span><span class='va'>direction</span>,
         <span class='st'>"L"</span> <span class='op'>=</span> ,
         <span class='st'>"R"</span> <span class='op'>=</span> <span class='fu'>move_waypoint_lr</span><span class='op'>(</span><span class='va'>direction</span>,<span class='va'>value</span>,<span class='va'>current_position</span><span class='op'>)</span>,
         <span class='st'>"N"</span> <span class='op'>=</span> ,
         <span class='st'>"E"</span> <span class='op'>=</span> ,
         <span class='st'>"S"</span> <span class='op'>=</span> ,
         <span class='st'>"W"</span> <span class='op'>=</span> <span class='fu'>move_waypoint_nesw</span><span class='op'>(</span><span class='va'>direction</span>,<span class='va'>value</span>,<span class='va'>current_position</span><span class='op'>)</span>,
         <span class='st'>"F"</span> <span class='op'>=</span> <span class='fu'>move_fb_waypoint</span><span class='op'>(</span><span class='va'>value</span>,<span class='va'>current_position</span><span class='op'>)</span>
  <span class='op'>)</span>
<span class='op'>}</span>
</code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>current_position</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>
  waypoint_x <span class='op'>=</span> <span class='fl'>10</span>,
  waypoint_y <span class='op'>=</span> <span class='fl'>1</span>,
  ship_x <span class='op'>=</span> <span class='fl'>0</span>,
  ship_y <span class='op'>=</span> <span class='fl'>0</span>
<span class='op'>)</span>

<span class='va'>positions</span> <span class='op'>&lt;-</span> <span class='va'>current_position</span>

<span class='kw'>for</span><span class='op'>(</span><span class='va'>i</span> <span class='kw'>in</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq_len</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>nrow</a></span><span class='op'>(</span><span class='va'>instructions</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span><span class='op'>{</span>

  <span class='va'>new_position</span> <span class='op'>&lt;-</span> <span class='fu'>decide_move2</span><span class='op'>(</span><span class='va'>current_position</span>,<span class='va'>instructions</span><span class='op'>$</span><span class='va'>instruction</span><span class='op'>[[</span><span class='va'>i</span><span class='op'>]</span><span class='op'>]</span>,<span class='va'>instructions</span><span class='op'>$</span><span class='va'>num</span><span class='op'>[[</span><span class='va'>i</span><span class='op'>]</span><span class='op'>]</span><span class='op'>)</span>
  
  <span class='va'>positions</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/bind.html'>bind_rows</a></span><span class='op'>(</span><span class='va'>positions</span>,<span class='va'>new_position</span><span class='op'>)</span>
  
  <span class='va'>current_position</span> <span class='op'>&lt;-</span> <span class='va'>new_position</span>
<span class='op'>}</span>
</code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>current_position</span>
</code></pre>
</div>
<pre><code>$waypoint_x
[1] 26

$waypoint_y
[1] 37

$ship_x
[1] -24417

$ship_y
[1] -15029</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/MathFun.html'>abs</a></span><span class='op'>(</span><span class='va'>current_position</span><span class='op'>$</span><span class='va'>ship_x</span><span class='op'>)</span> <span class='op'>+</span> <span class='fu'><a href='https://rdrr.io/r/base/MathFun.html'>abs</a></span><span class='op'>(</span><span class='va'>current_position</span><span class='op'>$</span><span class='va'>ship_y</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>[1] 39446</code></pre>
</div>
<div class="sourceCode" id="cb53"><pre class="sourceCode r distill-force-highlighting-css"><code class="sourceCode r"></code></pre></div>
<h2 id="day-13">Day 13</h2>
<p><a href="https://adventofcode.com/2020/day/13" class="uri">https://adventofcode.com/2020/day/13</a></p>
<p>Day thirteen - shuttle search!</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/message.html'>suppressPackageStartupMessages</a></span><span class='op'>(</span><span class='op'>{</span>
  <span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://tidyverse.tidyverse.org'>tidyverse</a></span><span class='op'>)</span>
  <span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://here.r-lib.org/'>here</a></span><span class='op'>)</span>
  <span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://github.com/tidyverse/glue'>glue</a></span><span class='op'>)</span>
  <span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://httr.r-lib.org/'>httr</a></span><span class='op'>)</span>

  <span class='co'># plan(multisession)</span>
  <span class='fu'><a href='https://rdrr.io/r/base/options.html'>options</a></span><span class='op'>(</span>scipen  <span class='op'>=</span>  <span class='fl'>9999999</span><span class='op'>)</span>
  <span class='fu'>knitr</span><span class='fu'>::</span><span class='va'><a href='https://rdrr.io/pkg/knitr/man/opts_chunk.html'>opts_chunk</a></span><span class='op'>$</span><span class='fu'>set</span><span class='op'>(</span>echo <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>
<span class='op'>}</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<p>— Description —</p>
<blockquote>
<p>Your notes (your puzzle input) consist of two lines. The first line is your estimate of the earliest timestamp you could depart on a bus. The second line lists the bus IDs that are in service according to the shuttle company; entries that show x must be out of service, so you decide to ignore them.</p>
<p>To save time once you arrive, your goal is to figure out the earliest bus you can take to the airport. (There will be exactly one such bus.)</p>
</blockquote>
— Data —
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>input_13</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://readr.tidyverse.org/reference/read_lines.html'>read_lines</a></span><span class='op'>(</span><span class='fu'><a href='https://here.r-lib.org//reference/here.html'>here</a></span><span class='op'>(</span><span class='st'>"2020"</span>,<span class='st'>"day-13.txt"</span><span class='op'>)</span><span class='op'>)</span>

<span class='va'>input_13_e</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"939"</span>,<span class='st'>"7,13,x,x,59,x,31,19"</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<p>—Cleaning—</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>earliest_timestamp</span> <span class='op'>&lt;-</span> <span class='va'>input_13</span><span class='op'>[[</span><span class='fl'>1</span><span class='op'>]</span><span class='op'>]</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> <span class='va'>as.numeric</span>

<span class='va'>earliest_timestamp_e</span> <span class='op'>&lt;-</span> <span class='va'>input_13_e</span><span class='op'>[[</span><span class='fl'>1</span><span class='op'>]</span><span class='op'>]</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> <span class='va'>as.numeric</span>

<span class='va'>bus_departures</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://tibble.tidyverse.org/reference/tibble.html'>tibble</a></span><span class='op'>(</span>id <span class='op'>=</span> <span class='va'>input_13</span><span class='op'>[[</span><span class='fl'>2</span><span class='op'>]</span><span class='op'>]</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
  <span class='fu'><a href='https://tidyr.tidyverse.org/reference/separate_rows.html'>separate_rows</a></span><span class='op'>(</span><span class='va'>id</span>,sep <span class='op'>=</span> <span class='st'>","</span><span class='op'>)</span>

<span class='va'>bus_departures_e</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://tibble.tidyverse.org/reference/tibble.html'>tibble</a></span><span class='op'>(</span>id <span class='op'>=</span> <span class='va'>input_13_e</span><span class='op'>[[</span><span class='fl'>2</span><span class='op'>]</span><span class='op'>]</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
  <span class='fu'><a href='https://tidyr.tidyverse.org/reference/separate_rows.html'>separate_rows</a></span><span class='op'>(</span><span class='va'>id</span>,sep <span class='op'>=</span> <span class='st'>","</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<p>— Problem 1 —</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>p1</span> <span class='op'>&lt;-</span> <span class='va'>bus_departures</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>id</span> <span class='op'>!=</span> <span class='st'>"x"</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>id <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/numeric.html'>as.numeric</a></span><span class='op'>(</span><span class='va'>id</span><span class='op'>)</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>next_departure <span class='op'>=</span> <span class='va'>earliest_timestamp</span> <span class='op'><a href='https://rdrr.io/r/base/Arithmetic.html'>%/%</a></span> <span class='va'>id</span> <span class='op'>*</span> <span class='va'>id</span>,
         next_departure <span class='op'>=</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/case_when.html'>case_when</a></span><span class='op'>(</span><span class='va'>earliest_timestamp</span> <span class='op'>&gt;</span> <span class='va'>next_departure</span> <span class='op'>~</span> <span class='va'>next_departure</span> <span class='op'>+</span> <span class='va'>id</span>,
                                    <span class='cn'>TRUE</span> <span class='op'>~</span> <span class='va'>next_departure</span><span class='op'>)</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/arrange.html'>arrange</a></span><span class='op'>(</span><span class='va'>next_departure</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/utils/head.html'>head</a></span><span class='op'>(</span><span class='va'>p1</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code># A tibble: 6 x 2
     id next_departure
  &lt;dbl&gt;          &lt;dbl&gt;
1   647        1006732
2    23        1006733
3    13        1006733
4    37        1006733
5    19        1006734
6    29        1006735</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>p1</span><span class='op'>$</span><span class='va'>id</span><span class='op'>[[</span><span class='fl'>1</span><span class='op'>]</span><span class='op'>]</span> <span class='op'>*</span> <span class='op'>(</span><span class='va'>p1</span><span class='op'>$</span><span class='va'>next_departure</span><span class='op'>[[</span><span class='fl'>1</span><span class='op'>]</span><span class='op'>]</span> <span class='op'>-</span> <span class='va'>earliest_timestamp</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>[1] 3882</code></pre>
</div>
<p>— Problem 2 —</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>p2</span> <span class='op'>&lt;-</span> <span class='va'>bus_departures</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>offset <span class='op'>=</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/ranking.html'>row_number</a></span><span class='op'>(</span><span class='op'>)</span><span class='op'>-</span><span class='fl'>1</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>id</span> <span class='op'>!=</span> <span class='st'>"x"</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>id <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/numeric.html'>as.numeric</a></span><span class='op'>(</span><span class='va'>id</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<p>My naive solution looked like this:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>run_checks</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>timestamp</span>,<span class='va'>id</span>,<span class='va'>offset</span><span class='op'>)</span><span class='op'>{</span>
  <span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='op'>(</span><span class='va'>timestamp</span><span class='op'>+</span><span class='va'>offset</span><span class='op'>)</span> <span class='op'><a href='https://rdrr.io/r/base/Arithmetic.html'>%%</a></span> <span class='va'>id</span><span class='op'>)</span>
<span class='op'>}</span>

<span class='va'>biggest_factor</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/Extremes.html'>max</a></span><span class='op'>(</span><span class='va'>p2</span><span class='op'>$</span><span class='va'>id</span><span class='op'>)</span>

<span class='va'>timestamp</span> <span class='op'>&lt;-</span> <span class='fl'>100000000000000</span> <span class='op'><a href='https://rdrr.io/r/base/Arithmetic.html'>%/%</a></span> <span class='va'>biggest_factor</span> <span class='op'>*</span> <span class='va'>biggest_factor</span>

<span class='va'>sum</span> <span class='op'>&lt;-</span> <span class='fl'>1</span>

<span class='kw'>while</span><span class='op'>(</span><span class='va'>sum</span><span class='op'>!=</span><span class='fl'>0</span><span class='op'>)</span><span class='op'>{</span>
  <span class='va'>timestamp</span> <span class='op'>&lt;-</span> <span class='va'>timestamp</span><span class='op'>+</span><span class='va'>biggest_factor</span>
  <span class='va'>sum</span> <span class='op'>&lt;-</span> <span class='fu'>run_checks</span><span class='op'>(</span><span class='va'>timestamp</span>,<span class='va'>p2</span><span class='op'>$</span><span class='va'>id</span>,<span class='va'>p2</span><span class='op'>$</span><span class='va'>offset</span><span class='op'>)</span>
<span class='op'>}</span>

<span class='va'>timestamp</span>
</code></pre>
</div>
</div>
<p>While I was waiting for the first loop, I started reading solutions in other languages. I’m admittedly getting a little out of my depth, and noticed a) people talking about the naive/brute-force solution being incredibly slow even in a language like C, b) how many people looked up and implemented Chinese Remainder Theorem (some math concept I’d never heard of) and c) how many people just copied their problem into an online solver.</p>
<p>I don’t have the math chops to teach myself CRT at 1:30 am, so I decided to look around at some other options.</p>
<p>Firstly, trying the {numbers} package I found on CRAN, which professed to have a <code>chinese()</code> function.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'>numbers</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/options.html'>options</a></span><span class='op'>(</span>scipen <span class='op'>=</span> <span class='fl'>999</span><span class='op'>)</span>

<span class='fu'>chinese</span><span class='op'>(</span><span class='va'>p2</span><span class='op'>$</span><span class='va'>offset</span>,<span class='va'>p2</span><span class='op'>$</span><span class='va'>id</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<pre><code>[1] 663851081414962</code></pre>
</div>
<p>This … seemed … promising - but failed to pass muster as the solution.</p>
<p>I futzed with this, thinking that I’d done it wrong and set things up incorrectly - but alas, no dice.</p>
<p>Next, Reddit suggested Rosetta Code as a place to get functions in any programming language for CRT, so I toyed with that:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>mul_inv</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>a</span>, <span class='va'>b</span><span class='op'>)</span>
<span class='op'>{</span>
  <span class='va'>b0</span> <span class='op'>&lt;-</span> <span class='va'>b</span>
  <span class='va'>x0</span> <span class='op'>&lt;-</span> <span class='fl'>0L</span>
  <span class='va'>x1</span> <span class='op'>&lt;-</span> <span class='fl'>1L</span>
 
  <span class='kw'>if</span> <span class='op'>(</span><span class='va'>b</span> <span class='op'>==</span> <span class='fl'>1</span><span class='op'>)</span> <span class='kw'><a href='https://rdrr.io/r/base/function.html'>return</a></span><span class='op'>(</span><span class='fl'>1L</span><span class='op'>)</span>
  <span class='kw'>while</span><span class='op'>(</span><span class='va'>a</span> <span class='op'>&gt;</span> <span class='fl'>1</span><span class='op'>)</span><span class='op'>{</span>
    <span class='va'>q</span> <span class='op'>&lt;-</span> <span class='va'>a</span><span class='op'>/</span><span class='va'>b</span>
 
    <span class='va'>t</span> <span class='op'>&lt;-</span> <span class='va'>b</span>
    <span class='va'>b</span> <span class='op'>&lt;-</span> <span class='va'>a</span> <span class='op'><a href='https://rdrr.io/r/base/Arithmetic.html'>%%</a></span> <span class='va'>b</span>
    <span class='va'>a</span> <span class='op'>&lt;-</span> <span class='va'>t</span>
 
    <span class='va'>t</span> <span class='op'>&lt;-</span> <span class='va'>x0</span>
    <span class='va'>x0</span> <span class='op'>&lt;-</span> <span class='va'>x1</span> <span class='op'>-</span> <span class='va'>q</span><span class='op'>*</span><span class='va'>x0</span>
    <span class='va'>x1</span> <span class='op'>&lt;-</span> <span class='va'>t</span>
  <span class='op'>}</span>
 
  <span class='kw'>if</span> <span class='op'>(</span><span class='va'>x1</span> <span class='op'>&lt;</span> <span class='fl'>0</span><span class='op'>)</span> <span class='va'>x1</span> <span class='op'>&lt;-</span> <span class='va'>x1</span> <span class='op'>+</span> <span class='va'>b0</span>
  <span class='kw'><a href='https://rdrr.io/r/base/function.html'>return</a></span><span class='op'>(</span><span class='va'>x1</span><span class='op'>)</span>
<span class='op'>}</span>
 
<span class='va'>chinese_remainder</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>n</span>, <span class='va'>a</span><span class='op'>)</span>
<span class='op'>{</span>
  <span class='va'>len</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span><span class='op'>(</span><span class='va'>n</span><span class='op'>)</span>
 
  <span class='va'>prod</span> <span class='op'>&lt;-</span> <span class='fl'>1L</span>
  <span class='va'>sum</span> <span class='op'>&lt;-</span> <span class='fl'>0L</span>
 
  <span class='kw'>for</span> <span class='op'>(</span><span class='va'>i</span> <span class='kw'>in</span> <span class='fl'>1</span><span class='op'>:</span><span class='va'>len</span><span class='op'>)</span> <span class='va'>prod</span> <span class='op'>&lt;-</span> <span class='va'>prod</span> <span class='op'>*</span> <span class='va'>n</span><span class='op'>[</span><span class='va'>i</span><span class='op'>]</span>
 
  <span class='kw'>for</span> <span class='op'>(</span><span class='va'>i</span> <span class='kw'>in</span> <span class='fl'>1</span><span class='op'>:</span><span class='va'>len</span><span class='op'>)</span><span class='op'>{</span>
    <span class='va'>p</span> <span class='op'>&lt;-</span> <span class='va'>prod</span> <span class='op'>/</span> <span class='va'>n</span><span class='op'>[</span><span class='va'>i</span><span class='op'>]</span>
    <span class='va'>sum</span> <span class='op'>&lt;-</span> <span class='va'>sum</span> <span class='op'>+</span> <span class='va'>a</span><span class='op'>[</span><span class='va'>i</span><span class='op'>]</span> <span class='op'>*</span> <span class='fu'>mul_inv</span><span class='op'>(</span><span class='va'>p</span>, <span class='va'>n</span><span class='op'>[</span><span class='va'>i</span><span class='op'>]</span><span class='op'>)</span> <span class='op'>*</span> <span class='va'>p</span>
  <span class='op'>}</span>
 
  <span class='kw'><a href='https://rdrr.io/r/base/function.html'>return</a></span><span class='op'>(</span><span class='va'>sum</span> <span class='op'><a href='https://rdrr.io/r/base/Arithmetic.html'>%%</a></span> <span class='va'>prod</span><span class='op'>)</span>
<span class='op'>}</span>
 
<span class='va'>n</span> <span class='op'>&lt;-</span> <span class='va'>p2</span><span class='op'>$</span><span class='va'>id</span>
<span class='va'>a</span> <span class='op'>&lt;-</span> <span class='va'>p2</span><span class='op'>$</span><span class='va'>offset</span>
 
<span class='fu'>chinese_remainder</span><span class='op'>(</span><span class='va'>n</span>, <span class='va'>a</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<pre><code>[1] 502023422045264</code></pre>
</div>
<p>but also no dice. I figure it’s reaching R’s bigint limits, or something, and causing rounding/float errors.</p>
<p>Finally, I resorted to just getting old faithful, Wolfram Alpha, to solve the system of equations.</p>
<p>I’m an honorable cheat though: I figured I’d limit myself to learning and using the Wolfram Alpha API instead.</p>
Here’s some of my standard set of packages for interacting with APIs:
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://httr.r-lib.org/'>httr</a></span><span class='op'>)</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://github.com/tidyverse/glue'>glue</a></span><span class='op'>)</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://xml2.r-lib.org/'>xml2</a></span><span class='op'>)</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://rvest.tidyverse.org/'>rvest</a></span><span class='op'>)</span>
</code></pre>
</div>
</div>
<p>You need to sign up for an API app ID, which is free but limited to 2000 queries per month. <a href="https://products.wolframalpha.com/api" class="uri">https://products.wolframalpha.com/api</a></p>
<p>I’ve got my apikey saved as a system environment variable, there are other ways to handle the secret (rstudioapi, keyring, etc)</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>apikey</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/Sys.getenv.html'>Sys.getenv</a></span><span class='op'>(</span><span class='st'>"wolfram_alpha"</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<p>Create the system of equations and reduce it into a single comma separated string</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>equations</span> <span class='op'>&lt;-</span> <span class='fu'>glue</span><span class='fu'>::</span><span class='fu'><a href='https://glue.tidyverse.org/reference/glue.html'>glue</a></span><span class='op'>(</span><span class='st'>"(x + {p2$offset}) mod {p2$id}=0"</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> <span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste</a></span><span class='op'>(</span>collapse <span class='op'>=</span> <span class='st'>","</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<p>Send the equations and the apikey as html query parameters in a GET request</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>response</span> <span class='op'>&lt;-</span> <span class='fu'>httr</span><span class='fu'>::</span><span class='fu'><a href='https://httr.r-lib.org/reference/GET.html'>GET</a></span><span class='op'>(</span><span class='st'>"http://api.wolframalpha.com/v2/query"</span>,
               query <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>input <span class='op'>=</span> <span class='va'>equations</span>,
                            appid <span class='op'>=</span> <span class='va'>apikey</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<p>Parse the response, drilling down to the plaintext.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>resp_content</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://httr.r-lib.org/reference/content.html'>content</a></span><span class='op'>(</span><span class='va'>response</span>,as <span class='op'>=</span> <span class='st'>"parsed"</span><span class='op'>)</span>

<span class='va'>plaintext</span> <span class='op'>&lt;-</span> <span class='va'>resp_content</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
  <span class='fu'><a href='https://rvest.tidyverse.org/reference/rename.html'>html_nodes</a></span><span class='op'>(</span><span class='st'>"plaintext"</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
  <span class='fu'><a href='https://rvest.tidyverse.org/reference/html_text.html'>html_text</a></span><span class='op'>(</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>plaintext</span> 
</code></pre>
</div>
<pre><code>[1] &quot;{(x + 0) mod 23 = 0, (x + 13) mod 41 = 0, (x + 23) mod 647 = 0, (x + 41) mod 13 = 0, (x + 42) mod 19 = 0, (x + 52) mod 29 = 0, (x + 54) mod 557 = 0, (x + 60) mod 37 = 0, (x + 71) mod 17 = 0}&quot;                                                                                                                                
[2] &quot;{x mod 23 = 0, (x + 13) mod 41 = 0, (x + 23) mod 647 = 0, (x + 41) mod 13 = 0, (x + 42) mod 19 = 0, (x + 52) mod 29 = 0, (x + 54) mod 557 = 0, (x + 60) mod 37 = 0, (x + 71) mod 17 = 0}&quot;                                                                                                                                      
[3] &quot;{x - 23 floor(x/23) = 0, -41 floor((x + 13)/41) + x + 13 = 0, -647 floor((x + 23)/647) + x + 23 = 0, -13 floor((x + 2)/13) + x + 2 = 0, -19 floor((x + 4)/19) + x + 4 = 0, -29 floor((x + 23)/29) + x + 23 = 0, -557 floor((x + 54)/557) + x + 54 = 0, -37 floor((x + 23)/37) + x + 23 = 0, -17 floor((x + 3)/17) + x + 3 = 0}&quot;
[4] &quot;x = 1531146567793219 n + 867295486378319, n element Z&quot;                                                                                                                                                                                                                                                                         </code></pre>
</div>
<p>Visually inspecting the plaintext shows that the answer to the equation is x = 1531146567793219 n + 867295486378319, n element Z - and the lowest/first possible answer is where n = 0, so that would just leave the intercept of 867295486378319.</p>
<p>This indeed was the final answer! FWIW, I also left the while loop running while I worked on the other approaches - and it did not succeed.</p>
<div class="sourceCode" id="cb59"><pre class="sourceCode r distill-force-highlighting-css"><code class="sourceCode r"></code></pre></div>
<h2 id="day-14">Day 14</h2>
<p><a href="https://adventofcode.com/2020/day/14" class="uri">https://adventofcode.com/2020/day/14</a></p>
<p>Day fourteen - Docking Data!</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/message.html'>suppressPackageStartupMessages</a></span><span class='op'>(</span><span class='op'>{</span>
  <span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://tidyverse.tidyverse.org'>tidyverse</a></span><span class='op'>)</span>
  <span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://here.r-lib.org/'>here</a></span><span class='op'>)</span>
  <span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://github.com/d4ndo/binaryLogic'>binaryLogic</a></span><span class='op'>)</span>

  <span class='fu'><a href='https://rdrr.io/r/base/options.html'>options</a></span><span class='op'>(</span>scipen  <span class='op'>=</span>  <span class='fl'>9999999</span><span class='op'>)</span>
  <span class='fu'>knitr</span><span class='fu'>::</span><span class='va'><a href='https://rdrr.io/pkg/knitr/man/opts_chunk.html'>opts_chunk</a></span><span class='op'>$</span><span class='fu'>set</span><span class='op'>(</span>echo <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>
<span class='op'>}</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<p>— Description —</p>
<blockquote>
<p>The initialization program (your puzzle input) can either update the bitmask or write a value to memory. Values and memory addresses are both 36-bit unsigned integers. For example, ignoring bitmasks for a moment, a line like mem[8] = 11 would write the value 11 to memory address 8.</p>
</blockquote>
— Data —
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>input_14</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://readr.tidyverse.org/reference/read_lines.html'>read_lines</a></span><span class='op'>(</span><span class='fu'><a href='https://here.r-lib.org//reference/here.html'>here</a></span><span class='op'>(</span><span class='st'>"2020"</span>,<span class='st'>"day-14.txt"</span><span class='op'>)</span><span class='op'>)</span>

<span class='va'>input_14_e1</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://readr.tidyverse.org/reference/read_lines.html'>read_lines</a></span><span class='op'>(</span><span class='fu'><a href='https://here.r-lib.org//reference/here.html'>here</a></span><span class='op'>(</span><span class='st'>"2020"</span>,<span class='st'>"day-14-example1.txt"</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<p>— Problem 1 —</p>
<p>So I think I’ll try super-assigning into a global “current_mask” and “current_memory” list, and create functions to update the mask and to write into the memory list.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>current_mask</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span><span class='op'>)</span>
<span class='va'>current_memory</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/numeric.html'>numeric</a></span><span class='op'>(</span><span class='op'>)</span>

<span class='va'>choose_function</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>instruction</span><span class='op'>)</span><span class='op'>{</span>
  
  <span class='kw'>if</span><span class='op'>(</span><span class='fu'><a href='https://stringr.tidyverse.org/reference/str_detect.html'>str_detect</a></span><span class='op'>(</span><span class='va'>instruction</span>,<span class='st'>"mask"</span><span class='op'>)</span><span class='op'>)</span> <span class='fu'>update_mask</span><span class='op'>(</span><span class='va'>instruction</span><span class='op'>)</span>
  
  <span class='kw'>if</span><span class='op'>(</span><span class='fu'><a href='https://stringr.tidyverse.org/reference/str_detect.html'>str_detect</a></span><span class='op'>(</span><span class='va'>instruction</span>,<span class='st'>"mem"</span><span class='op'>)</span><span class='op'>)</span> <span class='fu'><a href='https://httr.r-lib.org/reference/write_disk.html'>write_memory</a></span><span class='op'>(</span><span class='va'>instruction</span><span class='op'>)</span>
<span class='op'>}</span>

<span class='va'>update_mask</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>instruction</span><span class='op'>)</span><span class='op'>{</span>
  
  <span class='va'>mask</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://stringr.tidyverse.org/reference/str_remove.html'>str_remove</a></span><span class='op'>(</span><span class='va'>instruction</span>, <span class='st'>"mask = "</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> <span class='fu'><a href='https://stringr.tidyverse.org/reference/str_split.html'>str_split</a></span><span class='op'>(</span><span class='st'>""</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> <span class='fu'><a href='https://rdrr.io/r/base/unlist.html'>unlist</a></span><span class='op'>(</span><span class='op'>)</span>
  
  <span class='va'>mask_locations</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://stringr.tidyverse.org/reference/str_subset.html'>str_which</a></span><span class='op'>(</span><span class='va'>mask</span>,<span class='st'>"X"</span>,negate <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>

  <span class='va'>current_mask</span> <span class='op'>&lt;&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>
    location <span class='op'>=</span> <span class='va'>mask_locations</span>,
    value <span class='op'>=</span> <span class='va'>mask</span><span class='op'>[</span><span class='va'>mask_locations</span><span class='op'>]</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> <span class='fu'><a href='https://rdrr.io/r/base/integer.html'>as.integer</a></span><span class='op'>(</span><span class='op'>)</span>
  <span class='op'>)</span>
  
  <span class='kw'><a href='https://rdrr.io/r/base/function.html'>return</a></span><span class='op'>(</span><span class='va'>current_mask</span><span class='op'>)</span>
<span class='op'>}</span>

<span class='fu'>update_mask</span><span class='op'>(</span><span class='va'>input_14_e1</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>]</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<pre><code>$location
[1] 30 35

$value
[1] 1 0</code></pre>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>write_memory</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>instruction</span><span class='op'>)</span><span class='op'>{</span>
  
  <span class='va'>mem_instruction</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://stringr.tidyverse.org/reference/str_split.html'>str_split</a></span><span class='op'>(</span><span class='va'>instruction</span>,<span class='st'>" = "</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> <span class='fu'><a href='https://rdrr.io/r/base/unlist.html'>unlist</a></span><span class='op'>(</span><span class='op'>)</span>
  
  <span class='va'>mem_location</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://readr.tidyverse.org/reference/parse_number.html'>parse_number</a></span><span class='op'>(</span><span class='va'>mem_instruction</span><span class='op'>[[</span><span class='fl'>1</span><span class='op'>]</span><span class='op'>]</span><span class='op'>)</span>
  
  <span class='va'>mem_value</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://readr.tidyverse.org/reference/parse_atomic.html'>parse_integer</a></span><span class='op'>(</span><span class='va'>mem_instruction</span><span class='op'>[[</span><span class='fl'>2</span><span class='op'>]</span><span class='op'>]</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
    <span class='fu'><a href='https://rdrr.io/pkg/binaryLogic/man/as.binary.html'>as.binary</a></span><span class='op'>(</span>signed <span class='op'>=</span> <span class='cn'>TRUE</span>, size <span class='op'>=</span> <span class='fl'>5</span><span class='op'>)</span>
  
  <span class='va'>mem_value</span><span class='op'>[</span><span class='va'>current_mask</span><span class='op'>$</span><span class='va'>location</span><span class='op'>+</span><span class='fl'>4</span><span class='op'>]</span> <span class='op'>&lt;-</span> <span class='va'>current_mask</span><span class='op'>$</span><span class='va'>value</span>
  
  <span class='va'>mem_value</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/numeric.html'>as.numeric</a></span><span class='op'>(</span><span class='va'>mem_value</span><span class='op'>)</span>
  
  <span class='va'>current_memory</span><span class='op'>[[</span><span class='va'>mem_location</span><span class='op'>]</span><span class='op'>]</span><span class='op'>&lt;&lt;-</span><span class='va'>mem_value</span>
  
  <span class='kw'><a href='https://rdrr.io/r/base/function.html'>return</a></span><span class='op'>(</span><span class='va'>mem_value</span><span class='op'>)</span>
<span class='op'>}</span>
<span class='fu'><a href='https://httr.r-lib.org/reference/write_disk.html'>write_memory</a></span><span class='op'>(</span><span class='va'>input_14_e1</span><span class='op'>[</span><span class='fl'>2</span><span class='op'>]</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<pre><code>[1] 73</code></pre>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://purrr.tidyverse.org/reference/map.html'>walk</a></span><span class='op'>(</span><span class='va'>input_14</span>,<span class='va'>choose_function</span><span class='op'>)</span>

<span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='va'>current_memory</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> <span class='fu'><a href='https://rdrr.io/r/base/unlist.html'>unlist</a></span><span class='op'>(</span><span class='op'>)</span>,na.rm <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<pre><code>[1] 10035335144140</code></pre>
</div>
<p>— Problem 2 —</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>input_14_e2</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://readr.tidyverse.org/reference/read_lines.html'>read_lines</a></span><span class='op'>(</span><span class='fu'><a href='https://here.r-lib.org//reference/here.html'>here</a></span><span class='op'>(</span><span class='st'>"2020"</span>,<span class='st'>"day-14-example2.txt"</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<blockquote>
<p>Instead, it acts as a memory address decoder. Immediately before a value is written to memory, each bit in the bitmask modifies the corresponding bit of the destination memory address in the following way:</p>
<ul>
<li>If the bitmask bit is 0, the corresponding memory address bit is unchanged.</li>
<li>If the bitmask bit is 1, the corresponding memory address bit is overwritten with 1.</li>
<li>If the bitmask bit is X, the corresponding memory address bit is floating.</li>
</ul>
</blockquote>
<p>This suggests a revised “mask decoder” function:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>instruction</span> <span class='op'>&lt;-</span> <span class='va'>input_14_e2</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>]</span>

<span class='va'>update_decoder</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>instruction</span><span class='op'>)</span><span class='op'>{</span>
  
  <span class='va'>mask</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://stringr.tidyverse.org/reference/str_remove.html'>str_remove</a></span><span class='op'>(</span><span class='va'>instruction</span>, <span class='st'>"mask = "</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> <span class='fu'><a href='https://stringr.tidyverse.org/reference/str_split.html'>str_split</a></span><span class='op'>(</span><span class='st'>""</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> <span class='fu'><a href='https://rdrr.io/r/base/unlist.html'>unlist</a></span><span class='op'>(</span><span class='op'>)</span>
  
  <span class='va'>overwrite_locations</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://stringr.tidyverse.org/reference/str_subset.html'>str_which</a></span><span class='op'>(</span><span class='va'>mask</span>,<span class='st'>"1"</span><span class='op'>)</span>

  <span class='va'>float_locations</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://stringr.tidyverse.org/reference/str_subset.html'>str_which</a></span><span class='op'>(</span><span class='va'>mask</span>,<span class='st'>"X"</span><span class='op'>)</span>
  
  <span class='va'>current_mask</span> <span class='op'>&lt;&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>
    overwrite <span class='op'>=</span> <span class='va'>overwrite_locations</span>,
    float <span class='op'>=</span> <span class='va'>float_locations</span><span class='op'>)</span>
  
  <span class='kw'><a href='https://rdrr.io/r/base/function.html'>return</a></span><span class='op'>(</span><span class='va'>current_mask</span><span class='op'>)</span>
<span class='op'>}</span>

<span class='fu'>update_decoder</span><span class='op'>(</span><span class='va'>instruction</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<pre><code>$overwrite
[1] 32 35

$float
[1] 31 36</code></pre>
</div>
<blockquote>
<p>A floating bit is not connected to anything and instead fluctuates unpredictably. In practice, this means the floating bits will take on all possible values, potentially causing many memory addresses to be written all at once!</p>
</blockquote>
<p>So instead of masking what the value is, the address being written to is “masked” by floats. I’ll try to use expand_grid to get all the combination of float values.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>instruction</span> <span class='op'>&lt;-</span> <span class='va'>input_14_e2</span><span class='op'>[</span><span class='fl'>2</span><span class='op'>]</span>
<span class='va'>current_memory</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://tibble.tidyverse.org/reference/tibble.html'>tibble</a></span><span class='op'>(</span><span class='op'>)</span>

<span class='va'>write_memory_two</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>instruction</span><span class='op'>)</span><span class='op'>{</span>
  
  <span class='va'>mem_instruction</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://stringr.tidyverse.org/reference/str_split.html'>str_split</a></span><span class='op'>(</span><span class='va'>instruction</span>,<span class='st'>" = "</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> <span class='fu'><a href='https://rdrr.io/r/base/unlist.html'>unlist</a></span><span class='op'>(</span><span class='op'>)</span>
  
  <span class='va'>mem_location</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://readr.tidyverse.org/reference/parse_number.html'>parse_number</a></span><span class='op'>(</span><span class='va'>mem_instruction</span><span class='op'>[[</span><span class='fl'>1</span><span class='op'>]</span><span class='op'>]</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
    <span class='fu'><a href='https://rdrr.io/pkg/binaryLogic/man/as.binary.html'>as.binary</a></span><span class='op'>(</span>signed <span class='op'>=</span> <span class='cn'>TRUE</span>, size <span class='op'>=</span> <span class='fl'>5</span><span class='op'>)</span>
  
  <span class='va'>mem_location</span><span class='op'>[</span><span class='va'>current_mask</span><span class='op'>$</span><span class='va'>overwrite</span><span class='op'>+</span><span class='fl'>4</span><span class='op'>]</span> <span class='op'>&lt;-</span> <span class='fl'>1</span>
    
  <span class='va'>x</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://tibble.tidyverse.org/reference/tibble.html'>tibble</a></span><span class='op'>(</span>float_locations <span class='op'>=</span> <span class='va'>current_mask</span><span class='op'>$</span><span class='va'>float</span> <span class='op'>+</span> <span class='fl'>4</span>,
              float_values <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>,<span class='fl'>1</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
    <span class='fu'><a href='https://tibble.tidyverse.org/reference/enframe.html'>deframe</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
    <span class='fu'><a href='https://rdrr.io/r/base/expand.grid.html'>expand.grid</a></span><span class='op'>(</span><span class='op'>)</span> 
    
  <span class='va'>mem_locations</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://purrr.tidyverse.org/reference/map2.html'>pmap</a></span><span class='op'>(</span><span class='va'>x</span>,<span class='op'>~</span> <span class='op'>{</span><span class='va'>mem_location</span><span class='op'>[</span><span class='va'>current_mask</span><span class='op'>$</span><span class='va'>float</span> <span class='op'>+</span><span class='fl'>4</span><span class='op'>]</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='va'>...</span><span class='op'>)</span>; <span class='fu'><a href='https://rdrr.io/r/base/numeric.html'>as.numeric</a></span><span class='op'>(</span><span class='va'>mem_location</span><span class='op'>)</span><span class='op'>}</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> <span class='fu'><a href='https://rdrr.io/r/base/unlist.html'>unlist</a></span><span class='op'>(</span><span class='op'>)</span>
    
  <span class='va'>mem_value</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://readr.tidyverse.org/reference/parse_atomic.html'>parse_integer</a></span><span class='op'>(</span><span class='va'>mem_instruction</span><span class='op'>[[</span><span class='fl'>2</span><span class='op'>]</span><span class='op'>]</span><span class='op'>)</span>
    
  <span class='va'>current_memory</span> <span class='op'>&lt;&lt;-</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/bind.html'>bind_rows</a></span><span class='op'>(</span><span class='va'>current_memory</span>,
                               <span class='fu'><a href='https://tibble.tidyverse.org/reference/tibble.html'>tibble</a></span><span class='op'>(</span>mem_locations <span class='op'>=</span> <span class='va'>mem_locations</span>,
                                      mem_value <span class='op'>=</span> <span class='va'>mem_value</span><span class='op'>)</span><span class='op'>)</span>
  <span class='kw'><a href='https://rdrr.io/r/base/function.html'>return</a></span><span class='op'>(</span><span class='va'>current_memory</span><span class='op'>)</span>
<span class='op'>}</span>

<span class='fu'>write_memory_two</span><span class='op'>(</span><span class='va'>instruction</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<pre><code># A tibble: 8 x 2
  mem_locations mem_value
          &lt;dbl&gt;     &lt;int&gt;
1            26       100
2            58       100
3            27       100
4            59       100
5            26       100
6            58       100
7            27       100
8            59       100</code></pre>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>current_memory</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://tibble.tidyverse.org/reference/tibble.html'>tibble</a></span><span class='op'>(</span><span class='op'>)</span>
<span class='va'>current_mask</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span><span class='op'>)</span>

<span class='va'>choose_operation</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>instruction</span><span class='op'>)</span><span class='op'>{</span>
  
  <span class='kw'>if</span><span class='op'>(</span><span class='fu'><a href='https://stringr.tidyverse.org/reference/str_detect.html'>str_detect</a></span><span class='op'>(</span><span class='va'>instruction</span>,<span class='st'>"mask"</span><span class='op'>)</span><span class='op'>)</span> <span class='fu'>update_decoder</span><span class='op'>(</span><span class='va'>instruction</span><span class='op'>)</span>
  
  <span class='kw'>if</span><span class='op'>(</span><span class='fu'><a href='https://stringr.tidyverse.org/reference/str_detect.html'>str_detect</a></span><span class='op'>(</span><span class='va'>instruction</span>,<span class='st'>"mem"</span><span class='op'>)</span><span class='op'>)</span> <span class='fu'>write_memory_two</span><span class='op'>(</span><span class='va'>instruction</span><span class='op'>)</span>
<span class='op'>}</span>

<span class='fu'><a href='https://purrr.tidyverse.org/reference/map.html'>walk</a></span><span class='op'>(</span><span class='va'>input_14</span>,<span class='va'>choose_operation</span><span class='op'>)</span>

<span class='va'>current_memory</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/group_by.html'>group_by</a></span><span class='op'>(</span><span class='va'>mem_locations</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/slice.html'>slice_tail</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/group_by.html'>ungroup</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/pull.html'>pull</a></span><span class='op'>(</span><span class='va'>mem_value</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
  <span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<pre><code>[1] 3817372618036</code></pre>
</div>
<p>Ran into some memory overflow issues, so decided to just save all the instructions and slice tail later. (In hindsight, that’s probably more R-like anyway)</p>
<div class="sourceCode" id="cb66"><pre class="sourceCode r distill-force-highlighting-css"><code class="sourceCode r"></code></pre></div>
<h2 id="day-15">Day 15</h2>
<p><a href="https://adventofcode.com/2020/day/15" class="uri">https://adventofcode.com/2020/day/15</a></p>
<p>Day fifteen - Rambunctious Recitation!</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/message.html'>suppressPackageStartupMessages</a></span><span class='op'>(</span><span class='op'>{</span>
  <span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://tidyverse.tidyverse.org'>tidyverse</a></span><span class='op'>)</span>
  <span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://here.r-lib.org/'>here</a></span><span class='op'>)</span>
  <span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://github.com/DavisVaughan/slider'>slider</a></span><span class='op'>)</span>

  <span class='fu'><a href='https://rdrr.io/r/base/options.html'>options</a></span><span class='op'>(</span>scipen  <span class='op'>=</span>  <span class='fl'>9999999</span><span class='op'>)</span>
  <span class='fu'>knitr</span><span class='fu'>::</span><span class='va'><a href='https://rdrr.io/pkg/knitr/man/opts_chunk.html'>opts_chunk</a></span><span class='op'>$</span><span class='fu'>set</span><span class='op'>(</span>echo <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>
<span class='op'>}</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<p>— Description —</p>
<blockquote>
<p>So, after the starting numbers, each turn results in that player speaking aloud either 0 (if the last number is new) or an age (if the last number is a repeat).</p>
</blockquote>
<p>— Data —</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>input_15</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>15</span>,<span class='fl'>12</span>,<span class='fl'>0</span>,<span class='fl'>14</span>,<span class='fl'>3</span>,<span class='fl'>1</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<p>— Problem 1 —</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>p1</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://tibble.tidyverse.org/reference/tibble.html'>tibble</a></span><span class='op'>(</span>index <span class='op'>=</span> <span class='fl'>1</span><span class='op'>:</span><span class='fl'>6</span>,value <span class='op'>=</span> <span class='va'>input_15</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/bind.html'>bind_rows</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>index <span class='op'>=</span> <span class='fl'>7</span><span class='op'>:</span><span class='fl'>2020</span><span class='op'>)</span><span class='op'>)</span>

<span class='va'>find_next</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>i</span><span class='op'>)</span><span class='op'>{</span>
  <span class='va'>prev</span> <span class='op'>&lt;-</span> <span class='va'>p1</span><span class='op'>$</span><span class='va'>value</span><span class='op'>[</span><span class='va'>i</span> <span class='op'>-</span> <span class='fl'>1</span><span class='op'>]</span>
  <span class='va'>new</span> <span class='op'>&lt;-</span> <span class='fl'>0</span>
  
  <span class='kw'>if</span><span class='op'>(</span><span class='va'>prev</span> <span class='op'><a href='https://rdrr.io/r/base/match.html'>%in%</a></span> <span class='va'>p1</span><span class='op'>$</span><span class='va'>value</span><span class='op'>[</span><span class='op'>-</span><span class='op'>(</span><span class='va'>i</span><span class='op'>-</span><span class='fl'>1</span><span class='op'>)</span><span class='op'>]</span><span class='op'>)</span> <span class='op'>{</span>
    <span class='va'>new</span> <span class='op'>&lt;-</span> <span class='va'>p1</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
      <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>prev</span> <span class='op'>==</span> <span class='va'>value</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
      <span class='fu'><a href='https://dplyr.tidyverse.org/reference/slice.html'>slice_tail</a></span><span class='op'>(</span>n <span class='op'>=</span> <span class='fl'>2</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
      <span class='fu'><a href='https://dplyr.tidyverse.org/reference/pull.html'>pull</a></span><span class='op'>(</span><span class='va'>index</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
      <span class='fu'><a href='https://rdrr.io/r/base/diff.html'>diff</a></span><span class='op'>(</span><span class='op'>)</span>
    <span class='op'>}</span>
  
  <span class='va'>p1</span><span class='op'>$</span><span class='va'>value</span><span class='op'>[</span><span class='va'>i</span><span class='op'>]</span> <span class='op'>&lt;&lt;-</span> <span class='va'>new</span>
<span class='op'>}</span>

<span class='fu'><a href='https://purrr.tidyverse.org/reference/map.html'>walk</a></span><span class='op'>(</span><span class='fl'>7</span><span class='op'>:</span><span class='fl'>2020</span>,<span class='va'>find_next</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/utils/head.html'>tail</a></span><span class='op'>(</span><span class='va'>p1</span><span class='op'>$</span><span class='va'>value</span>,<span class='fl'>1</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<pre><code>[1] 249</code></pre>
</div>
<p>— Problem 2 —</p>
<p>30,000,000 iterations slows this down heck of a lot!</p>
<p>Listing changes I made to first solution:</p>
<ul>
<li>instead of storing what each iteration said, store when each number was last said</li>
<li>reconfigure to store a vector of previous value and a second vector of value before previous value</li>
<li>pre-emptively build out the previous vectors to 100,000 long - if overflow, increase incrementally - this avoids copy on modify</li>
<li>pass solutions from prev_1 to prev_2 by location</li>
<li>don’t recalculate indexes twice for each loop - pre-set it before the loop and then do it at the end of loop</li>
<li>superassigning is slow, move the superassigned thing inside the function</li>
<li>tibbles are slow. matrices are slow. data.table is slow in this context too.</li>
</ul>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>find_next2</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>p1</span>, <span class='va'>range</span><span class='op'>)</span> <span class='op'>{</span>
  
  <span class='va'>p2</span> <span class='op'>&lt;-</span> <span class='va'>p1</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
    <span class='fu'><a href='https://dplyr.tidyverse.org/reference/group_by.html'>group_by</a></span><span class='op'>(</span><span class='va'>value</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
    <span class='fu'><a href='https://dplyr.tidyverse.org/reference/slice.html'>slice_tail</a></span><span class='op'>(</span>n<span class='op'>=</span><span class='fl'>2</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span>
    <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>rank <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/rank.html'>rank</a></span><span class='op'>(</span><span class='fu'><a href='https://dplyr.tidyverse.org/reference/desc.html'>desc</a></span><span class='op'>(</span><span class='va'>index</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
    <span class='fu'><a href='https://dplyr.tidyverse.org/reference/group_by.html'>ungroup</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
    <span class='fu'><a href='https://tidyr.tidyverse.org/reference/pivot_wider.html'>pivot_wider</a></span><span class='op'>(</span>names_from <span class='op'>=</span> <span class='va'>rank</span>, names_prefix <span class='op'>=</span> <span class='st'>"prev_"</span>,values_from <span class='op'>=</span> <span class='va'>index</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
    <span class='fu'><a href='https://dplyr.tidyverse.org/reference/arrange.html'>arrange</a></span><span class='op'>(</span><span class='va'>value</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
    <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate-joins.html'>left_join</a></span><span class='op'>(</span>
      y <span class='op'>=</span> <span class='va'>.</span>,
      x <span class='op'>=</span> <span class='fu'><a href='https://tibble.tidyverse.org/reference/tibble.html'>tibble</a></span><span class='op'>(</span>value <span class='op'>=</span> <span class='fl'>0</span><span class='op'>:</span><span class='fl'>100000</span><span class='op'>)</span>,
      by <span class='op'>=</span> <span class='st'>'value'</span>
    <span class='op'>)</span>
  
  <span class='va'>value</span> <span class='op'>&lt;-</span> <span class='va'>p2</span><span class='op'>$</span><span class='va'>value</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> <span class='fu'><a href='https://rdrr.io/r/base/integer.html'>as.integer</a></span><span class='op'>(</span><span class='op'>)</span>
  
  <span class='va'>prev_1</span> <span class='op'>&lt;-</span> <span class='va'>p2</span><span class='op'>$</span><span class='va'>prev_1</span>
  
  <span class='va'>prev_2</span> <span class='op'>&lt;-</span> <span class='va'>p2</span><span class='op'>$</span><span class='va'>prev_2</span>
  
  <span class='va'>index</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/which.html'>which</a></span><span class='op'>(</span><span class='va'>prev_1</span> <span class='op'>==</span> <span class='fu'><a href='https://rdrr.io/r/base/Extremes.html'>max</a></span><span class='op'>(</span><span class='va'>prev_1</span>,na.rm<span class='op'>=</span><span class='cn'>TRUE</span><span class='op'>)</span><span class='op'>)</span>
  
  <span class='kw'>for</span> <span class='op'>(</span><span class='va'>i</span> <span class='kw'>in</span> <span class='va'>range</span><span class='op'>)</span> <span class='op'>{</span>
    
    <span class='va'>prev_value</span> <span class='op'>&lt;-</span> <span class='va'>prev_2</span><span class='op'>[</span><span class='va'>index</span><span class='op'>]</span>
    <span class='va'>index</span> <span class='op'>&lt;-</span> <span class='fl'>1</span>
    
    <span class='kw'>if</span><span class='op'>(</span><span class='op'>!</span><span class='fu'><a href='https://rdrr.io/r/base/NA.html'>is.na</a></span><span class='op'>(</span><span class='va'>prev_value</span><span class='op'>)</span><span class='op'>)</span> <span class='va'>index</span> <span class='op'>&lt;-</span> <span class='va'>i</span> <span class='op'>-</span> <span class='va'>prev_value</span>
    
    <span class='va'>prev_2</span><span class='op'>[</span><span class='va'>index</span><span class='op'>]</span> <span class='op'>&lt;-</span> <span class='va'>prev_1</span><span class='op'>[</span><span class='va'>index</span><span class='op'>]</span>
    <span class='va'>prev_1</span><span class='op'>[</span><span class='va'>index</span><span class='op'>]</span> <span class='op'>&lt;-</span> <span class='va'>i</span>
    
    <span class='co'># if(i %% 1000000 ==0) message(i)</span>
  <span class='op'>}</span>
  
  <span class='co'># Return the last value</span>
  <span class='kw'><a href='https://rdrr.io/r/base/function.html'>return</a></span><span class='op'>(</span><span class='va'>index</span> <span class='op'>-</span> <span class='fl'>1</span><span class='op'>)</span>
<span class='op'>}</span>
<span class='fu'>tictoc</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/tictoc/man/tic.html'>tic</a></span><span class='op'>(</span><span class='op'>)</span>
<span class='fu'>find_next2</span><span class='op'>(</span><span class='va'>p1</span>,<span class='fl'>2021</span><span class='op'>:</span><span class='fl'>30000000</span><span class='op'>)</span>
<span class='fu'>tictoc</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/tictoc/man/tic.html'>toc</a></span><span class='op'>(</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<pre><code>[1] 41687</code></pre>
</div>
<div class="sourceCode" id="cb69"><pre class="sourceCode r distill-force-highlighting-css"><code class="sourceCode r"></code></pre></div>
<h2 id="day-16">Day 16</h2>
<p><a href="https://adventofcode.com/2020/day/16" class="uri">https://adventofcode.com/2020/day/16</a></p>
<p>Day sixteen - Ticket Translation!</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/message.html'>suppressPackageStartupMessages</a></span><span class='op'>(</span><span class='op'>{</span>
  <span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://tidyverse.tidyverse.org'>tidyverse</a></span><span class='op'>)</span>
  <span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://here.r-lib.org/'>here</a></span><span class='op'>)</span>

  <span class='fu'><a href='https://rdrr.io/r/base/options.html'>options</a></span><span class='op'>(</span>scipen  <span class='op'>=</span>  <span class='fl'>9999999</span><span class='op'>)</span>
  <span class='fu'>knitr</span><span class='fu'>::</span><span class='va'><a href='https://rdrr.io/pkg/knitr/man/opts_chunk.html'>opts_chunk</a></span><span class='op'>$</span><span class='fu'>set</span><span class='op'>(</span>echo <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>
<span class='op'>}</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<p>— Description —</p>
<blockquote>
<p>Unfortunately, you can’t actually read the words on the ticket. You can, however, read the numbers, and so you figure out the fields these tickets must have and the valid ranges for values in those fields.</p>
<p>You collect the rules for ticket fields, the numbers on your ticket, and the numbers on other nearby tickets for the same train service (via the airport security cameras) together into a single document you can reference (your puzzle input).</p>
</blockquote>
<p>— Data —</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>input_16</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://readr.tidyverse.org/reference/read_lines.html'>read_lines</a></span><span class='op'>(</span><span class='fu'><a href='https://here.r-lib.org//reference/here.html'>here</a></span><span class='op'>(</span><span class='st'>"2020"</span>,<span class='st'>"day-16.txt"</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<p>— Cleaning —</p>
<p>Definitely a problem that would benefit from tidying. Also going to go ahead and create an integer vector for each rule range, which will facilitate <code>%in%</code> checks later.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>x</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://tibble.tidyverse.org/reference/tibble.html'>tibble</a></span><span class='op'>(</span>input <span class='op'>=</span> <span class='va'>input_16</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>group <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/cumsum.html'>cumsum</a></span><span class='op'>(</span><span class='va'>input</span> <span class='op'>==</span> <span class='st'>""</span><span class='op'>)</span><span class='op'>)</span>

<span class='va'>rules</span> <span class='op'>&lt;-</span> <span class='va'>x</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>group</span> <span class='op'>==</span> <span class='fl'>0</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
  <span class='fu'><a href='https://tidyr.tidyverse.org/reference/separate.html'>separate</a></span><span class='op'>(</span><span class='va'>input</span>,<span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"rule"</span>,<span class='st'>"values"</span><span class='op'>)</span>,sep <span class='op'>=</span> <span class='st'>": "</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
  <span class='fu'><a href='https://tidyr.tidyverse.org/reference/separate_rows.html'>separate_rows</a></span><span class='op'>(</span><span class='va'>values</span>, sep <span class='op'>=</span> <span class='st'>" or "</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
  <span class='fu'><a href='https://tidyr.tidyverse.org/reference/separate.html'>separate</a></span><span class='op'>(</span><span class='va'>values</span>,<span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"start_value"</span>,<span class='st'>"end_value"</span><span class='op'>)</span>,sep <span class='op'>=</span> <span class='st'>"-"</span>,convert <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>range <span class='op'>=</span> <span class='fu'><a href='https://purrr.tidyverse.org/reference/map2.html'>map2</a></span><span class='op'>(</span><span class='va'>start_value</span>,<span class='va'>end_value</span>,<span class='op'>~</span><span class='va'>.x</span><span class='op'>:</span><span class='va'>.y</span><span class='op'>)</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/select.html'>select</a></span><span class='op'>(</span><span class='op'>-</span><span class='va'>group</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/group_by.html'>group_by</a></span><span class='op'>(</span><span class='va'>rule</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/summarise.html'>summarise</a></span><span class='op'>(</span>range <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span><span class='va'>range</span><span class='op'>)</span><span class='op'>)</span>

<span class='va'>your_ticket</span> <span class='op'>&lt;-</span> <span class='va'>x</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>group</span> <span class='op'>==</span> <span class='fl'>1</span>, <span class='va'>input</span><span class='op'>!=</span><span class='st'>""</span>,<span class='va'>input</span><span class='op'>!=</span><span class='st'>"your ticket:"</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
  <span class='fu'><a href='https://tidyr.tidyverse.org/reference/separate_rows.html'>separate_rows</a></span><span class='op'>(</span><span class='va'>input</span>, sep <span class='op'>=</span> <span class='st'>","</span>, convert <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>field_id <span class='op'>=</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/ranking.html'>row_number</a></span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/select.html'>select</a></span><span class='op'>(</span><span class='op'>-</span><span class='va'>group</span><span class='op'>)</span>

<span class='va'>other_tickets</span> <span class='op'>&lt;-</span> <span class='va'>x</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>group</span> <span class='op'>==</span> <span class='fl'>2</span>,<span class='va'>input</span><span class='op'>!=</span><span class='st'>""</span>,<span class='va'>input</span><span class='op'>!=</span><span class='st'>"nearby tickets:"</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>ticket_id <span class='op'>=</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/ranking.html'>row_number</a></span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
  <span class='fu'><a href='https://tidyr.tidyverse.org/reference/separate_rows.html'>separate_rows</a></span><span class='op'>(</span><span class='va'>input</span>,sep <span class='op'>=</span> <span class='st'>","</span>,convert <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/select.html'>select</a></span><span class='op'>(</span><span class='op'>-</span><span class='va'>group</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<p>— Problem 1 —</p>
<blockquote>
<p>Start by determining which tickets are completely invalid; these are tickets that contain values which aren’t valid for any field. Ignore your ticket for now.</p>
<p>Consider the validity of the nearby tickets you scanned. What is your ticket scanning error rate?</p>
</blockquote>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>rule_range</span> <span class='op'>&lt;-</span> <span class='va'>rules</span><span class='op'>$</span><span class='va'>range</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> <span class='fu'><a href='https://rdrr.io/r/base/unlist.html'>unlist</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> <span class='fu'><a href='https://rdrr.io/r/base/unique.html'>unique</a></span><span class='op'>(</span><span class='op'>)</span>

<span class='va'>check_invalid</span> <span class='op'>&lt;-</span> <span class='va'>other_tickets</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>check <span class='op'>=</span> <span class='va'>input</span> <span class='op'><a href='https://rdrr.io/r/base/match.html'>%in%</a></span> <span class='va'>rule_range</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='op'>!</span><span class='va'>check</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">

</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/utils/head.html'>head</a></span><span class='op'>(</span><span class='va'>check_invalid</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code># A tibble: 6 x 3
  input ticket_id check
  &lt;int&gt;     &lt;int&gt; &lt;lgl&gt;
1     8         2 FALSE
2     4        13 FALSE
3     3        23 FALSE
4    24        25 FALSE
5   979        29 FALSE
6   984        34 FALSE</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='va'>check_invalid</span><span class='op'>$</span><span class='va'>input</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>[1] 25895</code></pre>
</div>
<p>— Problem 2 —</p>
<blockquote>
<p>Using the valid ranges for each field, determine what order the fields appear on the tickets. The order is consistent between all tickets: if seat is the third field, it is the third field on every ticket, including your ticket.</p>
</blockquote>
<p>Looks straightforward enough: filter out the ticket ids that are invalid, then create a field_id and summarise the values for each field_id as a vector.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>valid_other</span> <span class='op'>&lt;-</span> <span class='va'>other_tickets</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='op'>!</span><span class='va'>ticket_id</span> <span class='op'><a href='https://rdrr.io/r/base/match.html'>%in%</a></span> <span class='va'>check_invalid</span><span class='op'>$</span><span class='va'>ticket_id</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/group_by.html'>group_by</a></span><span class='op'>(</span><span class='va'>ticket_id</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>field_id <span class='op'>=</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/ranking.html'>row_number</a></span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/group_by.html'>ungroup</a></span><span class='op'>(</span><span class='op'>)</span>

<span class='va'>field_summary</span> <span class='op'>&lt;-</span> <span class='va'>valid_other</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/arrange.html'>arrange</a></span><span class='op'>(</span><span class='va'>input</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/group_by.html'>group_by</a></span><span class='op'>(</span><span class='va'>field_id</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/summarise.html'>summarise</a></span><span class='op'>(</span>values <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span><span class='va'>input</span><span class='op'>)</span>,
            min <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/Extremes.html'>min</a></span><span class='op'>(</span><span class='va'>input</span>,na.rm <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>,
            max <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/Extremes.html'>max</a></span><span class='op'>(</span><span class='va'>input</span>,na.rm <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">

</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/utils/head.html'>head</a></span><span class='op'>(</span><span class='va'>field_summary</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code># A tibble: 6 x 4
  field_id values        min   max
     &lt;int&gt; &lt;list&gt;      &lt;int&gt; &lt;int&gt;
1        1 &lt;int [190]&gt;    50   916
2        2 &lt;int [190]&gt;    55   946
3        3 &lt;int [190]&gt;    50   947
4        4 &lt;int [190]&gt;    60   945
5        5 &lt;int [190]&gt;    51   948
6        6 &lt;int [190]&gt;    52   947</code></pre>
</div>
<p>We can check all fields against all rules with crossing, which’ll create one row for every rule x field - from there, run an %in% operator to check whether all values are in a range, and then filter to where these checks are TRUE. Then summarise this by the rule so that we can see what field_options there are for each rule</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>check_fields</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://tidyr.tidyverse.org/reference/expand.html'>crossing</a></span><span class='op'>(</span><span class='va'>rules</span>,<span class='va'>field_summary</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>range <span class='op'>=</span> <span class='fu'><a href='https://purrr.tidyverse.org/reference/map.html'>map</a></span><span class='op'>(</span><span class='va'>range</span>,<span class='va'>unlist</span><span class='op'>)</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>check <span class='op'>=</span> <span class='fu'><a href='https://purrr.tidyverse.org/reference/map2.html'>map2_lgl</a></span><span class='op'>(</span><span class='va'>range</span>,<span class='va'>values</span>,<span class='op'>~</span><span class='fu'><a href='https://rdrr.io/r/base/all.html'>all</a></span><span class='op'>(</span><span class='va'>.y</span> <span class='op'><a href='https://rdrr.io/r/base/match.html'>%in%</a></span> <span class='va'>.x</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>check</span><span class='op'>)</span>

<span class='va'>field_options</span> <span class='op'>&lt;-</span> <span class='va'>check_fields</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/group_by.html'>group_by</a></span><span class='op'>(</span><span class='va'>rule</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/summarise.html'>summarise</a></span><span class='op'>(</span>n <span class='op'>=</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/context.html'>n</a></span><span class='op'>(</span><span class='op'>)</span>,field_id <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span><span class='va'>field_id</span><span class='op'>)</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/group_by.html'>ungroup</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/arrange.html'>arrange</a></span><span class='op'>(</span><span class='va'>n</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">

</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>field_options</span>
</code></pre>
</div>
<pre><code># A tibble: 20 x 3
   rule                   n field_id  
   &lt;chr&gt;              &lt;int&gt; &lt;list&gt;    
 1 arrival location       1 &lt;int [1]&gt; 
 2 train                  2 &lt;int [2]&gt; 
 3 arrival station        3 &lt;int [3]&gt; 
 4 price                  4 &lt;int [4]&gt; 
 5 arrival track          5 &lt;int [5]&gt; 
 6 wagon                  6 &lt;int [6]&gt; 
 7 route                  7 &lt;int [7]&gt; 
 8 departure time         8 &lt;int [8]&gt; 
 9 departure station      9 &lt;int [9]&gt; 
10 departure platform    10 &lt;int [10]&gt;
11 departure date        11 &lt;int [11]&gt;
12 departure location    12 &lt;int [12]&gt;
13 departure track       13 &lt;int [13]&gt;
14 duration              14 &lt;int [14]&gt;
15 type                  15 &lt;int [15]&gt;
16 arrival platform      16 &lt;int [16]&gt;
17 zone                  17 &lt;int [17]&gt;
18 seat                  18 &lt;int [18]&gt;
19 class                 19 &lt;int [19]&gt;
20 row                   20 &lt;int [20]&gt;</code></pre>
</div>
<p>Inspecting these options, we can see that there’s only one option for arrival location, two options for train (one of which is the only option for arrival location), three options for arrival station (but two are in the previous etc) - and continuing the visual inspection shows this pattern carries forward for all twenty fields.</p>
<p>Writing a quick little loop here to assign the fields starting with the first one.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>unassigned</span> <span class='op'>&lt;-</span> <span class='va'>field_options</span>

<span class='va'>assigned</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://tibble.tidyverse.org/reference/tibble.html'>tibble</a></span><span class='op'>(</span>rule <span class='op'>=</span> <span class='cn'>NULL</span>, field_id <span class='op'>=</span> <span class='cn'>NULL</span><span class='op'>)</span>

<span class='kw'>while</span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>nrow</a></span><span class='op'>(</span><span class='va'>unassigned</span><span class='op'>)</span><span class='op'>&gt;</span><span class='fl'>0</span><span class='op'>)</span><span class='op'>{</span>
  
  <span class='va'>assigned</span> <span class='op'>&lt;-</span> <span class='va'>unassigned</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
    <span class='fu'><a href='https://dplyr.tidyverse.org/reference/slice.html'>slice</a></span><span class='op'>(</span><span class='fl'>1</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
    <span class='fu'><a href='https://dplyr.tidyverse.org/reference/bind.html'>bind_rows</a></span><span class='op'>(</span><span class='va'>assigned</span>,<span class='va'>.</span><span class='op'>)</span>
  
  <span class='va'>unassigned</span> <span class='op'>&lt;-</span> <span class='va'>unassigned</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
    <span class='fu'><a href='https://rdrr.io/r/utils/head.html'>tail</a></span><span class='op'>(</span>n <span class='op'>=</span> <span class='op'>-</span><span class='fl'>1</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
    <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>field_id <span class='op'>=</span> <span class='fu'><a href='https://purrr.tidyverse.org/reference/map.html'>map</a></span><span class='op'>(</span><span class='va'>field_id</span>, <span class='op'>~</span><span class='va'>.x</span><span class='op'>[</span><span class='op'>!</span><span class='va'>.x</span> <span class='op'><a href='https://rdrr.io/r/base/match.html'>%in%</a></span> <span class='va'>assigned</span><span class='op'>$</span><span class='va'>field_id</span><span class='op'>]</span><span class='op'>)</span><span class='op'>)</span>
  
<span class='op'>}</span>
</code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>your_assignment</span> <span class='op'>&lt;-</span> <span class='va'>assigned</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>field_id <span class='op'>=</span> <span class='fu'><a href='https://purrr.tidyverse.org/reference/map.html'>map_dbl</a></span><span class='op'>(</span><span class='va'>field_id</span>,<span class='va'>unlist</span><span class='op'>)</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate-joins.html'>left_join</a></span><span class='op'>(</span><span class='va'>your_ticket</span>, by <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"field_id"</span><span class='op'>)</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='fu'><a href='https://stringr.tidyverse.org/reference/str_starts.html'>str_starts</a></span><span class='op'>(</span><span class='va'>rule</span>,<span class='st'>"departure"</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">

</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>your_assignment</span>
</code></pre>
</div>
<pre><code># A tibble: 6 x 4
  rule                   n field_id input
  &lt;chr&gt;              &lt;int&gt;    &lt;dbl&gt; &lt;int&gt;
1 departure time         8       19   193
2 departure station      9        1    61
3 departure platform    10       13   197
4 departure date        11       20   157
5 departure location    12       15   181
6 departure track       13        7    89</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/prod.html'>prod</a></span><span class='op'>(</span><span class='va'>your_assignment</span><span class='op'>$</span><span class='va'>input</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>[1] 5865723727753</code></pre>
</div>
<div class="sourceCode" id="cb76"><pre class="sourceCode r distill-force-highlighting-css"><code class="sourceCode r"></code></pre></div>
<h2 id="day-17">Day 17</h2>
<p><a href="https://adventofcode.com/2020/day/17" class="uri">https://adventofcode.com/2020/day/17</a></p>
<p>Day seventeen - Conway Cubes!</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/message.html'>suppressPackageStartupMessages</a></span><span class='op'>(</span><span class='op'>{</span>
  <span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://tidyverse.tidyverse.org'>tidyverse</a></span><span class='op'>)</span>
  <span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://here.r-lib.org/'>here</a></span><span class='op'>)</span>
  <span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://github.com/DavisVaughan/furrr'>furrr</a></span><span class='op'>)</span>
  <span class='fu'><a href='https://rdrr.io/pkg/future/man/plan.html'>plan</a></span><span class='op'>(</span><span class='va'>multisession</span><span class='op'>)</span>

  <span class='fu'><a href='https://rdrr.io/r/base/options.html'>options</a></span><span class='op'>(</span>scipen <span class='op'>=</span> <span class='fl'>9999999</span><span class='op'>)</span>
  <span class='fu'>knitr</span><span class='fu'>::</span><span class='va'><a href='https://rdrr.io/pkg/knitr/man/opts_chunk.html'>opts_chunk</a></span><span class='op'>$</span><span class='fu'>set</span><span class='op'>(</span>echo <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>
<span class='op'>}</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<p>— Description —</p>
<blockquote>
<p>The experimental energy source is based on cutting-edge technology: a set of Conway Cubes contained in a pocket dimension! When you hear it’s having problems, you can’t help but agree to take a look.</p>
<p>The pocket dimension contains an infinite 3-dimensional grid. At every integer 3-dimensional coordinate (x,y,z), there exists a single cube which is either active or inactive.</p>
</blockquote>
<p>So essentially Conway’s game of life again…but in three dimensions?</p>
<p>— Data —</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>input_17</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://readr.tidyverse.org/reference/read_lines.html'>read_lines</a></span><span class='op'>(</span><span class='fu'><a href='https://here.r-lib.org//reference/here.html'>here</a></span><span class='op'>(</span><span class='st'>"2020"</span>, <span class='st'>"day-17.txt"</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>input_17_e</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://readr.tidyverse.org/reference/read_lines.html'>read_lines</a></span><span class='op'>(</span><span class='fu'><a href='https://here.r-lib.org//reference/here.html'>here</a></span><span class='op'>(</span><span class='st'>"2020"</span>, <span class='st'>"day-17-example1.txt"</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<p>— Cleaning —</p>
<p>Exploring a new part of R to me: arrays, which are vertically stacked matrices.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>example_matrix</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://tibble.tidyverse.org/reference/tibble.html'>tibble</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>input_17_e</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='fu'><a href='https://stringr.tidyverse.org/reference/str_split.html'>str_split</a></span><span class='op'>(</span><span class='va'>x</span>, <span class='st'>""</span><span class='op'>)</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span>
  <span class='fu'><a href='https://tidyr.tidyverse.org/reference/hoist.html'>unnest_wider</a></span><span class='op'>(</span><span class='va'>x</span>, names_sep <span class='op'>=</span> <span class='st'>"_"</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate_all.html'>mutate_all</a></span><span class='op'>(</span><span class='op'>~</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/case_when.html'>case_when</a></span><span class='op'>(</span><span class='va'>.x</span> <span class='op'>==</span> <span class='st'>"#"</span> <span class='op'>~</span> <span class='fl'>1</span>, <span class='cn'>TRUE</span> <span class='op'>~</span> <span class='fl'>0</span><span class='op'>)</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span>
  <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>as.matrix</a></span><span class='op'>(</span><span class='op'>)</span>

<span class='va'>example_empty</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span><span class='op'>(</span>
  data <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span><span class='op'>(</span><span class='va'>example_matrix</span><span class='op'>)</span><span class='op'>)</span>,
  nrow <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>nrow</a></span><span class='op'>(</span><span class='va'>example_matrix</span><span class='op'>)</span>,
  ncol <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>ncol</a></span><span class='op'>(</span><span class='va'>example_matrix</span><span class='op'>)</span>
<span class='op'>)</span>

<span class='va'>example_array</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='va'>example_empty</span>, <span class='va'>example_matrix</span>, <span class='va'>example_empty</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span>
  <span class='fu'><a href='https://rdrr.io/r/base/array.html'>array</a></span><span class='op'>(</span>dim <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>nrow</a></span><span class='op'>(</span><span class='va'>example_matrix</span><span class='op'>)</span>, <span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>ncol</a></span><span class='op'>(</span><span class='va'>example_matrix</span><span class='op'>)</span>, <span class='fl'>3</span><span class='op'>)</span><span class='op'>)</span>

<span class='va'>input_matrix</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://tibble.tidyverse.org/reference/tibble.html'>tibble</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>input_17</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='fu'><a href='https://stringr.tidyverse.org/reference/str_split.html'>str_split</a></span><span class='op'>(</span><span class='va'>x</span>, <span class='st'>""</span><span class='op'>)</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span>
  <span class='fu'><a href='https://tidyr.tidyverse.org/reference/hoist.html'>unnest_wider</a></span><span class='op'>(</span><span class='va'>x</span>, names_sep <span class='op'>=</span> <span class='st'>"_"</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate_all.html'>mutate_all</a></span><span class='op'>(</span><span class='op'>~</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/case_when.html'>case_when</a></span><span class='op'>(</span><span class='va'>.x</span> <span class='op'>==</span> <span class='st'>"#"</span> <span class='op'>~</span> <span class='fl'>1</span>, <span class='cn'>TRUE</span> <span class='op'>~</span> <span class='fl'>0</span><span class='op'>)</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span>
  <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>as.matrix</a></span><span class='op'>(</span><span class='op'>)</span>

<span class='va'>input_empty</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span><span class='op'>(</span>
  data <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span><span class='op'>(</span><span class='va'>input_matrix</span><span class='op'>)</span><span class='op'>)</span>, byrow <span class='op'>=</span> <span class='cn'>TRUE</span>,
  nrow <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>nrow</a></span><span class='op'>(</span><span class='va'>input_matrix</span><span class='op'>)</span>,
  ncol <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>ncol</a></span><span class='op'>(</span><span class='va'>input_matrix</span><span class='op'>)</span>
<span class='op'>)</span>

<span class='va'>input_array</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='va'>input_empty</span>, <span class='va'>input_matrix</span>, <span class='va'>input_empty</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span>
  <span class='fu'><a href='https://rdrr.io/r/base/array.html'>array</a></span><span class='op'>(</span>dim <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>nrow</a></span><span class='op'>(</span><span class='va'>input_matrix</span><span class='op'>)</span>, <span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>ncol</a></span><span class='op'>(</span><span class='va'>input_matrix</span><span class='op'>)</span>, <span class='fl'>3</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">

</div>
<p>Okay! So now we have the starting states of the example as <code>example_array</code> and the actual problem as <code>input_array</code>. We can access the dimensions of the arrays via</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/dim.html'>dim</a></span><span class='op'>(</span><span class='va'>example_array</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>[1] 3 3 3</code></pre>
</div>
<p>and access a specific layer with array[row,column,layer].</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>example_array</span><span class='op'>[</span><span class='fl'>1</span>, <span class='fl'>2</span>, <span class='fl'>2</span><span class='op'>]</span>
</code></pre>
</div>
<pre><code>[1] 1</code></pre>
</div>
<p>— Problem 1 —</p>
<p>We can build out a list of indices with the dimensions, I think!</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># array &lt;- example_array</span>

<span class='va'>get_indices</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>array</span><span class='op'>)</span> <span class='op'>{</span>
  <span class='va'>dimensions</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/dim.html'>dim</a></span><span class='op'>(</span><span class='va'>array</span><span class='op'>)</span>

  <span class='va'>actual_indices</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://tidyr.tidyverse.org/reference/expand.html'>crossing</a></span><span class='op'>(</span>
    x <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq_len</a></span><span class='op'>(</span><span class='va'>dimensions</span><span class='op'>[[</span><span class='fl'>1</span><span class='op'>]</span><span class='op'>]</span><span class='op'>)</span>,
    y <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq_len</a></span><span class='op'>(</span><span class='va'>dimensions</span><span class='op'>[[</span><span class='fl'>2</span><span class='op'>]</span><span class='op'>]</span><span class='op'>)</span>,
    z <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq_len</a></span><span class='op'>(</span><span class='va'>dimensions</span><span class='op'>[[</span><span class='fl'>3</span><span class='op'>]</span><span class='op'>]</span><span class='op'>)</span>
  <span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span>
    <span class='fu'><a href='https://dplyr.tidyverse.org/reference/arrange.html'>arrange</a></span><span class='op'>(</span><span class='va'>z</span>, <span class='va'>x</span>, <span class='va'>y</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span>
    <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>
      value <span class='op'>=</span> <span class='fu'><a href='https://purrr.tidyverse.org/reference/map2.html'>pmap_dbl</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span><span class='va'>x</span>, <span class='va'>y</span>, <span class='va'>z</span><span class='op'>)</span>, <span class='op'>~</span> <span class='va'>array</span><span class='op'>[</span><span class='va'>...</span><span class='op'>]</span><span class='op'>)</span>,
      x <span class='op'>=</span> <span class='va'>x</span> <span class='op'>+</span> <span class='fl'>1</span>,
      y <span class='op'>=</span> <span class='va'>y</span> <span class='op'>+</span> <span class='fl'>1</span>
    <span class='op'>)</span>

  <span class='va'>indices</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://tidyr.tidyverse.org/reference/expand.html'>crossing</a></span><span class='op'>(</span>
    x <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq_len</a></span><span class='op'>(</span><span class='va'>dimensions</span><span class='op'>[[</span><span class='fl'>1</span><span class='op'>]</span><span class='op'>]</span> <span class='op'>+</span> <span class='fl'>2</span><span class='op'>)</span>,
    y <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq_len</a></span><span class='op'>(</span><span class='va'>dimensions</span><span class='op'>[[</span><span class='fl'>2</span><span class='op'>]</span><span class='op'>]</span> <span class='op'>+</span> <span class='fl'>2</span><span class='op'>)</span>,
    z <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq_len</a></span><span class='op'>(</span><span class='va'>dimensions</span><span class='op'>[[</span><span class='fl'>3</span><span class='op'>]</span><span class='op'>]</span><span class='op'>)</span>
  <span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span>
    <span class='fu'><a href='https://dplyr.tidyverse.org/reference/arrange.html'>arrange</a></span><span class='op'>(</span><span class='va'>z</span>, <span class='va'>x</span>, <span class='va'>y</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span>
    <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate-joins.html'>left_join</a></span><span class='op'>(</span><span class='va'>actual_indices</span>, by <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"x"</span>, <span class='st'>"y"</span>, <span class='st'>"z"</span><span class='op'>)</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span>
    <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate_all.html'>mutate_all</a></span><span class='op'>(</span><span class='va'>replace_na</span>, <span class='fl'>0</span><span class='op'>)</span>

  <span class='kw'><a href='https://rdrr.io/r/base/function.html'>return</a></span><span class='op'>(</span><span class='va'>indices</span><span class='op'>)</span>
<span class='op'>}</span>

<span class='va'>example_indices</span> <span class='op'>&lt;-</span> <span class='fu'>get_indices</span><span class='op'>(</span><span class='va'>example_array</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<p>Now to create a function to check the neighbouring indices and count nearby occupied cells.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># indices &lt;- example_indices</span>
<span class='co'># x &lt;- 1</span>
<span class='co'># y &lt;- 2</span>
<span class='co'># z &lt;- 2</span>

<span class='va'>count_neighbours</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>x</span>, <span class='va'>y</span>, <span class='va'>z</span>, <span class='va'>indices</span><span class='op'>)</span> <span class='op'>{</span>
  <span class='va'>x_max</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/Extremes.html'>max</a></span><span class='op'>(</span><span class='va'>indices</span><span class='op'>$</span><span class='va'>x</span><span class='op'>)</span>
  <span class='va'>y_max</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/Extremes.html'>max</a></span><span class='op'>(</span><span class='va'>indices</span><span class='op'>$</span><span class='va'>y</span><span class='op'>)</span>
  <span class='va'>z_max</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/Extremes.html'>max</a></span><span class='op'>(</span><span class='va'>indices</span><span class='op'>$</span><span class='va'>z</span><span class='op'>)</span>

  <span class='va'>increments</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='op'>-</span><span class='fl'>1</span>, <span class='fl'>0</span>, <span class='fl'>1</span><span class='op'>)</span>

  <span class='va'>neighbours</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://tidyr.tidyverse.org/reference/expand.html'>crossing</a></span><span class='op'>(</span>
    x <span class='op'>=</span> <span class='va'>increments</span> <span class='op'>+</span> <span class='va'>x</span>,
    y <span class='op'>=</span> <span class='va'>increments</span> <span class='op'>+</span> <span class='va'>y</span>,
    z <span class='op'>=</span> <span class='va'>increments</span> <span class='op'>+</span> <span class='va'>z</span>
  <span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span>
    <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span>
      <span class='op'>!</span><span class='op'>(</span><span class='va'>.data</span><span class='op'>$</span><span class='va'>x</span> <span class='op'>==</span> <span class='va'>.env</span><span class='op'>$</span><span class='va'>x</span> <span class='op'>&amp;</span> <span class='va'>.data</span><span class='op'>$</span><span class='va'>y</span> <span class='op'>==</span> <span class='va'>.env</span><span class='op'>$</span><span class='va'>y</span> <span class='op'>&amp;</span> <span class='va'>.data</span><span class='op'>$</span><span class='va'>z</span> <span class='op'>==</span> <span class='va'>.env</span><span class='op'>$</span><span class='va'>z</span><span class='op'>)</span>,
      <span class='fu'><a href='https://dplyr.tidyverse.org/reference/between.html'>between</a></span><span class='op'>(</span><span class='va'>.data</span><span class='op'>$</span><span class='va'>x</span>, <span class='fl'>1</span>, <span class='va'>x_max</span><span class='op'>)</span>,
      <span class='fu'><a href='https://dplyr.tidyverse.org/reference/between.html'>between</a></span><span class='op'>(</span><span class='va'>.data</span><span class='op'>$</span><span class='va'>y</span>, <span class='fl'>1</span>, <span class='va'>y_max</span><span class='op'>)</span>,
      <span class='fu'><a href='https://dplyr.tidyverse.org/reference/between.html'>between</a></span><span class='op'>(</span><span class='va'>.data</span><span class='op'>$</span><span class='va'>z</span>, <span class='fl'>1</span>, <span class='va'>z_max</span><span class='op'>)</span>
    <span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span>
    <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>value <span class='op'>=</span> <span class='fu'><a href='https://purrr.tidyverse.org/reference/map2.html'>pmap_dbl</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span><span class='va'>x</span>, <span class='va'>y</span>, <span class='va'>z</span><span class='op'>)</span>, <span class='op'>~</span> <span class='va'>indices</span><span class='op'>$</span><span class='va'>value</span><span class='op'>[</span><span class='va'>indices</span><span class='op'>$</span><span class='va'>x</span> <span class='op'>==</span> <span class='va'>..1</span> <span class='op'>&amp;</span> <span class='va'>indices</span><span class='op'>$</span><span class='va'>y</span> <span class='op'>==</span> <span class='va'>..2</span> <span class='op'>&amp;</span> <span class='va'>indices</span><span class='op'>$</span><span class='va'>z</span> <span class='op'>==</span> <span class='va'>..3</span><span class='op'>]</span><span class='op'>)</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span>
    <span class='fu'><a href='https://dplyr.tidyverse.org/reference/pull.html'>pull</a></span><span class='op'>(</span><span class='va'>value</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span>
    <span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='op'>)</span>

  <span class='kw'><a href='https://rdrr.io/r/base/function.html'>return</a></span><span class='op'>(</span><span class='va'>neighbours</span><span class='op'>)</span>
<span class='op'>}</span>

<span class='va'>example_neighbours</span> <span class='op'>&lt;-</span> <span class='va'>example_indices</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>neighbours <span class='op'>=</span> <span class='fu'><a href='https://purrr.tidyverse.org/reference/map2.html'>pmap_dbl</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span><span class='va'>x</span>, <span class='va'>y</span>, <span class='va'>z</span><span class='op'>)</span>, <span class='va'>count_neighbours</span>, <span class='va'>.</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<p>Now that we have the neighbours, we need to increment their values based on the rules.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># indices &lt;- example_neighbours</span>

<span class='va'>apply_rules</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>indices</span><span class='op'>)</span> <span class='op'>{</span>
  <span class='va'>x</span> <span class='op'>&lt;-</span> <span class='va'>indices</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span>
    <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>new_value <span class='op'>=</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/case_when.html'>case_when</a></span><span class='op'>(</span>
      <span class='va'>value</span> <span class='op'>==</span> <span class='fl'>1</span> <span class='op'>&amp;</span> <span class='va'>neighbours</span> <span class='op'><a href='https://rdrr.io/r/base/match.html'>%in%</a></span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>2</span>, <span class='fl'>3</span><span class='op'>)</span> <span class='op'>~</span> <span class='fl'>1</span>,
      <span class='va'>value</span> <span class='op'>==</span> <span class='fl'>1</span> <span class='op'>~</span> <span class='fl'>0</span>,
      <span class='va'>value</span> <span class='op'>==</span> <span class='fl'>0</span> <span class='op'>&amp;</span> <span class='va'>neighbours</span> <span class='op'>==</span> <span class='fl'>3</span> <span class='op'>~</span> <span class='fl'>1</span>,
      <span class='cn'>TRUE</span> <span class='op'>~</span> <span class='fl'>0</span>
    <span class='op'>)</span><span class='op'>)</span>
  <span class='kw'><a href='https://rdrr.io/r/base/function.html'>return</a></span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span>
<span class='op'>}</span>

<span class='va'>example_count</span> <span class='op'>&lt;-</span> <span class='va'>example_neighbours</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span>
  <span class='fu'>apply_rules</span><span class='op'>(</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<p>(I was stumped for a while here as to why my puzzle input did not match up to the example, but consulting no-spoilers-reddit seems that they’re dropping empty x/y dimensions which is quite annoying!)</p>
<p>Now to increment the array in every direction (but sticking with a list of indices for now, I find that easier to work with mentally)</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># indices &lt;- example_count</span>
<span class='va'>grow_indices</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>indices</span><span class='op'>)</span> <span class='op'>{</span>
  <span class='va'>new_x</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/Extremes.html'>max</a></span><span class='op'>(</span><span class='va'>indices</span><span class='op'>$</span><span class='va'>x</span> <span class='op'>+</span> <span class='fl'>2</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq_len</a></span><span class='op'>(</span><span class='op'>)</span>
  <span class='va'>new_y</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/Extremes.html'>max</a></span><span class='op'>(</span><span class='va'>indices</span><span class='op'>$</span><span class='va'>y</span> <span class='op'>+</span> <span class='fl'>2</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq_len</a></span><span class='op'>(</span><span class='op'>)</span>
  <span class='va'>new_z</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/Extremes.html'>max</a></span><span class='op'>(</span><span class='va'>indices</span><span class='op'>$</span><span class='va'>z</span> <span class='op'>+</span> <span class='fl'>2</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq_len</a></span><span class='op'>(</span><span class='op'>)</span>

  <span class='va'>new_indices</span> <span class='op'>&lt;-</span> <span class='va'>indices</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span>
    <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>transmute</a></span><span class='op'>(</span>
      x <span class='op'>=</span> <span class='va'>x</span> <span class='op'>+</span> <span class='fl'>1</span>,
      y <span class='op'>=</span> <span class='va'>y</span> <span class='op'>+</span> <span class='fl'>1</span>,
      z <span class='op'>=</span> <span class='va'>z</span> <span class='op'>+</span> <span class='fl'>1</span>,
      value <span class='op'>=</span> <span class='va'>new_value</span>
    <span class='op'>)</span>

  <span class='va'>indices</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://tidyr.tidyverse.org/reference/expand.html'>crossing</a></span><span class='op'>(</span>
    x <span class='op'>=</span> <span class='va'>new_x</span>,
    y <span class='op'>=</span> <span class='va'>new_y</span>,
    z <span class='op'>=</span> <span class='va'>new_z</span>
  <span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span>
    <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate-joins.html'>left_join</a></span><span class='op'>(</span><span class='va'>new_indices</span>, by <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"x"</span>, <span class='st'>"y"</span>, <span class='st'>"z"</span><span class='op'>)</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span>
    <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>value <span class='op'>=</span> <span class='fu'><a href='https://tidyr.tidyverse.org/reference/replace_na.html'>replace_na</a></span><span class='op'>(</span><span class='va'>value</span>, <span class='fl'>0</span><span class='op'>)</span><span class='op'>)</span>

  <span class='kw'><a href='https://rdrr.io/r/base/function.html'>return</a></span><span class='op'>(</span><span class='va'>indices</span><span class='op'>)</span>
<span class='op'>}</span>
<span class='co'># grow_indices(example_count)</span>
</code></pre>
</div>
</div>
<p>Wrap it all into a caller function and for-loop.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># array &lt;- example_array</span>
<span class='co'># times &lt;- 6</span>

<span class='va'>run_conwaycube</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>array</span>, <span class='va'>times</span><span class='op'>)</span> <span class='op'>{</span>
  <span class='va'>indices</span> <span class='op'>&lt;-</span> <span class='fu'>get_indices</span><span class='op'>(</span><span class='va'>array</span><span class='op'>)</span>

  <span class='kw'>for</span> <span class='op'>(</span><span class='va'>i</span> <span class='kw'>in</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq_len</a></span><span class='op'>(</span><span class='va'>times</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>{</span>
    <span class='va'>indices</span> <span class='op'>&lt;-</span> <span class='va'>indices</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span>
      <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>neighbours <span class='op'>=</span> <span class='fu'><a href='https://purrr.tidyverse.org/reference/map2.html'>pmap_dbl</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span><span class='va'>x</span>, <span class='va'>y</span>, <span class='va'>z</span><span class='op'>)</span>, <span class='va'>count_neighbours</span>, <span class='va'>.</span><span class='op'>)</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span>
      <span class='fu'>apply_rules</span><span class='op'>(</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span>
      <span class='fu'>grow_indices</span><span class='op'>(</span><span class='op'>)</span>

    <span class='fu'><a href='https://rdrr.io/r/base/message.html'>message</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste</a></span><span class='op'>(</span><span class='va'>i</span>, <span class='fu'><a href='https://rdrr.io/r/base/Sys.time.html'>Sys.time</a></span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>
  <span class='op'>}</span>

  <span class='kw'><a href='https://rdrr.io/r/base/function.html'>return</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='va'>indices</span><span class='op'>$</span><span class='va'>value</span><span class='op'>)</span><span class='op'>)</span>
<span class='op'>}</span>

<span class='fu'>run_conwaycube</span><span class='op'>(</span><span class='va'>input_array</span>,<span class='fl'>6</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<pre><code>1 2020-12-17 10:26:13
2 2020-12-17 10:26:16
3 2020-12-17 10:26:22
4 2020-12-17 10:26:33
5 2020-12-17 10:26:52
6 2020-12-17 10:27:23

280</code></pre>
<p>— Problem 2 —</p>
<p>FOUR DIMENSIONS?! (brain explodes)</p>
<p>Actually, maybe I can just adjust my functions for a fourth dimension <code>w</code></p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>get_indices_4d</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>array</span><span class='op'>)</span> <span class='op'>{</span>
  
  <span class='va'>dimensions</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/dim.html'>dim</a></span><span class='op'>(</span><span class='va'>array</span><span class='op'>)</span>
  
  <span class='va'>actual_indices</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://tidyr.tidyverse.org/reference/expand.html'>crossing</a></span><span class='op'>(</span>
    x <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq_len</a></span><span class='op'>(</span><span class='va'>dimensions</span><span class='op'>[[</span><span class='fl'>1</span><span class='op'>]</span><span class='op'>]</span><span class='op'>)</span>,
    y <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq_len</a></span><span class='op'>(</span><span class='va'>dimensions</span><span class='op'>[[</span><span class='fl'>2</span><span class='op'>]</span><span class='op'>]</span><span class='op'>)</span>,
    z <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq_len</a></span><span class='op'>(</span><span class='va'>dimensions</span><span class='op'>[[</span><span class='fl'>3</span><span class='op'>]</span><span class='op'>]</span><span class='op'>)</span>
  <span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span>
    <span class='fu'><a href='https://dplyr.tidyverse.org/reference/arrange.html'>arrange</a></span><span class='op'>(</span><span class='va'>z</span>, <span class='va'>x</span>, <span class='va'>y</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span>
    <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>
      value <span class='op'>=</span> <span class='fu'><a href='https://purrr.tidyverse.org/reference/map2.html'>pmap_dbl</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span><span class='va'>x</span>, <span class='va'>y</span>, <span class='va'>z</span><span class='op'>)</span>, <span class='op'>~</span> <span class='va'>array</span><span class='op'>[</span><span class='va'>...</span><span class='op'>]</span><span class='op'>)</span>,
      x <span class='op'>=</span> <span class='va'>x</span> <span class='op'>+</span> <span class='fl'>1</span>,
      y <span class='op'>=</span> <span class='va'>y</span> <span class='op'>+</span> <span class='fl'>1</span>,
      w <span class='op'>=</span> <span class='fl'>2</span>
    <span class='op'>)</span>
  
  <span class='va'>indices</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://tidyr.tidyverse.org/reference/expand.html'>crossing</a></span><span class='op'>(</span>
    x <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq_len</a></span><span class='op'>(</span><span class='va'>dimensions</span><span class='op'>[[</span><span class='fl'>1</span><span class='op'>]</span><span class='op'>]</span> <span class='op'>+</span> <span class='fl'>2</span><span class='op'>)</span>,
    y <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq_len</a></span><span class='op'>(</span><span class='va'>dimensions</span><span class='op'>[[</span><span class='fl'>2</span><span class='op'>]</span><span class='op'>]</span> <span class='op'>+</span> <span class='fl'>2</span><span class='op'>)</span>,
    z <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq_len</a></span><span class='op'>(</span><span class='va'>dimensions</span><span class='op'>[[</span><span class='fl'>3</span><span class='op'>]</span><span class='op'>]</span><span class='op'>)</span>,
    w <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq_len</a></span><span class='op'>(</span><span class='va'>dimensions</span><span class='op'>[[</span><span class='fl'>3</span><span class='op'>]</span><span class='op'>]</span><span class='op'>)</span>
  <span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span>
    <span class='fu'><a href='https://dplyr.tidyverse.org/reference/arrange.html'>arrange</a></span><span class='op'>(</span><span class='va'>z</span>, <span class='va'>x</span>, <span class='va'>y</span>, <span class='va'>w</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span>
    <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate-joins.html'>left_join</a></span><span class='op'>(</span><span class='va'>actual_indices</span>, by <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"x"</span>, <span class='st'>"y"</span>, <span class='st'>"z"</span>, <span class='st'>"w"</span><span class='op'>)</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span>
    <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate_all.html'>mutate_all</a></span><span class='op'>(</span><span class='va'>replace_na</span>, <span class='fl'>0</span><span class='op'>)</span>
  
  <span class='kw'><a href='https://rdrr.io/r/base/function.html'>return</a></span><span class='op'>(</span><span class='va'>indices</span><span class='op'>)</span>
<span class='op'>}</span>

<span class='va'>count_neighbours_4d</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>x</span>, <span class='va'>y</span>, <span class='va'>z</span>, <span class='va'>w</span>, <span class='va'>indices</span><span class='op'>)</span> <span class='op'>{</span>
  <span class='va'>x_max</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/Extremes.html'>max</a></span><span class='op'>(</span><span class='va'>indices</span><span class='op'>$</span><span class='va'>x</span><span class='op'>)</span>
  <span class='va'>y_max</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/Extremes.html'>max</a></span><span class='op'>(</span><span class='va'>indices</span><span class='op'>$</span><span class='va'>y</span><span class='op'>)</span>
  <span class='va'>z_max</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/Extremes.html'>max</a></span><span class='op'>(</span><span class='va'>indices</span><span class='op'>$</span><span class='va'>z</span><span class='op'>)</span>
  <span class='va'>w_max</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/Extremes.html'>max</a></span><span class='op'>(</span><span class='va'>indices</span><span class='op'>$</span><span class='va'>w</span><span class='op'>)</span>
  
  <span class='va'>increments</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='op'>-</span><span class='fl'>1</span>, <span class='fl'>0</span>, <span class='fl'>1</span><span class='op'>)</span>
  
  <span class='va'>neighbours</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://tidyr.tidyverse.org/reference/expand.html'>crossing</a></span><span class='op'>(</span>
    x <span class='op'>=</span> <span class='va'>increments</span> <span class='op'>+</span> <span class='va'>x</span>,
    y <span class='op'>=</span> <span class='va'>increments</span> <span class='op'>+</span> <span class='va'>y</span>,
    z <span class='op'>=</span> <span class='va'>increments</span> <span class='op'>+</span> <span class='va'>z</span>,
    w <span class='op'>=</span> <span class='va'>increments</span> <span class='op'>+</span> <span class='va'>w</span>
  <span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span>
    <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span>
      <span class='op'>!</span><span class='op'>(</span><span class='va'>.data</span><span class='op'>$</span><span class='va'>x</span> <span class='op'>==</span> <span class='va'>.env</span><span class='op'>$</span><span class='va'>x</span> <span class='op'>&amp;</span> 
          <span class='va'>.data</span><span class='op'>$</span><span class='va'>y</span> <span class='op'>==</span> <span class='va'>.env</span><span class='op'>$</span><span class='va'>y</span> <span class='op'>&amp;</span> 
          <span class='va'>.data</span><span class='op'>$</span><span class='va'>z</span> <span class='op'>==</span> <span class='va'>.env</span><span class='op'>$</span><span class='va'>z</span> <span class='op'>&amp;</span> 
          <span class='va'>.data</span><span class='op'>$</span><span class='va'>w</span> <span class='op'>==</span> <span class='va'>.env</span><span class='op'>$</span><span class='va'>w</span><span class='op'>)</span>,
      <span class='fu'><a href='https://dplyr.tidyverse.org/reference/between.html'>between</a></span><span class='op'>(</span><span class='va'>.data</span><span class='op'>$</span><span class='va'>x</span>, <span class='fl'>1</span>, <span class='va'>x_max</span><span class='op'>)</span>,
      <span class='fu'><a href='https://dplyr.tidyverse.org/reference/between.html'>between</a></span><span class='op'>(</span><span class='va'>.data</span><span class='op'>$</span><span class='va'>y</span>, <span class='fl'>1</span>, <span class='va'>y_max</span><span class='op'>)</span>,
      <span class='fu'><a href='https://dplyr.tidyverse.org/reference/between.html'>between</a></span><span class='op'>(</span><span class='va'>.data</span><span class='op'>$</span><span class='va'>z</span>, <span class='fl'>1</span>, <span class='va'>z_max</span><span class='op'>)</span>,
      <span class='fu'><a href='https://dplyr.tidyverse.org/reference/between.html'>between</a></span><span class='op'>(</span><span class='va'>.data</span><span class='op'>$</span><span class='va'>w</span>, <span class='fl'>1</span>, <span class='va'>w_max</span><span class='op'>)</span>
    <span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span>
    <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>
      value <span class='op'>=</span> <span class='fu'><a href='https://purrr.tidyverse.org/reference/map2.html'>pmap_dbl</a></span><span class='op'>(</span>
        <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span><span class='va'>x</span>, <span class='va'>y</span>, <span class='va'>z</span>, <span class='va'>w</span><span class='op'>)</span>, 
        <span class='op'>~</span> <span class='va'>indices</span><span class='op'>$</span><span class='va'>value</span><span class='op'>[</span><span class='va'>indices</span><span class='op'>$</span><span class='va'>x</span> <span class='op'>==</span> <span class='va'>..1</span> <span class='op'>&amp;</span> 
                          <span class='va'>indices</span><span class='op'>$</span><span class='va'>y</span> <span class='op'>==</span> <span class='va'>..2</span> <span class='op'>&amp;</span> 
                          <span class='va'>indices</span><span class='op'>$</span><span class='va'>z</span> <span class='op'>==</span> <span class='va'>..3</span> <span class='op'>&amp;</span> 
                          <span class='va'>indices</span><span class='op'>$</span><span class='va'>w</span> <span class='op'>==</span> <span class='va'>..4</span><span class='op'>]</span><span class='op'>)</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span>
    <span class='fu'><a href='https://dplyr.tidyverse.org/reference/pull.html'>pull</a></span><span class='op'>(</span><span class='va'>value</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span>
    <span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='op'>)</span>
  
  <span class='kw'><a href='https://rdrr.io/r/base/function.html'>return</a></span><span class='op'>(</span><span class='va'>neighbours</span><span class='op'>)</span>
<span class='op'>}</span>

<span class='co'># apply rules doesn't change since rules are the same</span>

<span class='va'>grow_indices_4d</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>indices</span><span class='op'>)</span> <span class='op'>{</span>
  <span class='va'>new_x</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/Extremes.html'>max</a></span><span class='op'>(</span><span class='va'>indices</span><span class='op'>$</span><span class='va'>x</span> <span class='op'>+</span> <span class='fl'>2</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq_len</a></span><span class='op'>(</span><span class='op'>)</span>
  <span class='va'>new_y</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/Extremes.html'>max</a></span><span class='op'>(</span><span class='va'>indices</span><span class='op'>$</span><span class='va'>y</span> <span class='op'>+</span> <span class='fl'>2</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq_len</a></span><span class='op'>(</span><span class='op'>)</span>
  <span class='va'>new_z</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/Extremes.html'>max</a></span><span class='op'>(</span><span class='va'>indices</span><span class='op'>$</span><span class='va'>z</span> <span class='op'>+</span> <span class='fl'>2</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq_len</a></span><span class='op'>(</span><span class='op'>)</span>
  <span class='va'>new_w</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/Extremes.html'>max</a></span><span class='op'>(</span><span class='va'>indices</span><span class='op'>$</span><span class='va'>w</span> <span class='op'>+</span> <span class='fl'>2</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq_len</a></span><span class='op'>(</span><span class='op'>)</span>
  
  <span class='va'>new_indices</span> <span class='op'>&lt;-</span> <span class='va'>indices</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span>
    <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>transmute</a></span><span class='op'>(</span>
      x <span class='op'>=</span> <span class='va'>x</span> <span class='op'>+</span> <span class='fl'>1</span>,
      y <span class='op'>=</span> <span class='va'>y</span> <span class='op'>+</span> <span class='fl'>1</span>,
      z <span class='op'>=</span> <span class='va'>z</span> <span class='op'>+</span> <span class='fl'>1</span>,
      w <span class='op'>=</span> <span class='va'>w</span> <span class='op'>+</span> <span class='fl'>1</span>,
      value <span class='op'>=</span> <span class='va'>new_value</span>
    <span class='op'>)</span>
  
  <span class='va'>indices</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://tidyr.tidyverse.org/reference/expand.html'>crossing</a></span><span class='op'>(</span>
    x <span class='op'>=</span> <span class='va'>new_x</span>,
    y <span class='op'>=</span> <span class='va'>new_y</span>,
    z <span class='op'>=</span> <span class='va'>new_z</span>,
    w <span class='op'>=</span> <span class='va'>new_w</span>
  <span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span>
    <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate-joins.html'>left_join</a></span><span class='op'>(</span><span class='va'>new_indices</span>, by <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"x"</span>, <span class='st'>"y"</span>, <span class='st'>"z"</span>, <span class='st'>"w"</span><span class='op'>)</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span>
    <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>value <span class='op'>=</span> <span class='fu'><a href='https://tidyr.tidyverse.org/reference/replace_na.html'>replace_na</a></span><span class='op'>(</span><span class='va'>value</span>, <span class='fl'>0</span><span class='op'>)</span><span class='op'>)</span>
  
  <span class='kw'><a href='https://rdrr.io/r/base/function.html'>return</a></span><span class='op'>(</span><span class='va'>indices</span><span class='op'>)</span>
<span class='op'>}</span>

<span class='va'>run_conwaycube_4d</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>array</span>, <span class='va'>times</span><span class='op'>)</span> <span class='op'>{</span>
  
  <span class='va'>indices</span> <span class='op'>&lt;-</span> <span class='fu'>get_indices_4d</span><span class='op'>(</span><span class='va'>array</span><span class='op'>)</span>
  
  <span class='fu'><a href='https://rdrr.io/r/base/message.html'>message</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/Sys.time.html'>Sys.time</a></span><span class='op'>(</span><span class='op'>)</span>, <span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>nrow</a></span><span class='op'>(</span><span class='va'>indices</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>
  
  <span class='kw'>for</span> <span class='op'>(</span><span class='va'>i</span> <span class='kw'>in</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq_len</a></span><span class='op'>(</span><span class='va'>times</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>{</span>
    <span class='va'>indices</span> <span class='op'>&lt;-</span> <span class='va'>indices</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span>
      <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>neighbours <span class='op'>=</span> <span class='fu'><a href='https://purrr.tidyverse.org/reference/map2.html'>pmap_dbl</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span><span class='va'>x</span>, <span class='va'>y</span>, <span class='va'>z</span>, <span class='va'>w</span><span class='op'>)</span>, <span class='va'>count_neighbours_4d</span>, <span class='va'>.</span><span class='op'>)</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span>
      <span class='fu'>apply_rules</span><span class='op'>(</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span>
      <span class='fu'>grow_indices_4d</span><span class='op'>(</span><span class='op'>)</span>
    <span class='fu'><a href='https://rdrr.io/r/base/message.html'>message</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste</a></span><span class='op'>(</span><span class='va'>i</span>, <span class='fu'><a href='https://rdrr.io/r/base/Sys.time.html'>Sys.time</a></span><span class='op'>(</span><span class='op'>)</span>, <span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>nrow</a></span><span class='op'>(</span><span class='va'>indices</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>
  <span class='op'>}</span>
  <span class='kw'><a href='https://rdrr.io/r/base/function.html'>return</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='va'>indices</span><span class='op'>$</span><span class='va'>value</span><span class='op'>)</span><span class='op'>)</span>
<span class='op'>}</span>

<span class='fu'>run_conwaycube_4d</span><span class='op'>(</span><span class='va'>input_array</span>, <span class='fl'>6</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<pre><code>2020-12-17 02:01:36 900
1 2020-12-17 02:01:41 3600
2 2020-12-17 02:02:12 9604
3 2020-12-17 02:04:46 20736
4 2020-12-17 02:15:10 39204
5 2020-12-17 02:50:04 67600
6 2020-12-17 04:35:08 108900

[1] 1696</code></pre>
<p>Admittedly, I plugged this in and went to sleep - but it was the correct answer!</p>
<p>— Iterating on Problem 2 for speed —</p>
<p>Problem 2 takes quite some time to run. Trying a few approaches to trimming it down:</p>
<p>Firstly, as Liam Y suggested in the R4DS Slack - arrange the neighbour function so that it’s only checking neighbours that have positive integer values:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>count_neighbours_4d</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>indices</span><span class='op'>)</span><span class='op'>{</span>

  <span class='va'>filtered_indices</span> <span class='op'>&lt;-</span> <span class='va'>indices</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span>
    <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>value</span> <span class='op'>==</span> <span class='fl'>1</span><span class='op'>)</span> <span class='co'># This should reduce the amount of iteration needed!</span>

  <span class='va'>indices</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span>
    <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>neighbours <span class='op'>=</span> <span class='fu'><a href='https://purrr.tidyverse.org/reference/map2.html'>pmap_dbl</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span><span class='va'>x</span>,<span class='va'>y</span>,<span class='va'>z</span>,<span class='va'>w</span><span class='op'>)</span>,<span class='va'>check_each_neighbour</span>,<span class='va'>filtered_indices</span><span class='op'>)</span><span class='op'>)</span>
<span class='op'>}</span>

<span class='va'>check_each_neighbour</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>x</span>, <span class='va'>y</span>, <span class='va'>z</span>, <span class='va'>w</span>, <span class='va'>indices</span><span class='op'>)</span><span class='op'>{</span>

  <span class='va'>increments</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='op'>-</span><span class='fl'>1</span>, <span class='fl'>0</span>, <span class='fl'>1</span><span class='op'>)</span>

  <span class='va'>n</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://tidyr.tidyverse.org/reference/expand.html'>crossing</a></span><span class='op'>(</span>
    x <span class='op'>=</span> <span class='va'>increments</span> <span class='op'>+</span> <span class='va'>x</span>,
    y <span class='op'>=</span> <span class='va'>increments</span> <span class='op'>+</span> <span class='va'>y</span>,
    z <span class='op'>=</span> <span class='va'>increments</span> <span class='op'>+</span> <span class='va'>z</span>,
    w <span class='op'>=</span> <span class='va'>increments</span> <span class='op'>+</span> <span class='va'>w</span>
  <span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span>
    <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span>
      <span class='op'>!</span><span class='op'>(</span><span class='va'>.data</span><span class='op'>$</span><span class='va'>x</span> <span class='op'>==</span> <span class='va'>.env</span><span class='op'>$</span><span class='va'>x</span> <span class='op'>&amp;</span> 
          <span class='va'>.data</span><span class='op'>$</span><span class='va'>y</span> <span class='op'>==</span> <span class='va'>.env</span><span class='op'>$</span><span class='va'>y</span> <span class='op'>&amp;</span> 
          <span class='va'>.data</span><span class='op'>$</span><span class='va'>z</span> <span class='op'>==</span> <span class='va'>.env</span><span class='op'>$</span><span class='va'>z</span> <span class='op'>&amp;</span> 
          <span class='va'>.data</span><span class='op'>$</span><span class='va'>w</span> <span class='op'>==</span> <span class='va'>.env</span><span class='op'>$</span><span class='va'>w</span><span class='op'>)</span>
    <span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span>
    <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>
      value <span class='op'>=</span> <span class='fu'><a href='https://purrr.tidyverse.org/reference/map2.html'>pmap</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span><span class='va'>.data</span><span class='op'>$</span><span class='va'>x</span>,<span class='va'>.data</span><span class='op'>$</span><span class='va'>y</span>,<span class='va'>.data</span><span class='op'>$</span><span class='va'>z</span>,<span class='va'>.data</span><span class='op'>$</span><span class='va'>w</span><span class='op'>)</span>,
                   <span class='op'>~</span><span class='op'>(</span><span class='va'>indices</span><span class='op'>$</span><span class='va'>value</span><span class='op'>[</span><span class='va'>indices</span><span class='op'>$</span><span class='va'>x</span> <span class='op'>==</span> <span class='va'>..1</span> <span class='op'>&amp;</span> <span class='va'>indices</span><span class='op'>$</span><span class='va'>y</span> <span class='op'>==</span> <span class='va'>..2</span> <span class='op'>&amp;</span> <span class='va'>indices</span><span class='op'>$</span><span class='va'>z</span> <span class='op'>==</span> <span class='va'>..3</span> <span class='op'>&amp;</span> <span class='va'>indices</span><span class='op'>$</span><span class='va'>w</span> <span class='op'>==</span> <span class='va'>..4</span><span class='op'>]</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span>
    <span class='fu'><a href='https://dplyr.tidyverse.org/reference/pull.html'>pull</a></span><span class='op'>(</span><span class='va'>value</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span>
    <span class='fu'><a href='https://rdrr.io/r/base/unlist.html'>unlist</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span>
    <span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span>na.rm <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>

  <span class='kw'><a href='https://rdrr.io/r/base/function.html'>return</a></span><span class='op'>(</span><span class='va'>n</span><span class='op'>)</span>
<span class='op'>}</span>

<span class='va'>run_conwaycube_4d</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>array</span>, <span class='va'>times</span><span class='op'>)</span> <span class='op'>{</span>
  <span class='va'>indices</span> <span class='op'>&lt;-</span> <span class='fu'>get_indices_4d</span><span class='op'>(</span><span class='va'>array</span><span class='op'>)</span>

  <span class='fu'><a href='https://rdrr.io/r/base/message.html'>message</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/Sys.time.html'>Sys.time</a></span><span class='op'>(</span><span class='op'>)</span>, <span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>nrow</a></span><span class='op'>(</span><span class='va'>indices</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>

  <span class='kw'>for</span> <span class='op'>(</span><span class='va'>i</span> <span class='kw'>in</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq_len</a></span><span class='op'>(</span><span class='va'>times</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>{</span>
    <span class='va'>indices</span> <span class='op'>&lt;-</span> <span class='va'>indices</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span>
      <span class='fu'>count_neighbours_4d</span><span class='op'>(</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
      <span class='fu'>apply_rules</span><span class='op'>(</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span>
      <span class='fu'>grow_indices_4d</span><span class='op'>(</span><span class='op'>)</span>

    <span class='fu'><a href='https://rdrr.io/r/base/message.html'>message</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste</a></span><span class='op'>(</span><span class='va'>i</span>, <span class='fu'><a href='https://rdrr.io/r/base/Sys.time.html'>Sys.time</a></span><span class='op'>(</span><span class='op'>)</span>, <span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>nrow</a></span><span class='op'>(</span><span class='va'>indices</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>
  <span class='op'>}</span>

  <span class='kw'><a href='https://rdrr.io/r/base/function.html'>return</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='va'>indices</span><span class='op'>$</span><span class='va'>value</span><span class='op'>)</span><span class='op'>)</span>
<span class='op'>}</span>

<span class='fu'>run_conwaycube_4d</span><span class='op'>(</span><span class='va'>input_array</span>, <span class='fl'>6</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<pre><code>2020-12-17 16:08:14 900
1 2020-12-17 16:08:18 3600
2 2020-12-17 16:08:38 9604
3 2020-12-17 16:09:29 20736
4 2020-12-17 16:11:39 39204
5 2020-12-17 16:15:26 67600
6 2020-12-17 16:25:28 108900

[1] 1696</code></pre>
<p>Just doing that much shrunk the run-time from 2 hours 35 minutes to ~17 minutes! I can do better though, I think - in Day 11’s final approach, I arranged things into a matrix and approached it from there - I think I can definitely do the same here! (and also, add parallel processing because duh)</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>count_neighbours_4d</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>indices</span><span class='op'>)</span><span class='op'>{</span>

  <span class='va'>v</span> <span class='op'>&lt;-</span> <span class='va'>indices</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
    <span class='fu'><a href='https://dplyr.tidyverse.org/reference/arrange.html'>arrange</a></span><span class='op'>(</span><span class='va'>w</span>,<span class='va'>z</span>,<span class='va'>y</span>,<span class='va'>x</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
    <span class='fu'><a href='https://dplyr.tidyverse.org/reference/pull.html'>pull</a></span><span class='op'>(</span><span class='va'>value</span><span class='op'>)</span>
  
  <span class='va'>a</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/array.html'>array</a></span><span class='op'>(</span><span class='va'>v</span>,dim <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/Extremes.html'>max</a></span><span class='op'>(</span><span class='va'>indices</span><span class='op'>$</span><span class='va'>x</span><span class='op'>)</span>,
                       <span class='fu'><a href='https://rdrr.io/r/base/Extremes.html'>max</a></span><span class='op'>(</span><span class='va'>indices</span><span class='op'>$</span><span class='va'>y</span><span class='op'>)</span>,
                       <span class='fu'><a href='https://rdrr.io/r/base/Extremes.html'>max</a></span><span class='op'>(</span><span class='va'>indices</span><span class='op'>$</span><span class='va'>z</span><span class='op'>)</span>,
                       <span class='fu'><a href='https://rdrr.io/r/base/Extremes.html'>max</a></span><span class='op'>(</span><span class='va'>indices</span><span class='op'>$</span><span class='va'>w</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>

  <span class='va'>i</span> <span class='op'>&lt;-</span> <span class='va'>indices</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span>
    <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>neighbours <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/pkg/furrr/man/future_map2.html'>future_pmap_dbl</a></span><span class='op'>(</span>.l <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span><span class='va'>.data</span><span class='op'>$</span><span class='va'>x</span>,<span class='va'>.data</span><span class='op'>$</span><span class='va'>y</span>,<span class='va'>.data</span><span class='op'>$</span><span class='va'>z</span>,<span class='va'>.data</span><span class='op'>$</span><span class='va'>w</span><span class='op'>)</span>,.f <span class='op'>=</span> <span class='va'>check_each_neighbour</span>,a <span class='op'>=</span> <span class='va'>.env</span><span class='op'>$</span><span class='va'>a</span><span class='op'>)</span><span class='op'>)</span>

  <span class='kw'><a href='https://rdrr.io/r/base/function.html'>return</a></span><span class='op'>(</span><span class='va'>i</span><span class='op'>)</span>
<span class='op'>}</span>

<span class='va'>check_each_neighbour</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>x</span>, <span class='va'>y</span>, <span class='va'>z</span>, <span class='va'>w</span>, <span class='va'>a</span><span class='op'>)</span><span class='op'>{</span>

  <span class='va'>increments</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='op'>-</span><span class='fl'>1</span>, <span class='fl'>0</span>, <span class='fl'>1</span><span class='op'>)</span>

  <span class='co'># browser()</span>
  
  <span class='va'>n</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://tidyr.tidyverse.org/reference/expand.html'>crossing</a></span><span class='op'>(</span>
    x <span class='op'>=</span> <span class='va'>increments</span> <span class='op'>+</span> <span class='va'>x</span>,
    y <span class='op'>=</span> <span class='va'>increments</span> <span class='op'>+</span> <span class='va'>y</span>,
    z <span class='op'>=</span> <span class='va'>increments</span> <span class='op'>+</span> <span class='va'>z</span>,
    w <span class='op'>=</span> <span class='va'>increments</span> <span class='op'>+</span> <span class='va'>w</span>
  <span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span>
    <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span>
      <span class='op'>!</span><span class='op'>(</span><span class='va'>.data</span><span class='op'>$</span><span class='va'>x</span> <span class='op'>==</span> <span class='va'>.env</span><span class='op'>$</span><span class='va'>x</span> <span class='op'>&amp;</span> 
          <span class='va'>.data</span><span class='op'>$</span><span class='va'>y</span> <span class='op'>==</span> <span class='va'>.env</span><span class='op'>$</span><span class='va'>y</span> <span class='op'>&amp;</span> 
          <span class='va'>.data</span><span class='op'>$</span><span class='va'>z</span> <span class='op'>==</span> <span class='va'>.env</span><span class='op'>$</span><span class='va'>z</span> <span class='op'>&amp;</span> 
          <span class='va'>.data</span><span class='op'>$</span><span class='va'>w</span> <span class='op'>==</span> <span class='va'>.env</span><span class='op'>$</span><span class='va'>w</span><span class='op'>)</span>,
      <span class='fu'><a href='https://dplyr.tidyverse.org/reference/between.html'>between</a></span><span class='op'>(</span><span class='va'>.data</span><span class='op'>$</span><span class='va'>x</span>,<span class='fl'>1</span>,<span class='fu'><a href='https://rdrr.io/r/base/dim.html'>dim</a></span><span class='op'>(</span><span class='va'>a</span><span class='op'>)</span><span class='op'>[[</span><span class='fl'>1</span><span class='op'>]</span><span class='op'>]</span><span class='op'>)</span>,
      <span class='fu'><a href='https://dplyr.tidyverse.org/reference/between.html'>between</a></span><span class='op'>(</span><span class='va'>.data</span><span class='op'>$</span><span class='va'>y</span>,<span class='fl'>1</span>,<span class='fu'><a href='https://rdrr.io/r/base/dim.html'>dim</a></span><span class='op'>(</span><span class='va'>a</span><span class='op'>)</span><span class='op'>[[</span><span class='fl'>2</span><span class='op'>]</span><span class='op'>]</span><span class='op'>)</span>,
      <span class='fu'><a href='https://dplyr.tidyverse.org/reference/between.html'>between</a></span><span class='op'>(</span><span class='va'>.data</span><span class='op'>$</span><span class='va'>z</span>,<span class='fl'>1</span>,<span class='fu'><a href='https://rdrr.io/r/base/dim.html'>dim</a></span><span class='op'>(</span><span class='va'>a</span><span class='op'>)</span><span class='op'>[[</span><span class='fl'>3</span><span class='op'>]</span><span class='op'>]</span><span class='op'>)</span>,
      <span class='fu'><a href='https://dplyr.tidyverse.org/reference/between.html'>between</a></span><span class='op'>(</span><span class='va'>.data</span><span class='op'>$</span><span class='va'>w</span>,<span class='fl'>1</span>,<span class='fu'><a href='https://rdrr.io/r/base/dim.html'>dim</a></span><span class='op'>(</span><span class='va'>a</span><span class='op'>)</span><span class='op'>[[</span><span class='fl'>4</span><span class='op'>]</span><span class='op'>]</span><span class='op'>)</span>,
    <span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span>
    <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>
      value <span class='op'>=</span> <span class='fu'><a href='https://purrr.tidyverse.org/reference/map2.html'>pmap_dbl</a></span><span class='op'>(</span>
        <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span><span class='va'>.data</span><span class='op'>$</span><span class='va'>x</span>,<span class='va'>.data</span><span class='op'>$</span><span class='va'>y</span>,<span class='va'>.data</span><span class='op'>$</span><span class='va'>z</span>,<span class='va'>.data</span><span class='op'>$</span><span class='va'>w</span><span class='op'>)</span>,
        <span class='op'>~</span><span class='va'>a</span><span class='op'>[</span><span class='va'>..1</span>,<span class='va'>..2</span>,<span class='va'>..3</span>,<span class='va'>..4</span><span class='op'>]</span><span class='op'>)</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span>
    <span class='fu'><a href='https://dplyr.tidyverse.org/reference/pull.html'>pull</a></span><span class='op'>(</span><span class='va'>value</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span>
    <span class='fu'><a href='https://rdrr.io/r/base/unlist.html'>unlist</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span>
    <span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span>na.rm <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>

  <span class='kw'><a href='https://rdrr.io/r/base/function.html'>return</a></span><span class='op'>(</span><span class='va'>n</span><span class='op'>)</span>
<span class='op'>}</span>

<span class='va'>run_conwaycube_4d</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>array</span>, <span class='va'>times</span><span class='op'>)</span> <span class='op'>{</span>
  <span class='va'>indices</span> <span class='op'>&lt;-</span> <span class='fu'>get_indices_4d</span><span class='op'>(</span><span class='va'>array</span><span class='op'>)</span>

  <span class='fu'><a href='https://rdrr.io/r/base/message.html'>message</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/Sys.time.html'>Sys.time</a></span><span class='op'>(</span><span class='op'>)</span>, <span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>nrow</a></span><span class='op'>(</span><span class='va'>indices</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>

  <span class='kw'>for</span> <span class='op'>(</span><span class='va'>i</span> <span class='kw'>in</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq_len</a></span><span class='op'>(</span><span class='va'>times</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>{</span>
    <span class='va'>indices</span> <span class='op'>&lt;-</span> <span class='va'>indices</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span>
      <span class='fu'>count_neighbours_4d</span><span class='op'>(</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
      <span class='fu'>apply_rules</span><span class='op'>(</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span>
      <span class='fu'>grow_indices_4d</span><span class='op'>(</span><span class='op'>)</span>

    <span class='fu'><a href='https://rdrr.io/r/base/message.html'>message</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste</a></span><span class='op'>(</span><span class='va'>i</span>, <span class='fu'><a href='https://rdrr.io/r/base/Sys.time.html'>Sys.time</a></span><span class='op'>(</span><span class='op'>)</span>, <span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>nrow</a></span><span class='op'>(</span><span class='va'>indices</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>
  <span class='op'>}</span>

  <span class='kw'><a href='https://rdrr.io/r/base/function.html'>return</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='va'>indices</span><span class='op'>$</span><span class='va'>value</span><span class='op'>)</span><span class='op'>)</span>
<span class='op'>}</span>

<span class='fu'>run_conwaycube_4d</span><span class='op'>(</span><span class='va'>input_array</span>, <span class='fl'>6</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<pre><code>2020-12-17 18:39:43 900
1 2020-12-17 18:39:45 3600
2 2020-12-17 18:39:48 9604
3 2020-12-17 18:39:56 20736
4 2020-12-17 18:40:13 39204
5 2020-12-17 18:40:44 67600
6 2020-12-17 18:41:39 108900
[1] 1696</code></pre>
<p>Shaving it down to two minutes runtime is extremely satisfying!</p>
<div class="sourceCode" id="cb83"><pre class="sourceCode r distill-force-highlighting-css"><code class="sourceCode r"></code></pre></div>
<h2 id="day-18">Day 18</h2>
<p><a href="https://adventofcode.com/2020/day/18" class="uri">https://adventofcode.com/2020/day/18</a></p>
<p>Day eighteen - Operation Order!</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/message.html'>suppressPackageStartupMessages</a></span><span class='op'>(</span><span class='op'>{</span>
  <span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://tidyverse.tidyverse.org'>tidyverse</a></span><span class='op'>)</span>
  <span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://here.r-lib.org/'>here</a></span><span class='op'>)</span>
  <span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://github.com/r-lib/lobstr'>lobstr</a></span><span class='op'>)</span>
  <span class='co'># library(furrr)</span>
  <span class='co'># plan(multisession)</span>

  <span class='fu'>knitr</span><span class='fu'>::</span><span class='va'><a href='https://rdrr.io/pkg/knitr/man/opts_chunk.html'>opts_chunk</a></span><span class='op'>$</span><span class='fu'>set</span><span class='op'>(</span>echo <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>
<span class='op'>}</span><span class='op'>)</span>
  <span class='fu'><a href='https://rdrr.io/r/base/options.html'>options</a></span><span class='op'>(</span>scipen <span class='op'>=</span> <span class='fl'>9999999</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<p>— Description —</p>
<blockquote>
<p>Unfortunately, it seems like this “math” follows different rules than you remember.</p>
<p>The homework (your puzzle input) consists of a series of expressions that consist of addition (+), multiplication (*), and parentheses ((…)). Just like normal math, parentheses indicate that the expression inside must be evaluated before it can be used by the surrounding expression. Addition still finds the sum of the numbers on both sides of the operator, and multiplication still finds the product.</p>
<p>However, the rules of operator precedence have changed. Rather than evaluating multiplication before addition, the operators have the same precedence, and are evaluated left-to-right regardless of the order in which they appear.</p>
</blockquote>
<p>— Data —</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>input_18</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://readr.tidyverse.org/reference/read_lines.html'>read_lines</a></span><span class='op'>(</span><span class='fu'><a href='https://here.r-lib.org//reference/here.html'>here</a></span><span class='op'>(</span><span class='st'>"2020"</span>, <span class='st'>"day-18.txt"</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<p>— Cleaning —</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>operations</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://tibble.tidyverse.org/reference/tibble.html'>tibble</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>input_18</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<p>— Problem 1 —</p>
<p>R doesn’t have editable math operator precedence (which is a good thing!), but we can trick the R parser into evaluating <code>*</code> at the same level as <code>+</code> by string-replacing <code>*</code> with <code>-</code> and then switching the definition of <code>-</code> to be equal to <code>*</code>.</p>
<p>The R parser will read the operator list and decide which ones to do, and it knows that “+” is equal in precedence to “-”. So it will evaluate them left to right, and it goes back to the new definition of “-” which is "*".</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>`-`</span> <span class='op'>&lt;-</span> <span class='va'>`*`</span>
  
<span class='va'>p1</span> <span class='op'>&lt;-</span> <span class='va'>operations</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>modified_x <span class='op'>=</span> <span class='fu'><a href='https://stringr.tidyverse.org/reference/str_replace.html'>str_replace_all</a></span><span class='op'>(</span><span class='va'>x</span>,<span class='st'>"\\*"</span>,<span class='st'>"\\-"</span><span class='op'>)</span>,
         output <span class='op'>=</span> <span class='fu'><a href='https://purrr.tidyverse.org/reference/map.html'>map_dbl</a></span><span class='op'>(</span><span class='va'>modified_x</span>,<span class='op'>~</span> <span class='fu'><a href='https://rdrr.io/r/base/eval.html'>eval</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/parse.html'>parse</a></span><span class='op'>(</span>text <span class='op'>=</span> <span class='va'>.x</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">

</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/utils/head.html'>head</a></span><span class='op'>(</span><span class='va'>p1</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code># A tibble: 6 x 2
  modified_x                                                    output
  &lt;chr&gt;                                                          &lt;dbl&gt;
1 9 - 8 + 2 + (4 - (2 - 2 + 9 - 2) - 9 - 3 - 8) + 8 - 5         1.13e5
2 8 - (9 + 5 + 5 - 6 + 8 - 3) - 5 - 7 - 4 + 9                   4.10e5
3 (9 + (2 - 6 + 7 - 5)) - (7 + 7 - 5 + (6 + 2 + 6) - (7 - 8~    7.98e6
4 ((8 + 3 - 6 - 2) - 9 + 3) + 5 + 6 - 3                         3.61e3
5 6 - (9 + 6 - (7 + 4 + 2 + 5 + 6) - 7 + 3 - (5 - 8 - 6 + 6~    1.67e9
6 (8 - 6 + 8) + 6 - 8 - (9 - (6 + 8 - 3 + 8) + (7 - 9 - 6 -~    9.44e6</code></pre>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='va'>p1</span><span class='op'>$</span><span class='va'>output</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<pre><code>[1] 16332191652452</code></pre>
</div>
<p>For extra credit, here’s the abstract syntax tree for the first operation as written normally:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>lobstr</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/lobstr/man/ast.html'>ast</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/expression.html'>expression</a></span><span class='op'>(</span><span class='fl'>9</span> <span class='op'>*</span> <span class='fl'>8</span> <span class='op'>+</span> <span class='fl'>2</span> <span class='op'>+</span> <span class='op'>(</span><span class='fl'>4</span> <span class='op'>*</span> <span class='op'>(</span><span class='fl'>2</span> <span class='op'>*</span> <span class='fl'>2</span> <span class='op'>+</span> <span class='fl'>9</span> <span class='op'>*</span> <span class='fl'>2</span><span class='op'>)</span> <span class='op'>*</span> <span class='fl'>9</span> <span class='op'>*</span> <span class='fl'>3</span> <span class='op'>*</span> <span class='fl'>8</span><span class='op'>)</span> <span class='op'>+</span> <span class='fl'>8</span> <span class='op'>*</span> <span class='fl'>5</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>o-expression 
\-o-`+` 
  +-o-`+` 
  | +-o-`+` 
  | | +-o-`*` 
  | | | +-9 
  | | | \-8 
  | | \-2 
  | \-o-`(` 
  |   \-o-`*` 
  |     +-o-`*` 
  |     | +-o-`*` 
  |     | | +-o-`*` 
  |     | | | +-4 
  |     | | | \-o-`(` 
  |     | | |   \-o-`+` 
  |     | | |     +-o-`*` 
  |     | | |     | +-2 
  |     | | |     | \-2 
  |     | | |     \-o-`*` 
  |     | | |       +-9 
  |     | | |       \-2 
  |     | | \-9 
  |     | \-3 
  |     \-8 
  \-o-`*` 
    +-8 
    \-5 </code></pre>
</div>
<p>and the revised version:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>lobstr</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/lobstr/man/ast.html'>ast</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/expression.html'>expression</a></span><span class='op'>(</span><span class='fl'>9</span> <span class='op'>-</span> <span class='fl'>8</span> <span class='op'>+</span> <span class='fl'>2</span> <span class='op'>+</span> <span class='op'>(</span><span class='fl'>4</span> <span class='op'>-</span> <span class='op'>(</span><span class='fl'>2</span> <span class='op'>-</span> <span class='fl'>2</span> <span class='op'>+</span> <span class='fl'>9</span> <span class='op'>-</span> <span class='fl'>2</span><span class='op'>)</span> <span class='op'>-</span> <span class='fl'>9</span> <span class='op'>-</span> <span class='fl'>3</span> <span class='op'>-</span> <span class='fl'>8</span><span class='op'>)</span> <span class='op'>+</span> <span class='fl'>8</span> <span class='op'>-</span> <span class='fl'>5</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>o-expression 
\-o-`-` 
  +-o-`+` 
  | +-o-`+` 
  | | +-o-`+` 
  | | | +-o-`-` 
  | | | | +-9 
  | | | | \-8 
  | | | \-2 
  | | \-o-`(` 
  | |   \-o-`-` 
  | |     +-o-`-` 
  | |     | +-o-`-` 
  | |     | | +-o-`-` 
  | |     | | | +-4 
  | |     | | | \-o-`(` 
  | |     | | |   \-o-`-` 
  | |     | | |     +-o-`+` 
  | |     | | |     | +-o-`-` 
  | |     | | |     | | +-2 
  | |     | | |     | | \-2 
  | |     | | |     | \-9 
  | |     | | |     \-2 
  | |     | | \-9 
  | |     | \-3 
  | |     \-8 
  | \-8 
  \-5 </code></pre>
</div>
<p>— Problem 2 —</p>
<p>Problem 2 is in the same vein but now just needs the <code>+</code> evaluated before the <code>*</code>, so we can do the same <code>*</code> to <code>-</code> swap and then now switch <code>+</code> to the <code>*</code> symbol, so that R thinks it is evaluated before the <code>-</code>.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>`-`</span> <span class='op'>&lt;-</span> <span class='va'>`*`</span>
<span class='va'>`*`</span> <span class='op'>&lt;-</span> <span class='va'>`+`</span>
  
<span class='va'>p2</span> <span class='op'>&lt;-</span> <span class='va'>operations</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>modified_x <span class='op'>=</span> <span class='fu'><a href='https://stringr.tidyverse.org/reference/str_replace.html'>str_replace_all</a></span><span class='op'>(</span><span class='va'>x</span>,<span class='st'>"\\*"</span>,<span class='st'>"\\-"</span><span class='op'>)</span>,
         modified_x <span class='op'>=</span> <span class='fu'><a href='https://stringr.tidyverse.org/reference/str_replace.html'>str_replace_all</a></span><span class='op'>(</span><span class='va'>modified_x</span>,<span class='st'>"\\+"</span>,<span class='st'>"\\*"</span><span class='op'>)</span>,
         output <span class='op'>=</span> <span class='fu'><a href='https://purrr.tidyverse.org/reference/map.html'>map_dbl</a></span><span class='op'>(</span><span class='va'>modified_x</span>,<span class='op'>~</span> <span class='fu'><a href='https://rdrr.io/r/base/eval.html'>eval</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/parse.html'>parse</a></span><span class='op'>(</span>text <span class='op'>=</span> <span class='va'>.x</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">

</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/utils/head.html'>head</a></span><span class='op'>(</span><span class='va'>p2</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code># A tibble: 6 x 2
  modified_x                                                    output
  &lt;chr&gt;                                                          &lt;dbl&gt;
1 9 - 8 * 2 * (4 - (2 - 2 * 9 - 2) - 9 - 3 - 8) * 8 - 5         1.71e6
2 8 - (9 * 5 * 5 - 6 * 8 - 3) - 5 - 7 - 4 * 9                   2.90e6
3 (9 * (2 - 6 * 7 - 5)) - (7 * 7 - 5 * (6 * 2 * 6) - (7 - 8~    7.04e7
4 ((8 * 3 - 6 - 2) - 9 * 3) * 5 * 6 - 3                         4.78e3
5 6 - (9 * 6 - (7 * 4 * 2 * 5 * 6) - 7 * 3 - (5 - 8 - 6 * 6~    4.64e9
6 (8 - 6 * 8) * 6 - 8 - (9 - (6 * 8 - 3 * 8) * (7 - 9 - 6 -~    4.81e8</code></pre>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='va'>p2</span><span class='op'>$</span><span class='va'>output</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<pre><code>[1] 351175492232654</code></pre>
</div>
<p>The same “extra credit exercise”:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>lobstr</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/lobstr/man/ast.html'>ast</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/expression.html'>expression</a></span><span class='op'>(</span><span class='fl'>9</span> <span class='op'>*</span> <span class='fl'>8</span> <span class='op'>+</span> <span class='fl'>2</span> <span class='op'>+</span> <span class='op'>(</span><span class='fl'>4</span> <span class='op'>*</span> <span class='op'>(</span><span class='fl'>2</span> <span class='op'>*</span> <span class='fl'>2</span> <span class='op'>+</span> <span class='fl'>9</span> <span class='op'>*</span> <span class='fl'>2</span><span class='op'>)</span> <span class='op'>*</span> <span class='fl'>9</span> <span class='op'>*</span> <span class='fl'>3</span> <span class='op'>*</span> <span class='fl'>8</span><span class='op'>)</span> <span class='op'>+</span> <span class='fl'>8</span> <span class='op'>*</span> <span class='fl'>5</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>o-expression 
\-o-`+` 
  +-o-`+` 
  | +-o-`+` 
  | | +-o-`*` 
  | | | +-9 
  | | | \-8 
  | | \-2 
  | \-o-`(` 
  |   \-o-`*` 
  |     +-o-`*` 
  |     | +-o-`*` 
  |     | | +-o-`*` 
  |     | | | +-4 
  |     | | | \-o-`(` 
  |     | | |   \-o-`+` 
  |     | | |     +-o-`*` 
  |     | | |     | +-2 
  |     | | |     | \-2 
  |     | | |     \-o-`*` 
  |     | | |       +-9 
  |     | | |       \-2 
  |     | | \-9 
  |     | \-3 
  |     \-8 
  \-o-`*` 
    +-8 
    \-5 </code></pre>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>lobstr</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/lobstr/man/ast.html'>ast</a></span><span class='op'>(</span><span class='fl'>9</span> <span class='op'>-</span> <span class='fl'>8</span> <span class='op'>*</span> <span class='fl'>2</span> <span class='op'>*</span> <span class='op'>(</span><span class='fl'>4</span> <span class='op'>-</span> <span class='op'>(</span><span class='fl'>2</span> <span class='op'>-</span> <span class='fl'>2</span> <span class='op'>*</span> <span class='fl'>9</span> <span class='op'>-</span> <span class='fl'>2</span><span class='op'>)</span> <span class='op'>-</span> <span class='fl'>9</span> <span class='op'>-</span> <span class='fl'>3</span> <span class='op'>-</span> <span class='fl'>8</span><span class='op'>)</span> <span class='op'>*</span> <span class='fl'>8</span> <span class='op'>-</span> <span class='fl'>5</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>o-`-` 
+-o-`-` 
| +-9 
| \-o-`*` 
|   +-o-`*` 
|   | +-o-`*` 
|   | | +-8 
|   | | \-2 
|   | \-o-`(` 
|   |   \-o-`-` 
|   |     +-o-`-` 
|   |     | +-o-`-` 
|   |     | | +-o-`-` 
|   |     | | | +-4 
|   |     | | | \-o-`(` 
|   |     | | |   \-o-`-` 
|   |     | | |     +-o-`-` 
|   |     | | |     | +-2 
|   |     | | |     | \-o-`*` 
|   |     | | |     |   +-2 
|   |     | | |     |   \-9 
|   |     | | |     \-2 
|   |     | | \-9 
|   |     | \-3 
|   |     \-8 
|   \-8 
\-5 </code></pre>
</div>
<div class="sourceCode" id="cb92"><pre class="sourceCode r distill-force-highlighting-css"><code class="sourceCode r"></code></pre></div>
<h2 id="day-19">Day 19</h2>
<p><a href="https://adventofcode.com/2020/day/19" class="uri">https://adventofcode.com/2020/day/19</a></p>
<p>Day nineteen - Monster Messages!</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/message.html'>suppressPackageStartupMessages</a></span><span class='op'>(</span><span class='op'>{</span>
  <span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://tidyverse.tidyverse.org'>tidyverse</a></span><span class='op'>)</span>
  <span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://here.r-lib.org/'>here</a></span><span class='op'>)</span>
  <span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://github.com/tidyverse/glue'>glue</a></span><span class='op'>)</span>
  <span class='co'># library(furrr)</span>
  <span class='co'># plan(multisession)</span>

  <span class='fu'>knitr</span><span class='fu'>::</span><span class='va'><a href='https://rdrr.io/pkg/knitr/man/opts_chunk.html'>opts_chunk</a></span><span class='op'>$</span><span class='fu'>set</span><span class='op'>(</span>echo <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>
<span class='op'>}</span><span class='op'>)</span>
  <span class='fu'><a href='https://rdrr.io/r/base/options.html'>options</a></span><span class='op'>(</span>scipen <span class='op'>=</span> <span class='fl'>9999999</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<p>— Description —</p>
<blockquote>
<p>They think their satellite has collected an image of a sea monster! Unfortunately, the connection to the satellite is having problems, and many of the messages sent back from the satellite have been corrupted.</p>
<p>They sent you a list of the rules valid messages should obey and a list of received messages they’ve collected so far (your puzzle input).</p>
<p>Your goal is to determine the number of messages that completely match rule 0.</p>
</blockquote>
<p>— Data —</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>input_19</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://readr.tidyverse.org/reference/read_lines.html'>read_lines</a></span><span class='op'>(</span><span class='fu'><a href='https://here.r-lib.org//reference/here.html'>here</a></span><span class='op'>(</span><span class='st'>"2020"</span>, <span class='st'>"day-19.txt"</span><span class='op'>)</span><span class='op'>)</span>

<span class='va'>input_19_e</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://readr.tidyverse.org/reference/read_lines.html'>read_lines</a></span><span class='op'>(</span><span class='fu'><a href='https://here.r-lib.org//reference/here.html'>here</a></span><span class='op'>(</span><span class='st'>"2020"</span>, <span class='st'>"day-19-e.txt"</span><span class='op'>)</span><span class='op'>)</span>

<span class='va'>input_19_e2</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://readr.tidyverse.org/reference/read_lines.html'>read_lines</a></span><span class='op'>(</span><span class='fu'><a href='https://here.r-lib.org//reference/here.html'>here</a></span><span class='op'>(</span><span class='st'>"2020"</span>, <span class='st'>"day-19-e2.txt"</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<p>— Cleaning —</p>
<p>Seems nice to split the list of rules into its own tibble.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>messages_e</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://tibble.tidyverse.org/reference/tibble.html'>tibble</a></span><span class='op'>(</span>message <span class='op'>=</span> <span class='va'>input_19_e</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>type <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/cumsum.html'>cumsum</a></span><span class='op'>(</span><span class='va'>message</span> <span class='op'>==</span> <span class='st'>""</span><span class='op'>)</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>type</span> <span class='op'>==</span> <span class='fl'>1</span>,<span class='va'>message</span> <span class='op'>!=</span><span class='st'>""</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/select.html'>select</a></span><span class='op'>(</span><span class='op'>-</span><span class='va'>type</span><span class='op'>)</span>

<span class='va'>rules_e</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://tibble.tidyverse.org/reference/tibble.html'>tibble</a></span><span class='op'>(</span>rule <span class='op'>=</span> <span class='va'>input_19_e</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>type <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/cumsum.html'>cumsum</a></span><span class='op'>(</span><span class='va'>rule</span> <span class='op'>==</span> <span class='st'>""</span><span class='op'>)</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>type</span> <span class='op'>==</span> <span class='fl'>0</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/select.html'>select</a></span><span class='op'>(</span><span class='op'>-</span><span class='va'>type</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
  <span class='fu'><a href='https://tidyr.tidyverse.org/reference/separate.html'>separate</a></span><span class='op'>(</span><span class='va'>rule</span>,into <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"rule_id"</span>,<span class='st'>"rule_desc"</span><span class='op'>)</span>, sep <span class='op'>=</span> <span class='st'>": "</span><span class='op'>)</span>

<span class='va'>messages</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://tibble.tidyverse.org/reference/tibble.html'>tibble</a></span><span class='op'>(</span>message <span class='op'>=</span> <span class='va'>input_19</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>type <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/cumsum.html'>cumsum</a></span><span class='op'>(</span><span class='va'>message</span> <span class='op'>==</span> <span class='st'>""</span><span class='op'>)</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>type</span> <span class='op'>==</span> <span class='fl'>1</span>,<span class='va'>message</span> <span class='op'>!=</span><span class='st'>""</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/select.html'>select</a></span><span class='op'>(</span><span class='op'>-</span><span class='va'>type</span><span class='op'>)</span>

<span class='va'>rules</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://tibble.tidyverse.org/reference/tibble.html'>tibble</a></span><span class='op'>(</span>rule <span class='op'>=</span> <span class='va'>input_19</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>type <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/cumsum.html'>cumsum</a></span><span class='op'>(</span><span class='va'>rule</span> <span class='op'>==</span> <span class='st'>""</span><span class='op'>)</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>type</span> <span class='op'>==</span> <span class='fl'>0</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/select.html'>select</a></span><span class='op'>(</span><span class='op'>-</span><span class='va'>type</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
  <span class='fu'><a href='https://tidyr.tidyverse.org/reference/separate.html'>separate</a></span><span class='op'>(</span><span class='va'>rule</span>,into <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"rule_id"</span>,<span class='st'>"rule_desc"</span><span class='op'>)</span>, sep <span class='op'>=</span> <span class='st'>": "</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<p>— Problem 1 —</p>
<blockquote>
<p>Your goal is to determine the number of messages that completely match rule 0.</p>
</blockquote>
<p>Okay, so writing a function that loops over the rules, taking only complete rules (i.e. rules without numbers) and string-replacing them into their rule_id. Also need to add padding so that the rule id doesn’t match individual digits, and need to add parentheses for rules that have an OR condition.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>rule_recurse</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>rules</span><span class='op'>)</span><span class='op'>{</span>
  
  <span class='va'>rules</span> <span class='op'>&lt;-</span> <span class='va'>rules</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
    <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>rule_desc <span class='op'>=</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/if_else.html'>if_else</a></span><span class='op'>(</span><span class='fu'><a href='https://stringr.tidyverse.org/reference/str_detect.html'>str_detect</a></span><span class='op'>(</span><span class='va'>rule_desc</span>,<span class='st'>"a|b"</span><span class='op'>)</span>, 
                               <span class='fu'><a href='https://stringr.tidyverse.org/reference/str_remove.html'>str_remove_all</a></span><span class='op'>(</span><span class='va'>rule_desc</span>,<span class='st'>'\\"'</span><span class='op'>)</span>, 
                               <span class='va'>rule_desc</span><span class='op'>)</span>,
           rule_id <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste0</a></span><span class='op'>(</span><span class='st'>" "</span>,<span class='va'>rule_id</span>,<span class='st'>" "</span><span class='op'>)</span>,
           rule_desc <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste0</a></span><span class='op'>(</span><span class='st'>" "</span>,<span class='va'>rule_desc</span>,<span class='st'>" "</span><span class='op'>)</span>,
           rule_desc <span class='op'>=</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/if_else.html'>if_else</a></span><span class='op'>(</span><span class='fu'><a href='https://stringr.tidyverse.org/reference/str_detect.html'>str_detect</a></span><span class='op'>(</span><span class='va'>rule_desc</span>,<span class='st'>"\\|"</span><span class='op'>)</span>,
                               <span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste0</a></span><span class='op'>(</span><span class='st'>" ( "</span>,<span class='va'>rule_desc</span>,<span class='st'>" ) "</span><span class='op'>)</span>,
                               <span class='va'>rule_desc</span><span class='op'>)</span><span class='op'>)</span>
  
  <span class='kw'>while</span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/any.html'>any</a></span><span class='op'>(</span><span class='fu'><a href='https://stringr.tidyverse.org/reference/str_detect.html'>str_detect</a></span><span class='op'>(</span><span class='va'>rules</span><span class='op'>$</span><span class='va'>rule_desc</span>,<span class='st'>"[0-9]"</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span><span class='op'>{</span>
    
    <span class='va'>x</span> <span class='op'>&lt;-</span> <span class='va'>rules</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
      <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='op'>!</span><span class='fu'><a href='https://stringr.tidyverse.org/reference/str_detect.html'>str_detect</a></span><span class='op'>(</span><span class='va'>rule_desc</span>,<span class='st'>"[0-9]"</span><span class='op'>)</span><span class='op'>)</span>
    
    <span class='kw'>for</span><span class='op'>(</span><span class='va'>i</span> <span class='kw'>in</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq_along</a></span><span class='op'>(</span><span class='va'>x</span><span class='op'>$</span><span class='va'>rule_id</span><span class='op'>)</span><span class='op'>)</span><span class='op'>{</span>
      <span class='va'>rules</span><span class='op'>$</span><span class='va'>rule_desc</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://stringr.tidyverse.org/reference/str_replace.html'>str_replace_all</a></span><span class='op'>(</span><span class='va'>rules</span><span class='op'>$</span><span class='va'>rule_desc</span>, <span class='va'>x</span><span class='op'>$</span><span class='va'>rule_id</span><span class='op'>[</span><span class='va'>i</span><span class='op'>]</span>, <span class='va'>x</span><span class='op'>$</span><span class='va'>rule_desc</span><span class='op'>[</span><span class='va'>i</span><span class='op'>]</span><span class='op'>)</span>
    <span class='op'>}</span>
  <span class='op'>}</span>
  
  <span class='va'>rules</span> <span class='op'>&lt;-</span> <span class='va'>rules</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
    <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate_all.html'>mutate_all</a></span><span class='op'>(</span><span class='va'>str_remove_all</span>,<span class='st'>" "</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
    <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>rule_desc <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste0</a></span><span class='op'>(</span><span class='st'>"^"</span>,<span class='va'>rule_desc</span>,<span class='st'>"$"</span><span class='op'>)</span><span class='op'>)</span>
  
  <span class='kw'><a href='https://rdrr.io/r/base/function.html'>return</a></span><span class='op'>(</span><span class='va'>rules</span><span class='op'>)</span>
<span class='op'>}</span>
 
<span class='va'>rules_e1</span> <span class='op'>&lt;-</span> <span class='va'>rules_e</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
  <span class='fu'>rule_recurse</span><span class='op'>(</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>rule_id</span> <span class='op'>==</span> <span class='fl'>0</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/pull.html'>pull</a></span><span class='op'>(</span><span class='va'>rule_desc</span><span class='op'>)</span>

<span class='va'>messages_e1</span> <span class='op'>&lt;-</span> <span class='va'>messages_e</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>match <span class='op'>=</span> <span class='fu'><a href='https://stringr.tidyverse.org/reference/str_detect.html'>str_detect</a></span><span class='op'>(</span><span class='va'>message</span>,<span class='va'>rules_e1</span><span class='op'>)</span><span class='op'>)</span>

<span class='va'>p1_rules</span> <span class='op'>&lt;-</span> <span class='va'>rules</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
  <span class='fu'>rule_recurse</span><span class='op'>(</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>rule_id</span> <span class='op'>==</span> <span class='fl'>0</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/pull.html'>pull</a></span><span class='op'>(</span><span class='va'>rule_desc</span><span class='op'>)</span>

<span class='va'>p1_messages</span> <span class='op'>&lt;-</span> <span class='va'>messages</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>match <span class='op'>=</span> <span class='fu'><a href='https://stringr.tidyverse.org/reference/str_detect.html'>str_detect</a></span><span class='op'>(</span><span class='va'>message</span>,<span class='va'>p1_rules</span><span class='op'>)</span><span class='op'>)</span>

<span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='va'>p1_messages</span><span class='op'>$</span><span class='va'>match</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<pre><code>[1] 122</code></pre>
</div>
<p>— Problem 2 —</p>
<blockquote>
<p>Replace 8 and 11 with new rules that create looping - how to fix?</p>
</blockquote>
<p>Approach: “Pray to the regex gods and hope they find you worthy”</p>
<p>Deconstructing the rules changes:</p>
<p>8 is <code>42 | 42 8</code> - so it starts as <code>42</code>, and then when replaced with itself becomes <code>42 42</code>, <code>42 42 42</code> etc - we can represent this as “one or more of” pretty easily: <code>42 +</code> handles that condition.</p>
<p>11 is trickier: <code>42 31 | 42 11 31</code> means plugging <code>42 31</code> recursively into the middle of another set of 42 and 31. I spent a reading through regex recursion on this one, went to bed, continued trying regex recursion on it, until I eventually decided to hardcode <code>42 31 | 42 42 31 31 | 42 42 42 31 31 31</code> etc for like ten iterations of the loop. (I tried fifty, and got a literal stack overflow error!)</p>
<p><img src="https://i.imgur.com/eudI6NN.png" /></p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>messages_e2</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://tibble.tidyverse.org/reference/tibble.html'>tibble</a></span><span class='op'>(</span>message <span class='op'>=</span> <span class='va'>input_19_e2</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>type <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/cumsum.html'>cumsum</a></span><span class='op'>(</span><span class='va'>message</span> <span class='op'>==</span> <span class='st'>""</span><span class='op'>)</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>type</span> <span class='op'>==</span> <span class='fl'>1</span>,<span class='va'>message</span> <span class='op'>!=</span><span class='st'>""</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/select.html'>select</a></span><span class='op'>(</span><span class='op'>-</span><span class='va'>type</span><span class='op'>)</span>

<span class='va'>rules_e2</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://tibble.tidyverse.org/reference/tibble.html'>tibble</a></span><span class='op'>(</span>rule <span class='op'>=</span> <span class='va'>input_19_e2</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>type <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/cumsum.html'>cumsum</a></span><span class='op'>(</span><span class='va'>rule</span> <span class='op'>==</span> <span class='st'>""</span><span class='op'>)</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>type</span> <span class='op'>==</span> <span class='fl'>0</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/select.html'>select</a></span><span class='op'>(</span><span class='op'>-</span><span class='va'>type</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
  <span class='fu'><a href='https://tidyr.tidyverse.org/reference/separate.html'>separate</a></span><span class='op'>(</span><span class='va'>rule</span>,into <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"rule_id"</span>,<span class='st'>"rule_desc"</span><span class='op'>)</span>, sep <span class='op'>=</span> <span class='st'>": "</span><span class='op'>)</span>

<span class='va'>rule_updater</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>rules</span><span class='op'>)</span><span class='op'>{</span>
  <span class='va'>rules</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
    <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>
      rule_desc <span class='op'>=</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/case_when.html'>case_when</a></span><span class='op'>(</span>
        <span class='va'>rule_id</span> <span class='op'>==</span> <span class='st'>"8"</span> <span class='op'>~</span> <span class='st'>"42 +"</span>,
        <span class='va'>rule_id</span> <span class='op'>==</span> <span class='st'>"11"</span> <span class='op'>~</span> 
          <span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste</a></span><span class='op'>(</span>
            <span class='fu'><a href='https://purrr.tidyverse.org/reference/map.html'>map_chr</a></span><span class='op'>(</span><span class='fl'>1</span><span class='op'>:</span><span class='fl'>10</span>, <span class='op'>~</span><span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep_len</a></span><span class='op'>(</span><span class='fl'>42</span>,<span class='va'>.x</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> <span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste</a></span><span class='op'>(</span>collapse <span class='op'>=</span> <span class='st'>" "</span><span class='op'>)</span><span class='op'>)</span>,
            <span class='fu'><a href='https://purrr.tidyverse.org/reference/map.html'>map_chr</a></span><span class='op'>(</span><span class='fl'>1</span><span class='op'>:</span><span class='fl'>10</span>, <span class='op'>~</span><span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep_len</a></span><span class='op'>(</span><span class='fl'>31</span>,<span class='va'>.x</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> <span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste</a></span><span class='op'>(</span>collapse <span class='op'>=</span> <span class='st'>" "</span><span class='op'>)</span><span class='op'>)</span>,
            collapse <span class='op'>=</span> <span class='st'>" | "</span><span class='op'>)</span>,
        <span class='cn'>TRUE</span> <span class='op'>~</span> <span class='va'>rule_desc</span><span class='op'>)</span><span class='op'>)</span>
<span class='op'>}</span>

<span class='va'>p2_rules_e</span> <span class='op'>&lt;-</span> <span class='va'>rules_e2</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
  <span class='fu'>rule_updater</span><span class='op'>(</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
  <span class='fu'>rule_recurse</span><span class='op'>(</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>rule_id</span> <span class='op'>==</span> <span class='fl'>0</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/pull.html'>pull</a></span><span class='op'>(</span><span class='va'>rule_desc</span><span class='op'>)</span>

<span class='va'>messages_p2_e</span> <span class='op'>&lt;-</span> <span class='va'>messages_e2</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>match <span class='op'>=</span> <span class='fu'><a href='https://stringr.tidyverse.org/reference/str_detect.html'>str_detect</a></span><span class='op'>(</span><span class='va'>message</span>,<span class='va'>p2_rules_e</span><span class='op'>)</span><span class='op'>)</span>

<span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='va'>messages_p2_e</span><span class='op'>$</span><span class='va'>match</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<pre><code>[1] 12</code></pre>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>p2_rules</span> <span class='op'>&lt;-</span> <span class='va'>rules</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
  <span class='fu'>rule_updater</span><span class='op'>(</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
  <span class='fu'>rule_recurse</span><span class='op'>(</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>rule_id</span> <span class='op'>==</span> <span class='fl'>0</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/pull.html'>pull</a></span><span class='op'>(</span><span class='va'>rule_desc</span><span class='op'>)</span>

<span class='va'>p2_messages</span> <span class='op'>&lt;-</span> <span class='va'>messages</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>match <span class='op'>=</span> <span class='fu'><a href='https://stringr.tidyverse.org/reference/str_detect.html'>str_detect</a></span><span class='op'>(</span><span class='va'>message</span>, <span class='va'>p2_rules</span><span class='op'>)</span><span class='op'>)</span>

<span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='va'>p2_messages</span><span class='op'>$</span><span class='va'>match</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<pre><code>[1] 287</code></pre>
</div>
<p>Working through the example only sort of helped: I got the example to be 12 but the actual problem ended up failing for hours. It was a good filter for bad solutions though, because when the example was wrong I knew not to bother with the actual problem.</p>
<div class="sourceCode" id="cb96"><pre class="sourceCode r distill-force-highlighting-css"><code class="sourceCode r"></code></pre></div>
<h2 id="day-20">Day 20</h2>
<p><a href="https://adventofcode.com/2020/day/20" class="uri">https://adventofcode.com/2020/day/20</a></p>
<p>Day twenty - Jurassic Jigsaw!</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/message.html'>suppressPackageStartupMessages</a></span><span class='op'>(</span><span class='op'>{</span>
  <span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://tidyverse.tidyverse.org'>tidyverse</a></span><span class='op'>)</span>
  <span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://here.r-lib.org/'>here</a></span><span class='op'>)</span>
  <span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://github.com/tidyverse/glue'>glue</a></span><span class='op'>)</span>

  <span class='fu'>knitr</span><span class='fu'>::</span><span class='va'><a href='https://rdrr.io/pkg/knitr/man/opts_chunk.html'>opts_chunk</a></span><span class='op'>$</span><span class='fu'>set</span><span class='op'>(</span>echo <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>
<span class='op'>}</span><span class='op'>)</span>

  <span class='fu'><a href='https://rdrr.io/r/base/options.html'>options</a></span><span class='op'>(</span>scipen <span class='op'>=</span> <span class='fl'>9999999</span><span class='op'>)</span>
  <span class='fu'><a href='https://rdrr.io/r/base/options.html'>options</a></span><span class='op'>(</span>dplyr.summarise.inform <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<p>— Description —</p>
<blockquote>
<p>The camera array consists of many cameras; rather than produce a single square image, they produce many smaller square image tiles that need to be reassembled back into a single image.</p>
<p>Worse yet, the camera array appears to be malfunctioning: each image tile has been rotated and flipped to a random orientation. Your first task is to reassemble the original image by orienting the tiles so they fit together.</p>
</blockquote>
<p>— Data —</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>input_20</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://readr.tidyverse.org/reference/read_lines.html'>read_lines</a></span><span class='op'>(</span><span class='fu'><a href='https://here.r-lib.org//reference/here.html'>here</a></span><span class='op'>(</span><span class='st'>"2020"</span>, <span class='st'>"day-20.txt"</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<p>— Cleaning —</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>tiles</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://tibble.tidyverse.org/reference/tibble.html'>tibble</a></span><span class='op'>(</span>tile <span class='op'>=</span> <span class='va'>input_20</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>id <span class='op'>=</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/if_else.html'>if_else</a></span><span class='op'>(</span><span class='fu'><a href='https://stringr.tidyverse.org/reference/str_starts.html'>str_starts</a></span><span class='op'>(</span><span class='va'>tile</span>,<span class='st'>"Tile"</span><span class='op'>)</span>,<span class='va'>tile</span>,<span class='cn'>NA_character_</span><span class='op'>)</span>,
         id <span class='op'>=</span> <span class='fu'><a href='https://readr.tidyverse.org/reference/parse_number.html'>parse_number</a></span><span class='op'>(</span><span class='va'>id</span><span class='op'>)</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span>  
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes_colour_fill_alpha.html'>fill</a></span><span class='op'>(</span><span class='va'>id</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>tile</span><span class='op'>!=</span><span class='st'>""</span>,<span class='fu'><a href='https://stringr.tidyverse.org/reference/str_detect.html'>str_detect</a></span><span class='op'>(</span><span class='va'>tile</span>,<span class='st'>"Tile "</span>,negate <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>tile <span class='op'>=</span> <span class='fu'><a href='https://stringr.tidyverse.org/reference/str_split.html'>str_split</a></span><span class='op'>(</span><span class='va'>tile</span>,<span class='st'>""</span><span class='op'>)</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/group_by.html'>group_by</a></span><span class='op'>(</span><span class='va'>id</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/summarise.html'>summarise</a></span><span class='op'>(</span>tile <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/unlist.html'>unlist</a></span><span class='op'>(</span><span class='va'>tile</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>tile <span class='op'>=</span> <span class='fu'><a href='https://purrr.tidyverse.org/reference/map.html'>map</a></span><span class='op'>(</span><span class='va'>tile</span>,<span class='op'>~</span><span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span><span class='op'>(</span><span class='va'>.x</span>,nrow <span class='op'>=</span> <span class='fl'>10</span>, ncol <span class='op'>=</span> <span class='fl'>10</span>, byrow <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<p>— Problem 1 —</p>
<p>Find corner tiles.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>tile_edges</span> <span class='op'>&lt;-</span> <span class='va'>tiles</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>tile_edges <span class='op'>=</span> <span class='fu'><a href='https://purrr.tidyverse.org/reference/map.html'>map</a></span><span class='op'>(</span><span class='va'>tile</span>, 
                          <span class='op'>~</span><span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>
                            top <span class='op'>=</span> <span class='va'>.x</span><span class='op'>[</span><span class='fl'>1</span>,<span class='op'>]</span>, top_rev <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/rev.html'>rev</a></span><span class='op'>(</span><span class='va'>.x</span><span class='op'>[</span><span class='fl'>1</span>,<span class='op'>]</span><span class='op'>)</span>,
                            bottom <span class='op'>=</span> <span class='va'>.x</span><span class='op'>[</span><span class='fl'>10</span>,<span class='op'>]</span>, bottom_rev <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/rev.html'>rev</a></span><span class='op'>(</span><span class='va'>.x</span><span class='op'>[</span><span class='fl'>10</span>,<span class='op'>]</span><span class='op'>)</span>,
                            left <span class='op'>=</span> <span class='va'>.x</span><span class='op'>[</span>,<span class='fl'>1</span><span class='op'>]</span>, left_rev <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/rev.html'>rev</a></span><span class='op'>(</span><span class='va'>.x</span><span class='op'>[</span>,<span class='fl'>1</span><span class='op'>]</span><span class='op'>)</span>,
                            right <span class='op'>=</span> <span class='va'>.x</span><span class='op'>[</span>,<span class='fl'>10</span><span class='op'>]</span>, right_rev <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/rev.html'>rev</a></span><span class='op'>(</span><span class='va'>.x</span><span class='op'>[</span>,<span class='fl'>10</span><span class='op'>]</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
  <span class='fu'><a href='https://tidyr.tidyverse.org/reference/hoist.html'>unnest_longer</a></span><span class='op'>(</span><span class='va'>tile_edges</span>,indices_to <span class='op'>=</span> <span class='st'>"border_position"</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>transmute</a></span><span class='op'>(</span><span class='va'>id</span>,<span class='va'>border_position</span>,tile_edges <span class='op'>=</span> <span class='fu'><a href='https://purrr.tidyverse.org/reference/map.html'>map_chr</a></span><span class='op'>(</span><span class='va'>tile_edges</span>,<span class='va'>paste</span>,collapse <span class='op'>=</span> <span class='st'>""</span><span class='op'>)</span><span class='op'>)</span> 

<span class='va'>p1</span> <span class='op'>&lt;-</span> <span class='va'>tile_edges</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/group_by.html'>group_by</a></span><span class='op'>(</span><span class='va'>tile_edges</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>matches <span class='op'>=</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/context.html'>n</a></span><span class='op'>(</span><span class='op'>)</span><span class='op'>-</span><span class='fl'>1</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/group_by.html'>ungroup</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/group_by.html'>group_by</a></span><span class='op'>(</span><span class='va'>id</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/summarise.html'>summarise</a></span><span class='op'>(</span>sum_matches <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='va'>matches</span><span class='op'>)</span><span class='op'>/</span><span class='fl'>2</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>sum_matches</span> <span class='op'>==</span> <span class='fl'>2</span><span class='op'>)</span>

<span class='va'>p1</span>
</code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<pre><code># A tibble: 4 x 2
     id sum_matches
  &lt;dbl&gt;       &lt;dbl&gt;
1  1109           2
2  1693           2
3  2909           2
4  3371           2</code></pre>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/prod.html'>prod</a></span><span class='op'>(</span><span class='va'>p1</span><span class='op'>$</span><span class='va'>id</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<pre><code>[1] 18411576553343</code></pre>
</div>
<p>— Problem 2 —</p>
<p>Assemble the picture and find the sea monster.</p>
<p>(Internal swearing as I only found the corners first and didn’t actually do the joining bit, so time to catch up)</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>matching_edges</span> <span class='op'>&lt;-</span> <span class='va'>tile_edges</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/group_by.html'>group_by</a></span><span class='op'>(</span><span class='va'>tile_edges</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>matches <span class='op'>=</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/context.html'>n</a></span><span class='op'>(</span><span class='op'>)</span><span class='op'>-</span><span class='fl'>1</span>, 
         matching_tiles <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span><span class='va'>id</span><span class='op'>)</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/group_by.html'>ungroup</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>matches</span><span class='op'>!=</span><span class='fl'>0</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>matching_tiles <span class='op'>=</span> <span class='fu'><a href='https://purrr.tidyverse.org/reference/map2.html'>map2_dbl</a></span><span class='op'>(</span><span class='va'>matching_tiles</span>,<span class='va'>id</span>,<span class='op'>~</span><span class='va'>.x</span><span class='op'>[</span><span class='va'>.x</span><span class='op'>!=</span><span class='va'>.y</span><span class='op'>]</span><span class='op'>)</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/group_by.html'>group_by</a></span><span class='op'>(</span><span class='va'>id</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>matches <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='va'>matches</span><span class='op'>)</span><span class='op'>/</span><span class='fl'>2</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/group_by.html'>ungroup</a></span><span class='op'>(</span><span class='op'>)</span>

<span class='va'>edges</span> <span class='op'>&lt;-</span> <span class='va'>matching_edges</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>matches</span> <span class='op'>&lt;=</span> <span class='fl'>3</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/distinct.html'>distinct</a></span><span class='op'>(</span><span class='va'>id</span>,<span class='va'>matches</span>,<span class='va'>matching_tiles</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>matching_tiles</span> <span class='op'><a href='https://rdrr.io/r/base/match.html'>%in%</a></span> <span class='va'>.</span><span class='op'>$</span><span class='va'>id</span><span class='op'>)</span>

<span class='va'>corners</span> <span class='op'>&lt;-</span> <span class='va'>matching_edges</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>matches</span> <span class='op'>==</span> <span class='fl'>2</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>id_matrix</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/numeric.html'>numeric</a></span><span class='op'>(</span><span class='op'>)</span>,nrow <span class='op'>=</span> <span class='fl'>12</span>, ncol <span class='op'>=</span> <span class='fl'>12</span><span class='op'>)</span>

<span class='va'>perimeter</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1109</span>,<span class='fl'>1181</span><span class='op'>)</span>
<span class='va'>perimeter_options</span> <span class='op'>&lt;-</span> <span class='va'>edges</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='op'>!</span><span class='va'>matching_tiles</span> <span class='op'><a href='https://rdrr.io/r/base/match.html'>%in%</a></span> <span class='va'>perimeter</span><span class='op'>)</span>

<span class='kw'>while</span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>nrow</a></span><span class='op'>(</span><span class='va'>perimeter_options</span><span class='op'>)</span><span class='op'>&gt;</span><span class='fl'>0</span><span class='op'>)</span><span class='op'>{</span>
 
  <span class='va'>i</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span><span class='op'>(</span><span class='va'>perimeter</span><span class='op'>)</span><span class='op'>+</span><span class='fl'>1</span>
  
  <span class='va'>perimeter</span><span class='op'>[</span><span class='va'>i</span><span class='op'>]</span> <span class='op'>&lt;-</span> <span class='va'>perimeter_options</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
    <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>id</span> <span class='op'>==</span> <span class='fu'><a href='https://rdrr.io/r/utils/head.html'>tail</a></span><span class='op'>(</span><span class='va'>perimeter</span>,<span class='fl'>1</span><span class='op'>)</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
    <span class='fu'><a href='https://dplyr.tidyverse.org/reference/pull.html'>pull</a></span><span class='op'>(</span><span class='va'>matching_tiles</span><span class='op'>)</span>
  
  <span class='va'>perimeter_options</span> <span class='op'>&lt;-</span> <span class='va'>perimeter_options</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
    <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='op'>!</span><span class='va'>matching_tiles</span> <span class='op'><a href='https://rdrr.io/r/base/match.html'>%in%</a></span> <span class='va'>perimeter</span><span class='op'>)</span>
<span class='op'>}</span>

<span class='va'>id_matrix</span><span class='op'>[</span><span class='fl'>1</span>,<span class='op'>]</span> <span class='op'>&lt;-</span> <span class='va'>perimeter</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>:</span><span class='fl'>12</span><span class='op'>]</span>
<span class='va'>id_matrix</span><span class='op'>[</span>,<span class='fl'>12</span><span class='op'>]</span> <span class='op'>&lt;-</span> <span class='va'>perimeter</span><span class='op'>[</span><span class='fl'>12</span><span class='op'>:</span><span class='fl'>23</span><span class='op'>]</span>
<span class='va'>id_matrix</span><span class='op'>[</span><span class='fl'>12</span>,<span class='op'>]</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/rev.html'>rev</a></span><span class='op'>(</span><span class='va'>perimeter</span><span class='op'>[</span><span class='fl'>23</span><span class='op'>:</span><span class='fl'>34</span><span class='op'>]</span><span class='op'>)</span>
<span class='va'>id_matrix</span><span class='op'>[</span>,<span class='fl'>1</span><span class='op'>]</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1109</span>,<span class='fu'><a href='https://rdrr.io/r/base/rev.html'>rev</a></span><span class='op'>(</span><span class='va'>perimeter</span><span class='op'>[</span><span class='fl'>34</span><span class='op'>:</span><span class='fl'>44</span><span class='op'>]</span><span class='op'>)</span><span class='op'>)</span>

<span class='fu'><a href='https://rdrr.io/r/base/rm.html'>rm</a></span><span class='op'>(</span><span class='va'>perimeter_options</span>,<span class='va'>perimeter</span><span class='op'>)</span>

<span class='va'>id_matrix</span>
</code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<pre><code>      [,1] [,2] [,3] [,4] [,5] [,6] [,7] [,8] [,9] [,10] [,11] [,12]
 [1,] 1109 1181 2719 1373 1303 1637 3023 1447 1361  1019  1733  1693
 [2,] 1487   NA   NA   NA   NA   NA   NA   NA   NA    NA    NA  1609
 [3,] 3319   NA   NA   NA   NA   NA   NA   NA   NA    NA    NA  2861
 [4,] 2423   NA   NA   NA   NA   NA   NA   NA   NA    NA    NA  1867
 [5,] 2161   NA   NA   NA   NA   NA   NA   NA   NA    NA    NA  3229
 [6,] 2999   NA   NA   NA   NA   NA   NA   NA   NA    NA    NA  3313
 [7,] 1069   NA   NA   NA   NA   NA   NA   NA   NA    NA    NA  3677
 [8,] 2371   NA   NA   NA   NA   NA   NA   NA   NA    NA    NA  3833
 [9,] 3821   NA   NA   NA   NA   NA   NA   NA   NA    NA    NA  3779
[10,] 1523   NA   NA   NA   NA   NA   NA   NA   NA    NA    NA  2819
[11,] 3637   NA   NA   NA   NA   NA   NA   NA   NA    NA    NA  2917
[12,] 3371 2543 2749 3301 2141 1061 1597 2459 1759  2633  2207  2909</code></pre>
</div>
<p>YAY WE HAVE THE PERIMETER! (Still a mountain to climb, but hey.)</p>
<p>Filling in the middles by looking at the tile above and the tile to the left.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>middles</span> <span class='op'>&lt;-</span> <span class='va'>matching_edges</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>matches</span> <span class='op'>==</span> <span class='fl'>4</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/distinct.html'>distinct</a></span><span class='op'>(</span><span class='va'>id</span>,<span class='va'>matching_tiles</span><span class='op'>)</span>

<span class='kw'>for</span><span class='op'>(</span><span class='va'>col</span> <span class='kw'>in</span> <span class='fl'>2</span><span class='op'>:</span><span class='fl'>11</span><span class='op'>)</span><span class='op'>{</span>
  <span class='kw'>for</span><span class='op'>(</span><span class='va'>row</span> <span class='kw'>in</span> <span class='fl'>2</span><span class='op'>:</span><span class='fl'>11</span><span class='op'>)</span><span class='op'>{</span>
    
    <span class='va'>up</span> <span class='op'>&lt;-</span> <span class='va'>id_matrix</span><span class='op'>[</span><span class='va'>row</span><span class='op'>-</span><span class='fl'>1</span>,<span class='va'>col</span><span class='op'>]</span>
    <span class='va'>left</span> <span class='op'>&lt;-</span> <span class='va'>id_matrix</span><span class='op'>[</span><span class='va'>row</span>,<span class='va'>col</span><span class='op'>-</span><span class='fl'>1</span><span class='op'>]</span>
    
    <span class='va'>v</span> <span class='op'>&lt;-</span> <span class='va'>middles</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
      <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>matching_tiles</span> <span class='op'><a href='https://rdrr.io/r/base/match.html'>%in%</a></span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='va'>up</span>,<span class='va'>left</span><span class='op'>)</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
      <span class='fu'><a href='https://dplyr.tidyverse.org/reference/group_by.html'>group_by</a></span><span class='op'>(</span><span class='va'>id</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
      <span class='fu'><a href='https://dplyr.tidyverse.org/reference/summarise.html'>summarise</a></span><span class='op'>(</span>n <span class='op'>=</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/context.html'>n</a></span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
      <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>n</span> <span class='op'>==</span> <span class='fl'>2</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
      <span class='fu'><a href='https://dplyr.tidyverse.org/reference/pull.html'>pull</a></span><span class='op'>(</span><span class='va'>id</span><span class='op'>)</span>
    
    <span class='va'>middles</span> <span class='op'>&lt;-</span> <span class='va'>middles</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>id</span><span class='op'>!=</span><span class='va'>v</span><span class='op'>)</span>
    
    <span class='va'>id_matrix</span><span class='op'>[</span><span class='va'>row</span>,<span class='va'>col</span><span class='op'>]</span> <span class='op'>&lt;-</span> <span class='va'>v</span> 
  <span class='op'>}</span>
<span class='op'>}</span>

<span class='fu'><a href='https://rdrr.io/r/base/rm.html'>rm</a></span><span class='op'>(</span><span class='va'>up</span>, <span class='va'>left</span>, <span class='va'>v</span><span class='op'>)</span>

<span class='va'>id_matrix</span>
</code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<pre><code>      [,1] [,2] [,3] [,4] [,5] [,6] [,7] [,8] [,9] [,10] [,11] [,12]
 [1,] 1109 1181 2719 1373 1303 1637 3023 1447 1361  1019  1733  1693
 [2,] 1487 2441 3671 3221 1367 1097 3761 1601 1091  3253  1667  1609
 [3,] 3319 3257 3863 2593 3089 3181 2273 2699 1429  1697  3691  2861
 [4,] 2423 1213 1559 2969 2621 3739 1193 1823 2531  1489  2549  1867
 [5,] 2161 3019 3881 2411 1619 2081 2617 2707 3527  3467  1439  3229
 [6,] 2999 2843 2083 1789 2131 2521 3137 3673 2377  1123  1847  3313
 [7,] 1069 2557 2777 1049 1993 1423 3931 1153 2663  1201  1129  3677
 [8,] 2371 1553 3727 1249 1607 1741 2683 2039 1327  3011  1033  3833
 [9,] 3821 3491 1783 3877 3413 3659 3517 1879 3583  3191  3533  3779
[10,] 1523 3329 2677 2953 3463 1171 1627 2789 3203  3461  1103  2819
[11,] 3637 1997 2221 2467 2287 2551 2897 1747 3967  1657  3299  2917
[12,] 3371 2543 2749 3301 2141 1061 1597 2459 1759  2633  2207  2909</code></pre>
</div>
<p>Okay! So we now have the location of each tile and now need to orient each tile correctly. Again starting from the top corner tile, now rotating and flipping the tile until it fits into the correct orientation.</p>
<p>Some helpers from Stack Overflow: <a href="https://stackoverflow.com/questions/16496210/rotate-a-matrix-in-r-by-90-degrees-clockwise" class="uri">https://stackoverflow.com/questions/16496210/rotate-a-matrix-in-r-by-90-degrees-clockwise</a></p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>rotate_matrix</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span> <span class='fu'><a href='https://rdrr.io/r/base/t.html'>t</a></span><span class='op'>(</span><span class='va'>x</span><span class='op'>[</span><span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>nrow</a></span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span><span class='op'>:</span><span class='fl'>1</span>,<span class='op'>]</span><span class='op'>)</span>

<span class='va'>flip_matrix</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span> <span class='va'>x</span><span class='op'>[</span><span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>nrow</a></span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span><span class='op'>:</span><span class='fl'>1</span>,<span class='op'>]</span>
</code></pre>
</div>
</div>
<p>First, fill in leftmost column of the matrix, aligning top of new tile with bottom of previous tile.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>correct_tiles</span> <span class='op'>&lt;-</span> <span class='va'>tiles</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>id</span> <span class='op'>==</span> <span class='fl'>1109</span><span class='op'>)</span>

<span class='kw'>for</span><span class='op'>(</span><span class='va'>i</span> <span class='kw'>in</span> <span class='fl'>2</span><span class='op'>:</span><span class='fl'>12</span><span class='op'>)</span><span class='op'>{</span>
  
  <span class='va'>i_id</span> <span class='op'>&lt;-</span> <span class='va'>id_matrix</span><span class='op'>[</span><span class='va'>i</span>,<span class='fl'>1</span><span class='op'>]</span>
  <span class='va'>up_id</span> <span class='op'>&lt;-</span> <span class='va'>id_matrix</span><span class='op'>[</span><span class='va'>i</span><span class='op'>-</span><span class='fl'>1</span>,<span class='fl'>1</span><span class='op'>]</span>
  
  <span class='va'>up_tile</span> <span class='op'>&lt;-</span> <span class='va'>correct_tiles</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
    <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>id</span> <span class='op'>==</span> <span class='va'>up_id</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
    <span class='fu'><a href='https://purrr.tidyverse.org/reference/pluck.html'>pluck</a></span><span class='op'>(</span><span class='st'>"tile"</span>, <span class='fl'>1</span><span class='op'>)</span>
  
  <span class='va'>up_bottom</span> <span class='op'>&lt;-</span> <span class='va'>up_tile</span><span class='op'>[</span><span class='fl'>10</span>,<span class='op'>]</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> <span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste</a></span><span class='op'>(</span>collapse <span class='op'>=</span> <span class='st'>""</span><span class='op'>)</span>
  
  <span class='va'>i_tile</span> <span class='op'>&lt;-</span> <span class='va'>tiles</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
    <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>id</span> <span class='op'>==</span> <span class='va'>i_id</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
    <span class='fu'><a href='https://purrr.tidyverse.org/reference/pluck.html'>pluck</a></span><span class='op'>(</span><span class='st'>"tile"</span>, <span class='fl'>1</span><span class='op'>)</span>

  <span class='va'>i_list</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://tibble.tidyverse.org/reference/tibble.html'>tibble</a></span><span class='op'>(</span>tile <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>
    <span class='va'>i_tile</span>,
    <span class='va'>i_tile</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> <span class='fu'>rotate_matrix</span><span class='op'>(</span><span class='op'>)</span>,
    <span class='va'>i_tile</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> <span class='fu'>rotate_matrix</span><span class='op'>(</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> <span class='fu'>rotate_matrix</span><span class='op'>(</span><span class='op'>)</span>,
    <span class='va'>i_tile</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> <span class='fu'>rotate_matrix</span><span class='op'>(</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> <span class='fu'>rotate_matrix</span><span class='op'>(</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> <span class='fu'>rotate_matrix</span><span class='op'>(</span><span class='op'>)</span>,
    <span class='va'>i_tile</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> <span class='fu'>flip_matrix</span><span class='op'>(</span><span class='op'>)</span>,
    <span class='va'>i_tile</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> <span class='fu'>flip_matrix</span><span class='op'>(</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> <span class='fu'>rotate_matrix</span><span class='op'>(</span><span class='op'>)</span>,
    <span class='va'>i_tile</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> <span class='fu'>flip_matrix</span><span class='op'>(</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> <span class='fu'>rotate_matrix</span><span class='op'>(</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> <span class='fu'>rotate_matrix</span><span class='op'>(</span><span class='op'>)</span>,
    <span class='va'>i_tile</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> <span class='fu'>flip_matrix</span><span class='op'>(</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> <span class='fu'>rotate_matrix</span><span class='op'>(</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> <span class='fu'>rotate_matrix</span><span class='op'>(</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> <span class='fu'>rotate_matrix</span><span class='op'>(</span><span class='op'>)</span>
  <span class='op'>)</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
    <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>match <span class='op'>=</span> <span class='fu'><a href='https://purrr.tidyverse.org/reference/map.html'>map_lgl</a></span><span class='op'>(</span><span class='va'>tile</span>,<span class='op'>~</span><span class='va'>.x</span><span class='op'>[</span><span class='fl'>1</span>,<span class='op'>]</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> <span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste</a></span><span class='op'>(</span>collapse <span class='op'>=</span> <span class='st'>""</span><span class='op'>)</span> <span class='op'>==</span> <span class='va'>up_bottom</span><span class='op'>)</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
    <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>match</span><span class='op'>)</span>
  
  <span class='kw'>if</span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>nrow</a></span><span class='op'>(</span><span class='va'>i_list</span><span class='op'>)</span><span class='op'>==</span><span class='fl'>0</span><span class='op'>)</span> <span class='kw'><a href='https://rdrr.io/r/base/stop.html'>stop</a></span><span class='op'>(</span><span class='op'>)</span>
  
  <span class='va'>i_tile</span> <span class='op'>&lt;-</span> <span class='va'>i_list</span><span class='op'>$</span><span class='va'>tile</span><span class='op'>[[</span><span class='fl'>1</span><span class='op'>]</span><span class='op'>]</span>
  
  <span class='va'>correct_tiles</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://tibble.tidyverse.org/reference/tibble.html'>tibble</a></span><span class='op'>(</span>id <span class='op'>=</span> <span class='va'>i_id</span>, tile <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span><span class='va'>i_tile</span><span class='op'>)</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
    <span class='fu'><a href='https://dplyr.tidyverse.org/reference/bind.html'>bind_rows</a></span><span class='op'>(</span><span class='va'>correct_tiles</span>,<span class='va'>.</span><span class='op'>)</span>
  
<span class='op'>}</span>
</code></pre>
</div>
</div>
<p>Okay, now orient the top row by accessing the right hand side:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='kw'>for</span><span class='op'>(</span><span class='va'>i</span> <span class='kw'>in</span> <span class='fl'>2</span><span class='op'>:</span><span class='fl'>12</span><span class='op'>)</span><span class='op'>{</span>
  
  <span class='va'>i_id</span> <span class='op'>&lt;-</span> <span class='va'>id_matrix</span><span class='op'>[</span><span class='fl'>1</span>,<span class='va'>i</span><span class='op'>]</span>
  <span class='va'>left_id</span> <span class='op'>&lt;-</span> <span class='va'>id_matrix</span><span class='op'>[</span><span class='fl'>1</span>,<span class='va'>i</span><span class='op'>-</span><span class='fl'>1</span><span class='op'>]</span>
  
  <span class='va'>left_tile</span> <span class='op'>&lt;-</span> <span class='va'>correct_tiles</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
    <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>id</span> <span class='op'>==</span> <span class='va'>left_id</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
    <span class='fu'><a href='https://purrr.tidyverse.org/reference/pluck.html'>pluck</a></span><span class='op'>(</span><span class='st'>"tile"</span>, <span class='fl'>1</span><span class='op'>)</span>
  
  <span class='va'>left_right</span> <span class='op'>&lt;-</span> <span class='va'>left_tile</span><span class='op'>[</span>,<span class='fl'>10</span><span class='op'>]</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> <span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste</a></span><span class='op'>(</span>collapse <span class='op'>=</span> <span class='st'>""</span><span class='op'>)</span>
  
  <span class='va'>i_tile</span> <span class='op'>&lt;-</span> <span class='va'>tiles</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
    <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>id</span> <span class='op'>==</span> <span class='va'>i_id</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
    <span class='fu'><a href='https://purrr.tidyverse.org/reference/pluck.html'>pluck</a></span><span class='op'>(</span><span class='st'>"tile"</span>, <span class='fl'>1</span><span class='op'>)</span>
  
  <span class='va'>i_left</span> <span class='op'>&lt;-</span> <span class='va'>i_tile</span><span class='op'>[</span>,<span class='fl'>1</span><span class='op'>]</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> <span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste</a></span><span class='op'>(</span>collapse <span class='op'>=</span> <span class='st'>""</span><span class='op'>)</span>
  
  <span class='va'>i_list</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://tibble.tidyverse.org/reference/tibble.html'>tibble</a></span><span class='op'>(</span>tile <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>
    <span class='va'>i_tile</span>,
    <span class='va'>i_tile</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> <span class='fu'>rotate_matrix</span><span class='op'>(</span><span class='op'>)</span>,
    <span class='va'>i_tile</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> <span class='fu'>rotate_matrix</span><span class='op'>(</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> <span class='fu'>rotate_matrix</span><span class='op'>(</span><span class='op'>)</span>,
    <span class='va'>i_tile</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> <span class='fu'>rotate_matrix</span><span class='op'>(</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> <span class='fu'>rotate_matrix</span><span class='op'>(</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> <span class='fu'>rotate_matrix</span><span class='op'>(</span><span class='op'>)</span>,
    <span class='va'>i_tile</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> <span class='fu'>flip_matrix</span><span class='op'>(</span><span class='op'>)</span>,
    <span class='va'>i_tile</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> <span class='fu'>flip_matrix</span><span class='op'>(</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> <span class='fu'>rotate_matrix</span><span class='op'>(</span><span class='op'>)</span>,
    <span class='va'>i_tile</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> <span class='fu'>flip_matrix</span><span class='op'>(</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> <span class='fu'>rotate_matrix</span><span class='op'>(</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> <span class='fu'>rotate_matrix</span><span class='op'>(</span><span class='op'>)</span>,
    <span class='va'>i_tile</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> <span class='fu'>flip_matrix</span><span class='op'>(</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> <span class='fu'>rotate_matrix</span><span class='op'>(</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> <span class='fu'>rotate_matrix</span><span class='op'>(</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> <span class='fu'>rotate_matrix</span><span class='op'>(</span><span class='op'>)</span>
  <span class='op'>)</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
    <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>match <span class='op'>=</span> <span class='fu'><a href='https://purrr.tidyverse.org/reference/map.html'>map_lgl</a></span><span class='op'>(</span><span class='va'>tile</span>,<span class='op'>~</span><span class='va'>.x</span><span class='op'>[</span>,<span class='fl'>1</span><span class='op'>]</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> <span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste</a></span><span class='op'>(</span>collapse <span class='op'>=</span> <span class='st'>""</span><span class='op'>)</span> <span class='op'>==</span> <span class='va'>left_right</span><span class='op'>)</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
    <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>match</span><span class='op'>)</span>
  
  <span class='kw'>if</span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>nrow</a></span><span class='op'>(</span><span class='va'>i_list</span><span class='op'>)</span><span class='op'>==</span><span class='fl'>0</span><span class='op'>)</span> <span class='kw'><a href='https://rdrr.io/r/base/stop.html'>stop</a></span><span class='op'>(</span><span class='op'>)</span>
  
  <span class='va'>i_tile</span> <span class='op'>&lt;-</span> <span class='va'>i_list</span><span class='op'>$</span><span class='va'>tile</span><span class='op'>[[</span><span class='fl'>1</span><span class='op'>]</span><span class='op'>]</span>
  
  <span class='va'>correct_tiles</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://tibble.tidyverse.org/reference/tibble.html'>tibble</a></span><span class='op'>(</span>id <span class='op'>=</span> <span class='va'>i_id</span>, tile <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span><span class='va'>i_tile</span><span class='op'>)</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
    <span class='fu'><a href='https://dplyr.tidyverse.org/reference/bind.html'>bind_rows</a></span><span class='op'>(</span><span class='va'>correct_tiles</span>,<span class='va'>.</span><span class='op'>)</span>
  
<span class='op'>}</span>

<span class='va'>correct_tiles</span>
</code></pre>
</div>
</div>
<p>Now reapply the vertical orienter for each remaining column:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='kw'>for</span><span class='op'>(</span><span class='va'>c</span> <span class='kw'>in</span> <span class='fl'>2</span><span class='op'>:</span><span class='fl'>12</span><span class='op'>)</span><span class='op'>{</span> <span class='co'># c is column</span>
  <span class='kw'>for</span><span class='op'>(</span><span class='va'>r</span> <span class='kw'>in</span> <span class='fl'>2</span><span class='op'>:</span><span class='fl'>12</span><span class='op'>)</span><span class='op'>{</span> <span class='co'># r is row</span>
    
    <span class='va'>i_id</span> <span class='op'>&lt;-</span> <span class='va'>id_matrix</span><span class='op'>[</span><span class='va'>r</span>,<span class='va'>c</span><span class='op'>]</span>
    <span class='va'>up_id</span> <span class='op'>&lt;-</span> <span class='va'>id_matrix</span><span class='op'>[</span><span class='va'>r</span><span class='op'>-</span><span class='fl'>1</span>,<span class='va'>c</span><span class='op'>]</span>
    
    <span class='va'>up_tile</span> <span class='op'>&lt;-</span> <span class='va'>correct_tiles</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
      <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>id</span> <span class='op'>==</span> <span class='va'>up_id</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
      <span class='fu'><a href='https://purrr.tidyverse.org/reference/pluck.html'>pluck</a></span><span class='op'>(</span><span class='st'>"tile"</span>, <span class='fl'>1</span><span class='op'>)</span>
    
    <span class='va'>up_bottom</span> <span class='op'>&lt;-</span> <span class='va'>up_tile</span><span class='op'>[</span><span class='fl'>10</span>,<span class='op'>]</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> <span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste</a></span><span class='op'>(</span>collapse <span class='op'>=</span> <span class='st'>""</span><span class='op'>)</span>
    
  <span class='va'>i_tile</span> <span class='op'>&lt;-</span> <span class='va'>tiles</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
    <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>id</span> <span class='op'>==</span> <span class='va'>i_id</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
    <span class='fu'><a href='https://purrr.tidyverse.org/reference/pluck.html'>pluck</a></span><span class='op'>(</span><span class='st'>"tile"</span>, <span class='fl'>1</span><span class='op'>)</span>

  <span class='va'>i_list</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://tibble.tidyverse.org/reference/tibble.html'>tibble</a></span><span class='op'>(</span>tile <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>
    <span class='va'>i_tile</span>,
    <span class='va'>i_tile</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> <span class='fu'>rotate_matrix</span><span class='op'>(</span><span class='op'>)</span>,
    <span class='va'>i_tile</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> <span class='fu'>rotate_matrix</span><span class='op'>(</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> <span class='fu'>rotate_matrix</span><span class='op'>(</span><span class='op'>)</span>,
    <span class='va'>i_tile</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> <span class='fu'>rotate_matrix</span><span class='op'>(</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> <span class='fu'>rotate_matrix</span><span class='op'>(</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> <span class='fu'>rotate_matrix</span><span class='op'>(</span><span class='op'>)</span>,
    <span class='va'>i_tile</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> <span class='fu'>flip_matrix</span><span class='op'>(</span><span class='op'>)</span>,
    <span class='va'>i_tile</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> <span class='fu'>flip_matrix</span><span class='op'>(</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> <span class='fu'>rotate_matrix</span><span class='op'>(</span><span class='op'>)</span>,
    <span class='va'>i_tile</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> <span class='fu'>flip_matrix</span><span class='op'>(</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> <span class='fu'>rotate_matrix</span><span class='op'>(</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> <span class='fu'>rotate_matrix</span><span class='op'>(</span><span class='op'>)</span>,
    <span class='va'>i_tile</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> <span class='fu'>flip_matrix</span><span class='op'>(</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> <span class='fu'>rotate_matrix</span><span class='op'>(</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> <span class='fu'>rotate_matrix</span><span class='op'>(</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> <span class='fu'>rotate_matrix</span><span class='op'>(</span><span class='op'>)</span>
  <span class='op'>)</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
    <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>match <span class='op'>=</span> <span class='fu'><a href='https://purrr.tidyverse.org/reference/map.html'>map_lgl</a></span><span class='op'>(</span><span class='va'>tile</span>,<span class='op'>~</span><span class='va'>.x</span><span class='op'>[</span><span class='fl'>1</span>,<span class='op'>]</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> <span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste</a></span><span class='op'>(</span>collapse <span class='op'>=</span> <span class='st'>""</span><span class='op'>)</span> <span class='op'>==</span> <span class='va'>up_bottom</span><span class='op'>)</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
    <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>match</span><span class='op'>)</span>
  
  <span class='kw'>if</span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>nrow</a></span><span class='op'>(</span><span class='va'>i_list</span><span class='op'>)</span><span class='op'>==</span><span class='fl'>0</span><span class='op'>)</span> <span class='kw'><a href='https://rdrr.io/r/base/stop.html'>stop</a></span><span class='op'>(</span><span class='op'>)</span>
  
  <span class='va'>i_tile</span> <span class='op'>&lt;-</span> <span class='va'>i_list</span><span class='op'>$</span><span class='va'>tile</span><span class='op'>[[</span><span class='fl'>1</span><span class='op'>]</span><span class='op'>]</span>
      
  <span class='va'>correct_tiles</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://tibble.tidyverse.org/reference/tibble.html'>tibble</a></span><span class='op'>(</span>id <span class='op'>=</span> <span class='va'>i_id</span>, tile <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span><span class='va'>i_tile</span><span class='op'>)</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
    <span class='fu'><a href='https://dplyr.tidyverse.org/reference/bind.html'>bind_rows</a></span><span class='op'>(</span><span class='va'>correct_tiles</span>,<span class='va'>.</span><span class='op'>)</span>
  <span class='op'>}</span>
<span class='op'>}</span>
</code></pre>
</div>
</div>
<p>Okay, so theoretically we now have a directory of correctly oriented tiles! Now to strip out the border rows from each tile:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>borderless_tiles</span> <span class='op'>&lt;-</span> <span class='va'>correct_tiles</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>tile <span class='op'>=</span> <span class='fu'><a href='https://purrr.tidyverse.org/reference/map.html'>map</a></span><span class='op'>(</span><span class='va'>tile</span>,<span class='op'>~</span><span class='va'>.x</span><span class='op'>[</span><span class='fl'>2</span><span class='op'>:</span><span class='fl'>9</span>,<span class='fl'>2</span><span class='op'>:</span><span class='fl'>9</span><span class='op'>]</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<p>And then row-bind each column together, then bind each column together into the final matrix.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>tile_matrix</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/character.html'>character</a></span><span class='op'>(</span><span class='op'>)</span>, nrow <span class='op'>=</span> <span class='fl'>96</span><span class='op'>)</span>

<span class='kw'>for</span><span class='op'>(</span><span class='va'>c</span> <span class='kw'>in</span> <span class='fl'>1</span><span class='op'>:</span><span class='fl'>12</span><span class='op'>)</span><span class='op'>{</span>
  <span class='va'>column_matrix</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/character.html'>character</a></span><span class='op'>(</span><span class='op'>)</span>, ncol <span class='op'>=</span> <span class='fl'>8</span><span class='op'>)</span>
  
  <span class='kw'>for</span><span class='op'>(</span><span class='va'>r</span> <span class='kw'>in</span> <span class='fl'>1</span><span class='op'>:</span><span class='fl'>12</span><span class='op'>)</span><span class='op'>{</span>
    <span class='va'>tile_id</span> <span class='op'>&lt;-</span> <span class='va'>id_matrix</span><span class='op'>[</span><span class='va'>r</span>,<span class='va'>c</span><span class='op'>]</span>
    
    <span class='va'>tile</span> <span class='op'>&lt;-</span> <span class='va'>borderless_tiles</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
      <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>id</span> <span class='op'>==</span> <span class='va'>tile_id</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
      <span class='fu'><a href='https://purrr.tidyverse.org/reference/pluck.html'>pluck</a></span><span class='op'>(</span><span class='st'>"tile"</span>,<span class='fl'>1</span><span class='op'>)</span>
    
    <span class='va'>column_matrix</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/cbind.html'>rbind</a></span><span class='op'>(</span><span class='va'>column_matrix</span>,<span class='va'>tile</span><span class='op'>)</span>
  <span class='op'>}</span>
  
  <span class='va'>tile_matrix</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/cbind.html'>cbind</a></span><span class='op'>(</span><span class='va'>tile_matrix</span>,<span class='va'>column_matrix</span><span class='op'>)</span>
<span class='op'>}</span>
</code></pre>
</div>
</div>
<p>Now to detect a seamonster! First, the monster:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>monster</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://tibble.tidyverse.org/reference/tibble.html'>tibble</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"                  # "</span>, 
                        <span class='st'>"#    ##    ##    ###"</span>,
                        <span class='st'>" #  #  #  #  #  #   "</span><span class='op'>)</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='fu'><a href='https://stringr.tidyverse.org/reference/str_split.html'>str_split</a></span><span class='op'>(</span><span class='va'>x</span>,<span class='st'>""</span><span class='op'>)</span>,
         row <span class='op'>=</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/ranking.html'>row_number</a></span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
  <span class='fu'><a href='https://tidyr.tidyverse.org/reference/hoist.html'>unnest_wider</a></span><span class='op'>(</span><span class='va'>x</span>, names_sep <span class='op'>=</span> <span class='st'>""</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
  <span class='fu'><a href='https://tidyr.tidyverse.org/reference/pivot_longer.html'>pivot_longer</a></span><span class='op'>(</span>cols <span class='op'>=</span> <span class='op'>-</span><span class='va'>row</span>,names_to <span class='op'>=</span> <span class='st'>"col"</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>col <span class='op'>=</span> <span class='fu'><a href='https://readr.tidyverse.org/reference/parse_number.html'>parse_number</a></span><span class='op'>(</span><span class='va'>col</span><span class='op'>)</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>value</span> <span class='op'>==</span> <span class='st'>"#"</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<p>Now, we need to loop over the tile matrix, looking at every 20-wide + 3-tall matrix to see if it’s a monster. We’ll need to do this for every iteration of the tile matrix (rotates and flips).</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>scan_tile_matrix_for_monsters</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>tile_matrix</span>,<span class='va'>monster</span><span class='op'>)</span><span class='op'>{</span>
  
  <span class='va'>monster_count</span> <span class='op'>&lt;-</span> <span class='fl'>0</span>
  
  <span class='kw'>for</span><span class='op'>(</span><span class='va'>c</span> <span class='kw'>in</span> <span class='fl'>1</span><span class='op'>:</span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>ncol</a></span><span class='op'>(</span><span class='va'>tile_matrix</span><span class='op'>)</span><span class='op'>-</span><span class='fl'>19</span><span class='op'>)</span><span class='op'>)</span><span class='op'>{</span>
    
    <span class='kw'>for</span><span class='op'>(</span><span class='va'>r</span> <span class='kw'>in</span> <span class='fl'>1</span><span class='op'>:</span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>nrow</a></span><span class='op'>(</span><span class='va'>tile_matrix</span><span class='op'>)</span><span class='op'>-</span><span class='fl'>2</span><span class='op'>)</span><span class='op'>)</span><span class='op'>{</span>
      
      <span class='va'>x</span> <span class='op'>&lt;-</span> <span class='va'>tile_matrix</span><span class='op'>[</span><span class='va'>r</span><span class='op'>:</span><span class='op'>(</span><span class='va'>r</span><span class='op'>+</span><span class='fl'>2</span><span class='op'>)</span>,<span class='va'>c</span><span class='op'>:</span><span class='op'>(</span><span class='va'>c</span><span class='op'>+</span><span class='fl'>19</span><span class='op'>)</span><span class='op'>]</span>
      
      <span class='va'>v</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://purrr.tidyverse.org/reference/map2.html'>map2_lgl</a></span><span class='op'>(</span><span class='va'>monster</span><span class='op'>$</span><span class='va'>row</span>,<span class='va'>monster</span><span class='op'>$</span><span class='va'>col</span>, <span class='op'>~</span><span class='va'>x</span><span class='op'>[</span><span class='va'>.x</span>,<span class='va'>.y</span><span class='op'>]</span><span class='op'>==</span><span class='st'>"#"</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> <span class='fu'><a href='https://rdrr.io/r/base/all.html'>all</a></span><span class='op'>(</span><span class='op'>)</span>
      
      <span class='kw'>if</span><span class='op'>(</span><span class='va'>v</span><span class='op'>)</span> <span class='va'>monster_count</span> <span class='op'>&lt;-</span> <span class='va'>monster_count</span> <span class='op'>+</span> <span class='fl'>1</span>
    <span class='op'>}</span>
  <span class='op'>}</span>
  
  <span class='kw'><a href='https://rdrr.io/r/base/function.html'>return</a></span><span class='op'>(</span><span class='va'>monster_count</span><span class='op'>)</span>
<span class='op'>}</span>

<span class='va'>all_matrices</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>
  <span class='va'>tile_matrix</span>,
  <span class='va'>tile_matrix</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> <span class='fu'>rotate_matrix</span><span class='op'>(</span><span class='op'>)</span>,
  <span class='va'>tile_matrix</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> <span class='fu'>rotate_matrix</span><span class='op'>(</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> <span class='fu'>rotate_matrix</span><span class='op'>(</span><span class='op'>)</span>,
  <span class='va'>tile_matrix</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> <span class='fu'>rotate_matrix</span><span class='op'>(</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> <span class='fu'>rotate_matrix</span><span class='op'>(</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> <span class='fu'>rotate_matrix</span><span class='op'>(</span><span class='op'>)</span>,
  <span class='fu'>flip_matrix</span><span class='op'>(</span><span class='va'>tile_matrix</span><span class='op'>)</span>,
  <span class='fu'>flip_matrix</span><span class='op'>(</span><span class='va'>tile_matrix</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> <span class='fu'>rotate_matrix</span><span class='op'>(</span><span class='op'>)</span>,
  <span class='fu'>flip_matrix</span><span class='op'>(</span><span class='va'>tile_matrix</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> <span class='fu'>rotate_matrix</span><span class='op'>(</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> <span class='fu'>rotate_matrix</span><span class='op'>(</span><span class='op'>)</span>,
  <span class='fu'>flip_matrix</span><span class='op'>(</span><span class='va'>tile_matrix</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> <span class='fu'>rotate_matrix</span><span class='op'>(</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> <span class='fu'>rotate_matrix</span><span class='op'>(</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> <span class='fu'>rotate_matrix</span><span class='op'>(</span><span class='op'>)</span>
  <span class='op'>)</span>

<span class='va'>monster_count</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://purrr.tidyverse.org/reference/map.html'>map_dbl</a></span><span class='op'>(</span><span class='va'>all_matrices</span>,<span class='va'>scan_tile_matrix_for_monsters</span>,<span class='va'>monster</span><span class='op'>)</span>

<span class='va'>monster_count</span>
</code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<pre><code>[1]  0  0 43  0  0  0  0  0</code></pre>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='va'>tile_matrix</span> <span class='op'>==</span> <span class='st'>"#"</span><span class='op'>)</span> <span class='op'>-</span> <span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/Extremes.html'>max</a></span><span class='op'>(</span><span class='va'>monster_count</span><span class='op'>)</span> <span class='op'>*</span> <span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>nrow</a></span><span class='op'>(</span><span class='va'>monster</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<pre><code>[1] 2002</code></pre>
</div>
<p>Whew, that was a doozy!</p>
<div class="sourceCode" id="cb103"><pre class="sourceCode r distill-force-highlighting-css"><code class="sourceCode r"></code></pre></div>
<h2 id="day-21">Day 21</h2>
<p><a href="https://adventofcode.com/2020/day/21" class="uri">https://adventofcode.com/2020/day/21</a></p>
<p>Day twenty-one - Allergen Assessment!</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/message.html'>suppressPackageStartupMessages</a></span><span class='op'>(</span><span class='op'>{</span>
  <span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://tidyverse.tidyverse.org'>tidyverse</a></span><span class='op'>)</span>
  <span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://here.r-lib.org/'>here</a></span><span class='op'>)</span>
  <span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://github.com/tidyverse/glue'>glue</a></span><span class='op'>)</span>

  <span class='fu'>knitr</span><span class='fu'>::</span><span class='va'><a href='https://rdrr.io/pkg/knitr/man/opts_chunk.html'>opts_chunk</a></span><span class='op'>$</span><span class='fu'>set</span><span class='op'>(</span>echo <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>
<span class='op'>}</span><span class='op'>)</span>

  <span class='fu'><a href='https://rdrr.io/r/base/options.html'>options</a></span><span class='op'>(</span>scipen <span class='op'>=</span> <span class='fl'>9999999</span><span class='op'>)</span>
  <span class='fu'><a href='https://rdrr.io/r/base/options.html'>options</a></span><span class='op'>(</span>dplyr.summarise.inform <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<p>— Description —</p>
— Data —
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>input_21</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://readr.tidyverse.org/reference/read_lines.html'>read_lines</a></span><span class='op'>(</span><span class='fu'><a href='https://here.r-lib.org//reference/here.html'>here</a></span><span class='op'>(</span><span class='st'>"2020"</span>, <span class='st'>"day-21.txt"</span><span class='op'>)</span><span class='op'>)</span>

<span class='va'>input_21_e</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://readr.tidyverse.org/reference/read_lines.html'>read_lines</a></span><span class='op'>(</span><span class='fu'><a href='https://here.r-lib.org//reference/here.html'>here</a></span><span class='op'>(</span><span class='st'>"2020"</span>,<span class='st'>"day-21-e.txt"</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<p>— Cleaning —</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>ingredient_list</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://tibble.tidyverse.org/reference/tibble.html'>tibble</a></span><span class='op'>(</span>i <span class='op'>=</span> <span class='va'>input_21</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>id <span class='op'>=</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/ranking.html'>row_number</a></span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
  <span class='fu'><a href='https://tidyr.tidyverse.org/reference/separate.html'>separate</a></span><span class='op'>(</span><span class='va'>i</span>, into <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"ingredient"</span>,<span class='st'>"allergen"</span><span class='op'>)</span>, sep <span class='op'>=</span> <span class='st'>" \\(contains "</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
  <span class='fu'><a href='https://tidyr.tidyverse.org/reference/separate_rows.html'>separate_rows</a></span><span class='op'>(</span><span class='va'>ingredient</span>,sep <span class='op'>=</span> <span class='st'>" "</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>allergen <span class='op'>=</span> <span class='fu'><a href='https://stringr.tidyverse.org/reference/str_remove.html'>str_remove</a></span><span class='op'>(</span><span class='va'>allergen</span>,<span class='st'>"\\)"</span><span class='op'>)</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
  <span class='fu'><a href='https://tidyr.tidyverse.org/reference/separate_rows.html'>separate_rows</a></span><span class='op'>(</span><span class='va'>allergen</span>,sep <span class='op'>=</span> <span class='st'>", "</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<p>— Problem 1 —</p>
<p>Count non-allergens. Spent some time thinking about this one, but basically I’m grouping by allergen and getting the ingredients that occur the most for each allergen. If it’s a single ingredient, that’s the one (and then eliminates that ingredient from being the allergen from any of the others). Loop through this to create a table of allergens.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>top_allergens</span> <span class='op'>&lt;-</span> <span class='va'>ingredient_list</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/group_by.html'>group_by</a></span><span class='op'>(</span><span class='va'>ingredient</span>,<span class='va'>allergen</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/summarise.html'>summarise</a></span><span class='op'>(</span>n <span class='op'>=</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/context.html'>n</a></span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span><span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/group_by.html'>group_by</a></span><span class='op'>(</span><span class='va'>allergen</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/slice.html'>slice_max</a></span><span class='op'>(</span><span class='va'>n</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>nn <span class='op'>=</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/context.html'>n</a></span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span>  
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/arrange.html'>arrange</a></span><span class='op'>(</span><span class='va'>nn</span>,<span class='fu'><a href='https://dplyr.tidyverse.org/reference/desc.html'>desc</a></span><span class='op'>(</span><span class='va'>n</span><span class='op'>)</span>,<span class='va'>allergen</span><span class='op'>)</span>

<span class='va'>allergen_options</span> <span class='op'>&lt;-</span> <span class='va'>top_allergens</span>

<span class='va'>allergen_df</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://tibble.tidyverse.org/reference/tibble.html'>tibble</a></span><span class='op'>(</span><span class='op'>)</span>

<span class='kw'>while</span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>nrow</a></span><span class='op'>(</span><span class='va'>allergen_options</span><span class='op'>)</span><span class='op'>&gt;</span><span class='fl'>0</span><span class='op'>)</span> <span class='op'>{</span>
  
  <span class='va'>x</span> <span class='op'>&lt;-</span> <span class='va'>allergen_options</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
    <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>nn</span> <span class='op'>==</span> <span class='fl'>1</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
    <span class='fu'><a href='https://dplyr.tidyverse.org/reference/select.html'>select</a></span><span class='op'>(</span><span class='va'>ingredient</span>, <span class='va'>allergen</span><span class='op'>)</span>

  <span class='va'>allergen_df</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/bind.html'>bind_rows</a></span><span class='op'>(</span><span class='va'>allergen_df</span>, <span class='va'>x</span><span class='op'>)</span>
  
  <span class='va'>allergen_options</span> <span class='op'>&lt;-</span> <span class='va'>allergen_options</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
    <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='op'>!</span><span class='va'>ingredient</span> <span class='op'><a href='https://rdrr.io/r/base/match.html'>%in%</a></span> <span class='va'>allergen_df</span><span class='op'>$</span><span class='va'>ingredient</span>, <span class='op'>!</span><span class='va'>allergen</span> <span class='op'><a href='https://rdrr.io/r/base/match.html'>%in%</a></span> <span class='va'>allergen_df</span><span class='op'>$</span><span class='va'>allergen</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
    <span class='fu'><a href='https://dplyr.tidyverse.org/reference/group_by.html'>group_by</a></span><span class='op'>(</span><span class='va'>allergen</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
    <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>nn <span class='op'>=</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/context.html'>n</a></span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span>
<span class='op'>}</span>

<span class='va'>non_allergens</span> <span class='op'>&lt;-</span> <span class='va'>ingredient_list</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='op'>!</span><span class='va'>ingredient</span> <span class='op'><a href='https://rdrr.io/r/base/match.html'>%in%</a></span> <span class='va'>allergen_df</span><span class='op'>$</span><span class='va'>ingredient</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/distinct.html'>distinct</a></span><span class='op'>(</span><span class='va'>ingredient</span>,<span class='va'>id</span><span class='op'>)</span>

<span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>nrow</a></span><span class='op'>(</span><span class='va'>non_allergens</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>[1] 2428</code></pre>
</div>
<p>— Problem 2 —</p>
<p>…is only to arrange the allergens in order? what?</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>allergen_df</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/arrange.html'>arrange</a></span><span class='op'>(</span><span class='va'>allergen</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/pull.html'>pull</a></span><span class='op'>(</span><span class='va'>ingredient</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
  <span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste</a></span><span class='op'>(</span>collapse <span class='op'>=</span> <span class='st'>","</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>[1] &quot;bjq,jznhvh,klplr,dtvhzt,sbzd,tlgjzx,ctmbr,kqms&quot;</code></pre>
</div>
<p>…that was … easy?!</p>
<div class="sourceCode" id="cb106"><pre class="sourceCode r distill-force-highlighting-css"><code class="sourceCode r"></code></pre></div>
<h2 id="day-22">Day 22</h2>
<p><a href="https://adventofcode.com/2020/day/22" class="uri">https://adventofcode.com/2020/day/22</a></p>
<p>Day twenty-two - Combat Crabs!</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/message.html'>suppressPackageStartupMessages</a></span><span class='op'>(</span><span class='op'>{</span>
  <span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://tidyverse.tidyverse.org'>tidyverse</a></span><span class='op'>)</span>
  <span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://here.r-lib.org/'>here</a></span><span class='op'>)</span>
  <span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://github.com/tidyverse/glue'>glue</a></span><span class='op'>)</span>

  <span class='fu'>knitr</span><span class='fu'>::</span><span class='va'><a href='https://rdrr.io/pkg/knitr/man/opts_chunk.html'>opts_chunk</a></span><span class='op'>$</span><span class='fu'>set</span><span class='op'>(</span>echo <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>
<span class='op'>}</span><span class='op'>)</span>

  <span class='fu'><a href='https://rdrr.io/r/base/options.html'>options</a></span><span class='op'>(</span>scipen <span class='op'>=</span> <span class='fl'>9999999</span><span class='op'>)</span>
  <span class='fu'><a href='https://rdrr.io/r/base/options.html'>options</a></span><span class='op'>(</span>dplyr.summarise.inform <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<p>— Description —</p>
— Data —
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>input_22</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://readr.tidyverse.org/reference/read_lines.html'>read_lines</a></span><span class='op'>(</span><span class='fu'><a href='https://here.r-lib.org//reference/here.html'>here</a></span><span class='op'>(</span><span class='st'>"2020"</span>, <span class='st'>"day-22.txt"</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<p>— Cleaning —</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>cards</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://tibble.tidyverse.org/reference/tibble.html'>tibble</a></span><span class='op'>(</span>card <span class='op'>=</span> <span class='va'>input_22</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>player <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/cumsum.html'>cumsum</a></span><span class='op'>(</span><span class='fu'><a href='https://stringr.tidyverse.org/reference/str_detect.html'>str_detect</a></span><span class='op'>(</span><span class='va'>card</span>,<span class='st'>"Player"</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>card</span><span class='op'>!=</span><span class='st'>""</span>,<span class='op'>!</span><span class='fu'><a href='https://stringr.tidyverse.org/reference/str_detect.html'>str_detect</a></span><span class='op'>(</span><span class='va'>card</span>,<span class='st'>"Player"</span><span class='op'>)</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>card <span class='op'>=</span> <span class='fu'><a href='https://readr.tidyverse.org/reference/parse_number.html'>parse_number</a></span><span class='op'>(</span><span class='va'>card</span><span class='op'>)</span><span class='op'>)</span>

<span class='va'>player_1</span> <span class='op'>&lt;-</span> <span class='va'>cards</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>player</span> <span class='op'>==</span> <span class='fl'>1</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/pull.html'>pull</a></span><span class='op'>(</span><span class='va'>card</span><span class='op'>)</span>

<span class='va'>player_2</span> <span class='op'>&lt;-</span> <span class='va'>cards</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>player</span> <span class='op'>==</span> <span class='fl'>2</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/pull.html'>pull</a></span><span class='op'>(</span><span class='va'>card</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>draw_card</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>player</span><span class='op'>)</span><span class='op'>{</span> <span class='fu'><a href='https://rdrr.io/r/utils/head.html'>head</a></span><span class='op'>(</span><span class='va'>player</span>,<span class='fl'>1</span><span class='op'>)</span> <span class='op'>}</span>
<span class='va'>remove_card</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>player</span><span class='op'>)</span><span class='op'>{</span> <span class='fu'><a href='https://rdrr.io/r/utils/head.html'>tail</a></span><span class='op'>(</span><span class='va'>player</span>,<span class='op'>-</span><span class='fl'>1</span><span class='op'>)</span> <span class='op'>}</span>
</code></pre>
</div>
</div>
<p>— Problem 1 —</p>
<p>Combat == “War” in my card game lexicon. Okay, looks straightforward enough:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>g1_player1</span> <span class='op'>&lt;-</span> <span class='va'>player_1</span>
<span class='va'>g1_player2</span> <span class='op'>&lt;-</span> <span class='va'>player_2</span>

<span class='kw'>while</span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/all.html'>all</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span><span class='op'>(</span><span class='va'>g1_player1</span><span class='op'>)</span><span class='op'>&gt;</span><span class='fl'>0</span>,<span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span><span class='op'>(</span><span class='va'>g1_player2</span><span class='op'>)</span><span class='op'>&gt;</span><span class='fl'>0</span><span class='op'>)</span><span class='op'>)</span><span class='op'>{</span>
  
  <span class='va'>card_p1</span> <span class='op'>&lt;-</span> <span class='fu'>draw_card</span><span class='op'>(</span><span class='va'>g1_player1</span><span class='op'>)</span>
  <span class='va'>g1_player1</span> <span class='op'>&lt;-</span> <span class='fu'>remove_card</span><span class='op'>(</span><span class='va'>g1_player1</span><span class='op'>)</span>
  
  <span class='va'>card_p2</span> <span class='op'>&lt;-</span> <span class='fu'>draw_card</span><span class='op'>(</span><span class='va'>g1_player2</span><span class='op'>)</span>
  <span class='va'>g1_player2</span> <span class='op'>&lt;-</span> <span class='fu'>remove_card</span><span class='op'>(</span><span class='va'>g1_player2</span><span class='op'>)</span>
  
  <span class='kw'>if</span><span class='op'>(</span><span class='va'>card_p1</span> <span class='op'>&gt;</span> <span class='va'>card_p2</span><span class='op'>)</span> <span class='va'>g1_player1</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='va'>g1_player1</span>,<span class='va'>card_p1</span>,<span class='va'>card_p2</span><span class='op'>)</span>
  
  <span class='kw'>if</span><span class='op'>(</span><span class='va'>card_p2</span> <span class='op'>&gt;</span> <span class='va'>card_p1</span><span class='op'>)</span> <span class='va'>g1_player2</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='va'>g1_player2</span>,<span class='va'>card_p2</span>,<span class='va'>card_p1</span><span class='op'>)</span>
  
<span class='op'>}</span>

<span class='va'>g1_player1</span>
</code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<pre><code> [1] 45 13 16  8 38 27 35 24 44 18 34 17 39 21 10  5 33 12 31  3 15  1
[23] 50 49 26 23 48 40 43 14 42 11 41 30 37 19 47 32 28 20 36 29 46  7
[45]  9  6 25  4 22  2</code></pre>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>g1_player2</span>
</code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<pre><code>[1] 0</code></pre>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='op'>(</span><span class='va'>g1_player1</span> <span class='op'>*</span> <span class='fl'>50</span><span class='op'>:</span><span class='fl'>1</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> <span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<pre><code>[1] 33421</code></pre>
</div>
<p>— Problem 2 —</p>
<p>Recursive Combat? Le wot?</p>
<p>Rules:</p>
<ul>
<li>Game instantly ends in a win if a previous round within this game has the same cards in the same order in the same players decks, award win to player 1</li>
<li>Begin round as usual by drawing the card.</li>
<li>If the number of cards remaining in the deck is more than the card they just drew, the winner of the round is determined by playing a new subgame of recursive combat.</li>
<li>If the number of cards remaining in the deck is less than the card they just drew (for either), the winner of the round is the player with the higher value card.</li>
</ul>
<p>Lmao wtf okay…(insert meme)</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>i</span> <span class='op'>&lt;-</span> <span class='fl'>0</span>
<span class='va'>recursive_combat</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>player_1</span>,<span class='va'>player_2</span><span class='op'>)</span><span class='op'>{</span>

  <span class='va'>i</span><span class='op'>&lt;&lt;-</span><span class='va'>i</span><span class='op'>+</span><span class='fl'>1</span>
  
  <span class='co'># Hold the early exit game state</span>
  <span class='va'>deck_states</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='op'>)</span>
  
  <span class='va'>game_deck_player_1</span> <span class='op'>&lt;-</span> <span class='va'>player_1</span>
  <span class='va'>game_deck_player_2</span> <span class='op'>&lt;-</span> <span class='va'>player_2</span>
  
  <span class='va'>game_winner</span> <span class='op'>&lt;-</span> <span class='cn'>NULL</span>
  
  <span class='va'>loop</span> <span class='op'>&lt;-</span> <span class='fl'>1</span>
  
  <span class='kw'>while</span><span class='op'>(</span><span class='va'>loop</span> <span class='op'>!=</span> <span class='fl'>0</span><span class='op'>)</span><span class='op'>{</span>
    
    <span class='co'># check deck states</span>
    <span class='va'>player_1_score</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='va'>game_deck_player_1</span> <span class='op'>*</span> <span class='fu'><a href='https://rdrr.io/r/base/rev.html'>rev</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq_along</a></span><span class='op'>(</span><span class='va'>game_deck_player_1</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>
    <span class='va'>player_2_score</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='va'>game_deck_player_2</span> <span class='op'>*</span> <span class='fu'><a href='https://rdrr.io/r/base/rev.html'>rev</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq_along</a></span><span class='op'>(</span><span class='va'>game_deck_player_2</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>
    
    <span class='va'>this_deck</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste</a></span><span class='op'>(</span><span class='va'>player_1_score</span>,<span class='va'>player_2_score</span>,sep <span class='op'>=</span> <span class='st'>"-"</span><span class='op'>)</span>
    
    <span class='kw'>if</span><span class='op'>(</span><span class='va'>this_deck</span> <span class='op'><a href='https://rdrr.io/r/base/match.html'>%in%</a></span> <span class='va'>deck_states</span><span class='op'>)</span> <span class='op'>{</span>
      
      <span class='va'>game_winner</span> <span class='op'>&lt;-</span> <span class='st'>"player_one"</span> 
      
      <span class='kw'>break</span>
      
    <span class='op'>}</span> <span class='kw'>else</span> <span class='op'>{</span>
      <span class='va'>deck_states</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='va'>deck_states</span>,<span class='va'>this_deck</span><span class='op'>)</span>
    <span class='op'>}</span>
    
    <span class='co'># draw cards</span>
    <span class='va'>draw_player1</span> <span class='op'>&lt;-</span> <span class='fu'>draw_card</span><span class='op'>(</span><span class='va'>game_deck_player_1</span><span class='op'>)</span>
    <span class='va'>game_deck_player_1</span> <span class='op'>&lt;-</span> <span class='fu'>remove_card</span><span class='op'>(</span><span class='va'>game_deck_player_1</span><span class='op'>)</span>
    
    <span class='va'>draw_player2</span> <span class='op'>&lt;-</span> <span class='fu'>draw_card</span><span class='op'>(</span><span class='va'>game_deck_player_2</span><span class='op'>)</span>
    <span class='va'>game_deck_player_2</span> <span class='op'>&lt;-</span> <span class='fu'>remove_card</span><span class='op'>(</span><span class='va'>game_deck_player_2</span><span class='op'>)</span>
    
    <span class='co'># Play recursive combat?</span>
    
    <span class='kw'>if</span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span><span class='op'>(</span><span class='va'>game_deck_player_1</span><span class='op'>)</span><span class='op'>&gt;=</span><span class='va'>draw_player1</span> <span class='op'>&amp;</span> <span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span><span class='op'>(</span><span class='va'>game_deck_player_2</span><span class='op'>)</span><span class='op'>&gt;=</span><span class='va'>draw_player2</span><span class='op'>)</span> <span class='op'>{</span>
      
      <span class='va'>round_winner</span> <span class='op'>&lt;-</span> <span class='fu'>recursive_combat</span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/utils/head.html'>head</a></span><span class='op'>(</span><span class='va'>game_deck_player_1</span>, <span class='va'>draw_player1</span><span class='op'>)</span>, 
                                       <span class='fu'><a href='https://rdrr.io/r/utils/head.html'>head</a></span><span class='op'>(</span><span class='va'>game_deck_player_2</span>, <span class='va'>draw_player2</span><span class='op'>)</span><span class='op'>)</span><span class='op'>$</span><span class='va'>game_winner</span>
      
    <span class='op'>}</span> <span class='kw'>else</span> <span class='op'>{</span>
      <span class='va'>round_winner</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/ifelse.html'>ifelse</a></span><span class='op'>(</span><span class='va'>draw_player1</span> <span class='op'>&gt;</span> <span class='va'>draw_player2</span>, <span class='st'>"player_one"</span>, <span class='st'>"player_two"</span><span class='op'>)</span>
    <span class='op'>}</span>
    
    <span class='kw'>if</span><span class='op'>(</span><span class='va'>round_winner</span> <span class='op'>==</span> <span class='st'>"player_one"</span><span class='op'>)</span> <span class='va'>game_deck_player_1</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='va'>game_deck_player_1</span>,<span class='va'>draw_player1</span>,<span class='va'>draw_player2</span><span class='op'>)</span>
    
    <span class='kw'>if</span><span class='op'>(</span><span class='va'>round_winner</span> <span class='op'>==</span> <span class='st'>"player_two"</span><span class='op'>)</span> <span class='va'>game_deck_player_2</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='va'>game_deck_player_2</span>,<span class='va'>draw_player2</span>,<span class='va'>draw_player1</span><span class='op'>)</span>

    <span class='va'>loop</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/ifelse.html'>ifelse</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span><span class='op'>(</span><span class='va'>game_deck_player_1</span><span class='op'>)</span> <span class='op'>==</span> <span class='fl'>0</span> <span class='op'>|</span> <span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span><span class='op'>(</span><span class='va'>game_deck_player_2</span><span class='op'>)</span> <span class='op'>==</span> <span class='fl'>0</span>,<span class='fl'>0</span>,<span class='fl'>1</span><span class='op'>)</span>
    
  <span class='op'>}</span>
  
  <span class='kw'>if</span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/NULL.html'>is.null</a></span><span class='op'>(</span><span class='va'>game_winner</span><span class='op'>)</span><span class='op'>)</span><span class='op'>{</span>
    <span class='va'>game_winner</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/ifelse.html'>ifelse</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span><span class='op'>(</span><span class='va'>game_deck_player_1</span><span class='op'>)</span> <span class='op'>&gt;</span> <span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span><span class='op'>(</span><span class='va'>game_deck_player_2</span><span class='op'>)</span>, <span class='st'>"player_one"</span>, <span class='st'>"player_two"</span><span class='op'>)</span>
  <span class='op'>}</span>
  
  <span class='kw'><a href='https://rdrr.io/r/base/function.html'>return</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>game_winner <span class='op'>=</span> <span class='va'>game_winner</span>,
              player_1 <span class='op'>=</span> <span class='va'>game_deck_player_1</span>, 
              player_2 <span class='op'>=</span> <span class='va'>game_deck_player_2</span><span class='op'>)</span><span class='op'>)</span>
<span class='op'>}</span>

<span class='va'>x</span> <span class='op'>&lt;-</span> <span class='fu'>recursive_combat</span><span class='op'>(</span><span class='va'>player_1</span>,<span class='va'>player_2</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<pre><code>$game_winner
[1] &quot;player_one&quot;

$player_1
 [1] 18  5 47 38 49 21 34  1 45 33 32 23 39 36 27 16  2  6 43 40 42 24
[23] 10  9 35 20 11  3 41 17 29 13 28 25 50 26 37  7 46 22 15  8 44 31
[45] 14 12 48 19 30  4

$player_2
numeric(0)</code></pre>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='va'>x</span><span class='op'>$</span><span class='va'>player_1</span> <span class='op'>*</span> <span class='fu'><a href='https://rdrr.io/r/base/rev.html'>rev</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq_along</a></span><span class='op'>(</span><span class='va'>x</span><span class='op'>$</span><span class='va'>player_1</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<pre><code>[1] 33651</code></pre>
</div>
<div class="sourceCode" id="cb112"><pre class="sourceCode r distill-force-highlighting-css"><code class="sourceCode r"></code></pre></div>
<h2 id="day-23">Day 23</h2>
<p><a href="https://adventofcode.com/2020/day/23" class="uri">https://adventofcode.com/2020/day/23</a></p>
<p>Day twenty-three - Crab Cups!</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/message.html'>suppressPackageStartupMessages</a></span><span class='op'>(</span><span class='op'>{</span>
  <span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://tidyverse.tidyverse.org'>tidyverse</a></span><span class='op'>)</span>
  <span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://here.r-lib.org/'>here</a></span><span class='op'>)</span>
  <span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://github.com/tidyverse/glue'>glue</a></span><span class='op'>)</span>

  <span class='fu'>knitr</span><span class='fu'>::</span><span class='va'><a href='https://rdrr.io/pkg/knitr/man/opts_chunk.html'>opts_chunk</a></span><span class='op'>$</span><span class='fu'>set</span><span class='op'>(</span>echo <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>
<span class='op'>}</span><span class='op'>)</span>

  <span class='fu'><a href='https://rdrr.io/r/base/options.html'>options</a></span><span class='op'>(</span>scipen <span class='op'>=</span> <span class='fl'>9999999</span><span class='op'>)</span>
  <span class='fu'><a href='https://rdrr.io/r/base/options.html'>options</a></span><span class='op'>(</span>dplyr.summarise.inform <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<p>— Description —</p>
<p>— Data —</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>input_23</span> <span class='op'>&lt;-</span> <span class='st'>"496138527"</span>
</code></pre>
</div>
</div>
<p>— Cleaning —</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>start_order</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://stringr.tidyverse.org/reference/str_split.html'>str_split</a></span><span class='op'>(</span><span class='va'>input_23</span>,<span class='st'>""</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> <span class='va'>unlist</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> <span class='va'>as.numeric</span>
</code></pre>
</div>
</div>
<p>— Problem 1 —</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>p1</span> <span class='op'>&lt;-</span> <span class='va'>start_order</span>

<span class='kw'>for</span><span class='op'>(</span><span class='va'>i</span> <span class='kw'>in</span> <span class='fl'>1</span><span class='op'>:</span><span class='fl'>100</span><span class='op'>)</span><span class='op'>{</span>
  
  <span class='va'>current_cup</span> <span class='op'>&lt;-</span> <span class='va'>p1</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>]</span>
  
  <span class='va'>picked_up</span> <span class='op'>&lt;-</span> <span class='va'>p1</span><span class='op'>[</span><span class='fl'>2</span><span class='op'>:</span><span class='fl'>4</span><span class='op'>]</span>
  
  <span class='va'>other_cups</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/utils/head.html'>tail</a></span><span class='op'>(</span><span class='va'>p1</span>, <span class='op'>-</span><span class='fl'>4</span><span class='op'>)</span>
  
  <span class='kw'>if</span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/all.html'>all</a></span><span class='op'>(</span><span class='va'>current_cup</span> <span class='op'>&lt;</span> <span class='va'>other_cups</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>{</span>
    
    <span class='va'>destination_cup</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/Extremes.html'>max</a></span><span class='op'>(</span><span class='va'>other_cups</span><span class='op'>)</span>
    
  <span class='op'>}</span> <span class='kw'>else</span> <span class='op'>{</span>
    
    <span class='va'>destination_cup</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/Extremes.html'>max</a></span><span class='op'>(</span><span class='va'>other_cups</span><span class='op'>[</span><span class='op'>(</span><span class='va'>current_cup</span> <span class='op'>-</span> <span class='va'>other_cups</span><span class='op'>)</span> <span class='op'>&gt;</span> <span class='fl'>0</span><span class='op'>]</span><span class='op'>)</span>
    
  <span class='op'>}</span>
  <span class='va'>d_loc</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/which.html'>which</a></span><span class='op'>(</span><span class='va'>other_cups</span> <span class='op'>==</span> <span class='va'>destination_cup</span><span class='op'>)</span>

  <span class='va'>p1</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span>
    <span class='fu'><a href='https://rdrr.io/r/utils/head.html'>head</a></span><span class='op'>(</span><span class='va'>other_cups</span>,<span class='va'>d_loc</span><span class='op'>)</span>,
    <span class='va'>picked_up</span>,
    <span class='fu'><a href='https://rdrr.io/r/utils/head.html'>tail</a></span><span class='op'>(</span><span class='va'>other_cups</span>,<span class='op'>-</span><span class='va'>d_loc</span><span class='op'>)</span>,
    <span class='va'>current_cup</span>
    <span class='op'>)</span>
    
<span class='op'>}</span>

<span class='va'>one_loc</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/which.html'>which</a></span><span class='op'>(</span><span class='va'>p1</span> <span class='op'>==</span> <span class='fl'>1</span><span class='op'>)</span>

<span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/utils/head.html'>tail</a></span><span class='op'>(</span><span class='va'>p1</span>,<span class='op'>-</span><span class='va'>one_loc</span><span class='op'>)</span>,<span class='fu'><a href='https://rdrr.io/r/utils/head.html'>head</a></span><span class='op'>(</span><span class='va'>p1</span>,<span class='va'>one_loc</span><span class='op'>-</span><span class='fl'>1</span><span class='op'>)</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> <span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste</a></span><span class='op'>(</span>collapse <span class='op'>=</span> <span class='st'>""</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<pre><code>[1] &quot;69425837&quot;</code></pre>
</div>
<p>— Problem 2 —</p>
<p>Trying the naive solution first:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>p2</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='va'>start_order</span>,<span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq.int</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/Extremes.html'>max</a></span><span class='op'>(</span><span class='va'>start_order</span><span class='op'>)</span>,<span class='fl'>1000000</span><span class='op'>)</span><span class='op'>)</span>

<span class='kw'>for</span><span class='op'>(</span><span class='va'>i</span> <span class='kw'>in</span> <span class='fl'>1</span><span class='op'>:</span><span class='fl'>1000000</span><span class='op'>)</span><span class='op'>{</span>
  
  <span class='va'>current_cup</span> <span class='op'>&lt;-</span> <span class='va'>p2</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>]</span>
  
  <span class='va'>picked_up</span> <span class='op'>&lt;-</span> <span class='va'>p2</span><span class='op'>[</span><span class='fl'>2</span><span class='op'>:</span><span class='fl'>4</span><span class='op'>]</span>
  
  <span class='va'>other_cups</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/utils/head.html'>tail</a></span><span class='op'>(</span><span class='va'>p2</span>, <span class='op'>-</span><span class='fl'>4</span><span class='op'>)</span>
  
  <span class='kw'>if</span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/all.html'>all</a></span><span class='op'>(</span><span class='va'>current_cup</span> <span class='op'>&lt;</span> <span class='va'>other_cups</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>{</span>
    
    <span class='va'>destination_cup</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/Extremes.html'>max</a></span><span class='op'>(</span><span class='va'>other_cups</span><span class='op'>)</span> 
    
  <span class='op'>}</span> <span class='kw'>else</span> <span class='op'>{</span>
    
    <span class='va'>destination_cup</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/Extremes.html'>max</a></span><span class='op'>(</span><span class='va'>other_cups</span><span class='op'>[</span><span class='op'>(</span><span class='va'>current_cup</span> <span class='op'>-</span> <span class='va'>other_cups</span><span class='op'>)</span> <span class='op'>&gt;</span> <span class='fl'>0</span><span class='op'>]</span><span class='op'>)</span>
    
  <span class='op'>}</span>
  <span class='va'>d_loc</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/which.html'>which</a></span><span class='op'>(</span><span class='va'>other_cups</span> <span class='op'>==</span> <span class='va'>destination_cup</span><span class='op'>)</span>

  <span class='va'>p2</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span>
    <span class='fu'><a href='https://rdrr.io/r/utils/head.html'>head</a></span><span class='op'>(</span><span class='va'>other_cups</span>,<span class='va'>d_loc</span><span class='op'>)</span>,
    <span class='va'>picked_up</span>,
    <span class='fu'><a href='https://rdrr.io/r/utils/head.html'>tail</a></span><span class='op'>(</span><span class='va'>other_cups</span>,<span class='op'>-</span><span class='va'>d_loc</span><span class='op'>)</span>,
    <span class='va'>current_cup</span>
    <span class='op'>)</span>
<span class='op'>}</span>

<span class='va'>one_loc</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/which.html'>which</a></span><span class='op'>(</span><span class='va'>p2</span> <span class='op'>==</span> <span class='fl'>1</span><span class='op'>)</span>

<span class='va'>p2</span><span class='op'>[</span><span class='va'>one_loc</span> <span class='op'>+</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>,<span class='fl'>2</span><span class='op'>)</span><span class='op'>]</span>
</code></pre>
</div>
</div>
<p>Killing it for being too slow.</p>
<p>Attempt 2: trying to store the location of the next variable for each variable (as suggested by other languages’ linked lists)</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>p2</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='va'>start_order</span>,<span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq.int</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/Extremes.html'>max</a></span><span class='op'>(</span><span class='va'>start_order</span><span class='op'>)</span><span class='op'>+</span><span class='fl'>1</span>,<span class='fl'>1000000</span><span class='op'>)</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> <span class='fu'><a href='https://rdrr.io/r/base/integer.html'>as.integer</a></span><span class='op'>(</span><span class='op'>)</span>

<span class='va'>next_cups</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='va'>p2</span><span class='op'>[</span><span class='op'>-</span><span class='fl'>1</span><span class='op'>]</span>,<span class='va'>p2</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>]</span><span class='op'>)</span>
<span class='va'>cup_directory</span> <span class='op'>&lt;-</span> <span class='va'>next_cups</span><span class='op'>[</span><span class='fu'><a href='https://rdrr.io/r/base/order.html'>order</a></span><span class='op'>(</span><span class='va'>p2</span><span class='op'>)</span><span class='op'>]</span>

<span class='va'>current_cup</span> <span class='op'>&lt;-</span> <span class='va'>p2</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>]</span>

<span class='kw'>for</span> <span class='op'>(</span><span class='va'>i</span> <span class='kw'>in</span> <span class='fl'>1</span><span class='op'>:</span><span class='fl'>10000000</span><span class='op'>)</span> <span class='op'>{</span>
  
  <span class='va'>pickup_1</span> <span class='op'>&lt;-</span> <span class='va'>cup_directory</span><span class='op'>[</span><span class='va'>current_cup</span><span class='op'>]</span>
  <span class='va'>pickup_2</span> <span class='op'>&lt;-</span> <span class='va'>cup_directory</span><span class='op'>[</span><span class='va'>pickup_1</span><span class='op'>]</span>
  <span class='va'>pickup_3</span> <span class='op'>&lt;-</span> <span class='va'>cup_directory</span><span class='op'>[</span><span class='va'>pickup_2</span><span class='op'>]</span>
  
  <span class='va'>destination_cup</span> <span class='op'>&lt;-</span> <span class='va'>current_cup</span> <span class='op'>-</span> <span class='fl'>1</span><span class='op'>:</span><span class='fl'>4</span>
  
  <span class='va'>destination_cup</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/ifelse.html'>ifelse</a></span><span class='op'>(</span>
    <span class='va'>destination_cup</span> <span class='op'>&lt;=</span><span class='fl'>0</span>, 
    <span class='fu'><a href='https://rdrr.io/r/base/Extremes.html'>max</a></span><span class='op'>(</span><span class='va'>cup_directory</span><span class='op'>)</span> <span class='op'>+</span> <span class='va'>destination_cup</span>, 
    <span class='va'>destination_cup</span><span class='op'>)</span>
  
  <span class='va'>destination_cup</span> <span class='op'>&lt;-</span> <span class='va'>destination_cup</span><span class='op'>[</span><span class='op'>!</span><span class='va'>destination_cup</span> <span class='op'><a href='https://rdrr.io/r/base/match.html'>%in%</a></span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='va'>pickup_1</span>,<span class='va'>pickup_2</span>,<span class='va'>pickup_3</span><span class='op'>)</span><span class='op'>]</span>
  
  <span class='va'>destination_cup</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/utils/head.html'>head</a></span><span class='op'>(</span><span class='va'>destination_cup</span>, <span class='fl'>1</span><span class='op'>)</span>
  
  <span class='va'>cup_directory</span><span class='op'>[</span><span class='va'>current_cup</span><span class='op'>]</span> <span class='op'>&lt;-</span> <span class='va'>cup_directory</span><span class='op'>[</span><span class='va'>pickup_3</span><span class='op'>]</span>
  <span class='co'># current now points to where third cup was pointing, removing three cups from loop</span>
  
  <span class='va'>cup_directory</span><span class='op'>[</span><span class='va'>pickup_3</span><span class='op'>]</span> <span class='op'>&lt;-</span> <span class='va'>cup_directory</span><span class='op'>[</span><span class='va'>destination_cup</span><span class='op'>]</span>
  <span class='co'># third now points to where destination cup was pointing</span>
  
  <span class='va'>cup_directory</span><span class='op'>[</span><span class='va'>destination_cup</span><span class='op'>]</span> <span class='op'>&lt;-</span> <span class='va'>pickup_1</span>
  <span class='co'># destination cup now points at the first cup in the pickup</span>
  
  <span class='va'>current_cup</span> <span class='op'>&lt;-</span> <span class='va'>cup_directory</span><span class='op'>[</span><span class='va'>current_cup</span><span class='op'>]</span>
  <span class='co'># move pointer to where the current cup is pointing</span>
<span class='op'>}</span>

<span class='va'>x1</span> <span class='op'>&lt;-</span> <span class='va'>cup_directory</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>]</span>
<span class='va'>x2</span> <span class='op'>&lt;-</span> <span class='va'>cup_directory</span><span class='op'>[</span><span class='va'>x1</span><span class='op'>]</span>

<span class='fu'><a href='https://rdrr.io/r/base/prod.html'>prod</a></span><span class='op'>(</span><span class='va'>x1</span>,<span class='va'>x2</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<pre><code>[1] 218882971435</code></pre>
</div>
<p>About three minutes to run the loop, so not bad!</p>
<div class="sourceCode" id="cb115"><pre class="sourceCode r distill-force-highlighting-css"><code class="sourceCode r"></code></pre></div>
<h2 id="day-24">Day 24</h2>
<p><a href="https://adventofcode.com/2020/day/24" class="uri">https://adventofcode.com/2020/day/24</a></p>
<p>Day twenty-four - Lobby Layout!</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/message.html'>suppressPackageStartupMessages</a></span><span class='op'>(</span><span class='op'>{</span>
  <span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://tidyverse.tidyverse.org'>tidyverse</a></span><span class='op'>)</span>
  <span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://here.r-lib.org/'>here</a></span><span class='op'>)</span>
  <span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://github.com/tidyverse/glue'>glue</a></span><span class='op'>)</span>

  <span class='fu'>knitr</span><span class='fu'>::</span><span class='va'><a href='https://rdrr.io/pkg/knitr/man/opts_chunk.html'>opts_chunk</a></span><span class='op'>$</span><span class='fu'>set</span><span class='op'>(</span>echo <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>
  <span class='fu'><a href='https://rdrr.io/r/base/options.html'>options</a></span><span class='op'>(</span>scipen <span class='op'>=</span> <span class='fl'>9999999</span><span class='op'>)</span>
  <span class='fu'><a href='https://rdrr.io/r/base/options.html'>options</a></span><span class='op'>(</span>dplyr.summarise.inform <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span>
<span class='op'>}</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<p>— Data —</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>input_24</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://readr.tidyverse.org/reference/read_lines.html'>read_lines</a></span><span class='op'>(</span><span class='fu'><a href='https://here.r-lib.org//reference/here.html'>here</a></span><span class='op'>(</span><span class='st'>"2020"</span>, <span class='st'>"day-24.txt"</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>input_24_e</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://readr.tidyverse.org/reference/read_lines.html'>read_lines</a></span><span class='op'>(</span><span class='fu'><a href='https://here.r-lib.org//reference/here.html'>here</a></span><span class='op'>(</span><span class='st'>"2020"</span>, <span class='st'>"day-24-e.txt"</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<p>— Cleaning —</p>
Hex grids coordinates c/o <a href="https://www.redblobgames.com/grids/hexagons/" class="uri">https://www.redblobgames.com/grids/hexagons/</a>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>directions_e</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://tibble.tidyverse.org/reference/tibble.html'>tibble</a></span><span class='op'>(</span>i <span class='op'>=</span> <span class='va'>input_24_e</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>i <span class='op'>=</span> <span class='fu'><a href='https://stringr.tidyverse.org/reference/str_extract.html'>str_extract_all</a></span><span class='op'>(</span><span class='va'>i</span>,<span class='st'>"se|sw|nw|ne|e|w"</span><span class='op'>)</span>,
         id <span class='op'>=</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/ranking.html'>row_number</a></span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
  <span class='fu'><a href='https://tidyr.tidyverse.org/reference/hoist.html'>unnest_longer</a></span><span class='op'>(</span><span class='va'>i</span><span class='op'>)</span>

<span class='va'>directions</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://tibble.tidyverse.org/reference/tibble.html'>tibble</a></span><span class='op'>(</span>i <span class='op'>=</span> <span class='va'>input_24</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>i <span class='op'>=</span> <span class='fu'><a href='https://stringr.tidyverse.org/reference/str_extract.html'>str_extract_all</a></span><span class='op'>(</span><span class='va'>i</span>,<span class='st'>"se|sw|nw|ne|e|w"</span><span class='op'>)</span>,
         id <span class='op'>=</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/ranking.html'>row_number</a></span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
  <span class='fu'><a href='https://tidyr.tidyverse.org/reference/hoist.html'>unnest_longer</a></span><span class='op'>(</span><span class='va'>i</span><span class='op'>)</span>

<span class='va'>hex_coordinates</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>e <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>,<span class='op'>-</span><span class='fl'>1</span>,<span class='fl'>0</span><span class='op'>)</span>,
                        se <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>,<span class='op'>-</span><span class='fl'>1</span>,<span class='fl'>1</span><span class='op'>)</span>,
                        sw <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='op'>-</span><span class='fl'>1</span>,<span class='fl'>0</span>,<span class='fl'>1</span><span class='op'>)</span>,
                        w <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='op'>-</span><span class='fl'>1</span>,<span class='fl'>1</span>,<span class='fl'>0</span><span class='op'>)</span>,
                        nw <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>,<span class='fl'>1</span>,<span class='op'>-</span><span class='fl'>1</span><span class='op'>)</span>,
                        ne <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>,<span class='fl'>0</span>,<span class='op'>-</span><span class='fl'>1</span><span class='op'>)</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
  <span class='fu'><a href='https://tibble.tidyverse.org/reference/enframe.html'>enframe</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
  <span class='fu'><a href='https://tidyr.tidyverse.org/reference/hoist.html'>unnest_wider</a></span><span class='op'>(</span><span class='va'>value</span>,names_sep <span class='op'>=</span> <span class='st'>""</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/rename.html'>rename</a></span><span class='op'>(</span>dx <span class='op'>=</span> <span class='va'>value1</span>, dy <span class='op'>=</span> <span class='va'>value2</span>, dz <span class='op'>=</span> <span class='va'>value3</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<p>— Problem 1 —</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>tile_locations</span> <span class='op'>&lt;-</span> <span class='va'>directions</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate-joins.html'>left_join</a></span><span class='op'>(</span><span class='va'>hex_coordinates</span>, by <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"i"</span> <span class='op'>=</span> <span class='st'>"name"</span><span class='op'>)</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/group_by.html'>group_by</a></span><span class='op'>(</span><span class='va'>id</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/summarise.html'>summarise</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='va'>dx</span><span class='op'>)</span>,
            y <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='va'>dy</span><span class='op'>)</span>,
            z <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='va'>dz</span><span class='op'>)</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/group_by.html'>group_by</a></span><span class='op'>(</span><span class='va'>x</span>,<span class='va'>y</span>,<span class='va'>z</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/summarise.html'>summarise</a></span><span class='op'>(</span>n <span class='op'>=</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/context.html'>n</a></span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/group_by.html'>ungroup</a></span><span class='op'>(</span><span class='op'>)</span>

<span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='va'>tile_locations</span><span class='op'>$</span><span class='va'>n</span> <span class='op'>==</span> <span class='fl'>1</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<pre><code>[1] 528</code></pre>
</div>
<p>— Problem 2 — Another gd game of life problem?! FFS. Assuming that prev problem is day zero.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>current_state</span> <span class='op'>&lt;-</span> <span class='va'>tile_locations</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>colour <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/ifelse.html'>ifelse</a></span><span class='op'>(</span><span class='va'>n</span> <span class='op'>==</span> <span class='fl'>1</span>, <span class='st'>"black"</span>, <span class='st'>"white"</span><span class='op'>)</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>colour</span> <span class='op'>==</span> <span class='st'>"black"</span><span class='op'>)</span>

<span class='va'>get_tile</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>x</span>,<span class='va'>y</span>,<span class='va'>z</span>,<span class='va'>day</span><span class='op'>)</span><span class='op'>{</span>
  <span class='va'>current_state</span><span class='op'>$</span><span class='va'>colour</span><span class='op'>[</span><span class='va'>current_state</span><span class='op'>$</span><span class='va'>x</span> <span class='op'>==</span> <span class='va'>x</span> <span class='op'>&amp;</span> <span class='va'>current_state</span><span class='op'>$</span><span class='va'>y</span> <span class='op'>==</span> <span class='va'>y</span> <span class='op'>&amp;</span> <span class='va'>current_state</span><span class='op'>$</span><span class='va'>z</span> <span class='op'>==</span> <span class='va'>z</span><span class='op'>]</span>
<span class='op'>}</span>

<span class='va'>get_tile</span> <span class='op'>&lt;-</span> <span class='fu'>memoise</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/memoise/man/memoise.html'>memoise</a></span><span class='op'>(</span><span class='va'>get_tile</span><span class='op'>)</span>

<span class='va'>get_adjacent_tiles</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>x</span>,<span class='va'>y</span>,<span class='va'>z</span>, <span class='va'>day</span><span class='op'>)</span><span class='op'>{</span>
  
  <span class='va'>nx</span> <span class='op'>&lt;-</span> <span class='va'>hex_coordinates</span><span class='op'>$</span><span class='va'>dx</span> <span class='op'>+</span> <span class='va'>x</span>
  <span class='va'>ny</span> <span class='op'>&lt;-</span> <span class='va'>hex_coordinates</span><span class='op'>$</span><span class='va'>dy</span> <span class='op'>+</span> <span class='va'>y</span>
  <span class='va'>nz</span> <span class='op'>&lt;-</span> <span class='va'>hex_coordinates</span><span class='op'>$</span><span class='va'>dz</span> <span class='op'>+</span> <span class='va'>z</span>
  
  <span class='va'>neighbours</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://purrr.tidyverse.org/reference/map2.html'>pmap</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span><span class='va'>nx</span>,<span class='va'>ny</span>,<span class='va'>nz</span><span class='op'>)</span>,<span class='va'>get_tile</span>,<span class='va'>day</span><span class='op'>)</span>
  
  <span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/unlist.html'>unlist</a></span><span class='op'>(</span><span class='va'>neighbours</span><span class='op'>)</span> <span class='op'>==</span> <span class='st'>"black"</span>, na.rm <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>
  
<span class='op'>}</span>

<span class='kw'>for</span><span class='op'>(</span><span class='va'>day</span> <span class='kw'>in</span> <span class='fl'>1</span><span class='op'>:</span><span class='fl'>100</span><span class='op'>)</span><span class='op'>{</span>
  
  <span class='va'>grid_range</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/range.html'>range</a></span><span class='op'>(</span><span class='va'>current_state</span><span class='op'>[</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>'x'</span>,<span class='st'>'y'</span>,<span class='st'>'z'</span><span class='op'>)</span><span class='op'>]</span><span class='op'>)</span>
  
  <span class='va'>search_grid</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq.int</a></span><span class='op'>(</span>from <span class='op'>=</span> <span class='va'>grid_range</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>]</span><span class='op'>-</span><span class='fl'>1</span>, to <span class='op'>=</span> <span class='va'>grid_range</span><span class='op'>[</span><span class='fl'>2</span><span class='op'>]</span><span class='op'>+</span><span class='fl'>1</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
    <span class='fu'><a href='https://tidyr.tidyverse.org/reference/expand.html'>crossing</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>.</span>, y <span class='op'>=</span> <span class='va'>.</span>, z <span class='op'>=</span> <span class='va'>.</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
    <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='op'>(</span><span class='va'>x</span> <span class='op'>+</span> <span class='va'>y</span> <span class='op'>+</span> <span class='va'>z</span><span class='op'>)</span> <span class='op'>==</span> <span class='fl'>0</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span>
    <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate-joins.html'>left_join</a></span><span class='op'>(</span>
      <span class='va'>current_state</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/select.html'>select</a></span><span class='op'>(</span><span class='va'>x</span>,<span class='va'>y</span>,<span class='va'>z</span>,<span class='va'>colour</span><span class='op'>)</span>,
      by <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"x"</span>,<span class='st'>"y"</span>,<span class='st'>"z"</span><span class='op'>)</span>
    <span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
    <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>colour <span class='op'>=</span> <span class='fu'><a href='https://tidyr.tidyverse.org/reference/replace_na.html'>replace_na</a></span><span class='op'>(</span><span class='va'>colour</span>,<span class='st'>"white"</span><span class='op'>)</span>,
           neighbours <span class='op'>=</span> <span class='fu'><a href='https://purrr.tidyverse.org/reference/map2.html'>pmap_dbl</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span><span class='va'>x</span>,<span class='va'>y</span>,<span class='va'>z</span><span class='op'>)</span>, <span class='va'>get_adjacent_tiles</span>, <span class='va'>day</span><span class='op'>)</span>,
           new_colour <span class='op'>=</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/case_when.html'>case_when</a></span><span class='op'>(</span><span class='va'>colour</span> <span class='op'>==</span> <span class='st'>"black"</span> <span class='op'>&amp;</span> <span class='op'>(</span><span class='va'>neighbours</span> <span class='op'>==</span> <span class='fl'>0</span> <span class='op'>|</span> <span class='va'>neighbours</span> <span class='op'>&gt;</span> <span class='fl'>2</span><span class='op'>)</span> <span class='op'>~</span> <span class='st'>"white"</span>,
                                  <span class='va'>colour</span> <span class='op'>==</span> <span class='st'>"white"</span> <span class='op'>&amp;</span> <span class='op'>(</span><span class='va'>neighbours</span> <span class='op'>==</span> <span class='fl'>2</span><span class='op'>)</span> <span class='op'>~</span> <span class='st'>"black"</span>,
                                  <span class='cn'>TRUE</span> <span class='op'>~</span> <span class='va'>colour</span><span class='op'>)</span><span class='op'>)</span>
  
  <span class='va'>current_state</span> <span class='op'>&lt;-</span> <span class='va'>search_grid</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
    <span class='fu'><a href='https://dplyr.tidyverse.org/reference/select.html'>select</a></span><span class='op'>(</span><span class='va'>x</span>,<span class='va'>y</span>,<span class='va'>z</span>,colour <span class='op'>=</span> <span class='va'>new_colour</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
    <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>colour</span> <span class='op'>==</span> <span class='st'>"black"</span><span class='op'>)</span>
  
  <span class='kw'>if</span><span class='op'>(</span><span class='va'>day</span> <span class='op'><a href='https://rdrr.io/r/base/Arithmetic.html'>%%</a></span> <span class='fl'>10</span> <span class='op'>==</span> <span class='fl'>0</span><span class='op'>)</span> <span class='fu'><a href='https://rdrr.io/r/base/message.html'>message</a></span><span class='op'>(</span><span class='va'>day</span><span class='op'>)</span>
  
<span class='op'>}</span>

<span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>nrow</a></span><span class='op'>(</span><span class='va'>current_state</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<pre><code>[1] 4200</code></pre>
</div>
<div class="sourceCode" id="cb118"><pre class="sourceCode r distill-force-highlighting-css"><code class="sourceCode r"></code></pre></div>
<h2 id="day-25">Day 25</h2>
<p><a href="https://adventofcode.com/2020/day/25" class="uri">https://adventofcode.com/2020/day/25</a></p>
<p>Day twenty-five - Combo Breaker!</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/message.html'>suppressPackageStartupMessages</a></span><span class='op'>(</span><span class='op'>{</span>
  <span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://tidyverse.tidyverse.org'>tidyverse</a></span><span class='op'>)</span>
  <span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://here.r-lib.org/'>here</a></span><span class='op'>)</span>
  <span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://github.com/tidyverse/glue'>glue</a></span><span class='op'>)</span>

  <span class='fu'>knitr</span><span class='fu'>::</span><span class='va'><a href='https://rdrr.io/pkg/knitr/man/opts_chunk.html'>opts_chunk</a></span><span class='op'>$</span><span class='fu'>set</span><span class='op'>(</span>echo <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>
  <span class='fu'><a href='https://rdrr.io/r/base/options.html'>options</a></span><span class='op'>(</span>scipen <span class='op'>=</span> <span class='fl'>9999999</span><span class='op'>)</span>
  <span class='fu'><a href='https://rdrr.io/r/base/options.html'>options</a></span><span class='op'>(</span>dplyr.summarise.inform <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span>
<span class='op'>}</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<p>— Data —</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>input_25</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>2069194</span>,<span class='fl'>16426071</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<p>— Problem 1 —</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>find_loops</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>input</span><span class='op'>)</span><span class='op'>{</span>
  
  <span class='va'>goal_keys</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/numeric.html'>numeric</a></span><span class='op'>(</span><span class='fl'>2</span><span class='op'>)</span>
  <span class='va'>v</span> <span class='op'>&lt;-</span> <span class='fl'>1</span>
  <span class='va'>i</span> <span class='op'>&lt;-</span> <span class='fl'>0</span>
  
  <span class='kw'>while</span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/any.html'>any</a></span><span class='op'>(</span><span class='va'>goal_keys</span> <span class='op'><a href='https://rdrr.io/r/base/match.html'>%in%</a></span> <span class='fl'>0</span><span class='op'>)</span><span class='op'>)</span><span class='op'>{</span>
   <span class='va'>i</span> <span class='op'>&lt;-</span> <span class='va'>i</span><span class='op'>+</span><span class='fl'>1</span>
   <span class='va'>v</span> <span class='op'>&lt;-</span> <span class='op'>(</span><span class='va'>v</span> <span class='op'>*</span> <span class='fl'>7</span><span class='op'>)</span> <span class='op'><a href='https://rdrr.io/r/base/Arithmetic.html'>%%</a></span> <span class='fl'>20201227</span>
   
   <span class='kw'>if</span><span class='op'>(</span><span class='va'>v</span> <span class='op'>==</span> <span class='va'>input</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>]</span><span class='op'>)</span> <span class='va'>goal_keys</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>]</span> <span class='op'>&lt;-</span> <span class='va'>i</span>
   <span class='kw'>if</span><span class='op'>(</span><span class='va'>v</span> <span class='op'>==</span> <span class='va'>input</span><span class='op'>[</span><span class='fl'>2</span><span class='op'>]</span><span class='op'>)</span> <span class='va'>goal_keys</span><span class='op'>[</span><span class='fl'>2</span><span class='op'>]</span> <span class='op'>&lt;-</span> <span class='va'>i</span>
  <span class='op'>}</span>
  
  <span class='kw'><a href='https://rdrr.io/r/base/function.html'>return</a></span><span class='op'>(</span><span class='va'>goal_keys</span><span class='op'>)</span>
<span class='op'>}</span>

<span class='va'>loop_sizes</span> <span class='op'>&lt;-</span> <span class='fu'>find_loops</span><span class='op'>(</span><span class='va'>input_25</span><span class='op'>)</span>

<span class='va'>encrypt_key</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>public_key</span>,<span class='va'>loop_size</span><span class='op'>)</span><span class='op'>{</span>
  
  <span class='va'>v</span> <span class='op'>&lt;-</span> <span class='fl'>1</span>
  
  <span class='kw'>for</span><span class='op'>(</span><span class='va'>i</span> <span class='kw'>in</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq_len</a></span><span class='op'>(</span><span class='va'>loop_size</span><span class='op'>)</span><span class='op'>)</span> <span class='va'>v</span> <span class='op'>&lt;-</span> <span class='op'>(</span><span class='va'>v</span> <span class='op'>*</span> <span class='va'>public_key</span><span class='op'>)</span> <span class='op'><a href='https://rdrr.io/r/base/Arithmetic.html'>%%</a></span> <span class='fl'>20201227</span>
  
  <span class='va'>v</span>
<span class='op'>}</span>

<span class='fu'>encrypt_key</span><span class='op'>(</span><span class='va'>input_25</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>]</span>,<span class='va'>loop_sizes</span><span class='op'>[</span><span class='fl'>2</span><span class='op'>]</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<pre><code>[1] 11576351</code></pre>
</div>
<div class="sourceCode" id="cb120"><pre class="sourceCode r distill-force-highlighting-css"><code class="sourceCode r"></code></pre></div>
<h2 id="day-26">Day 26</h2>
<p><a href="https://adventofcode.com/2020/day/26" class="uri">https://adventofcode.com/2020/day/26</a></p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/message.html'>suppressPackageStartupMessages</a></span><span class='op'>(</span><span class='op'>{</span>
  <span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://tidyverse.tidyverse.org'>tidyverse</a></span><span class='op'>)</span>
  <span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://httr.r-lib.org/'>httr</a></span><span class='op'>)</span>
<span class='op'>}</span><span class='op'>)</span>

<span class='fu'><a href='https://rdrr.io/r/base/options.html'>options</a></span><span class='op'>(</span>dplyr.summarise.inform <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span>
<span class='fu'>knitr</span><span class='fu'>::</span><span class='va'><a href='https://rdrr.io/pkg/knitr/man/opts_chunk.html'>opts_chunk</a></span><span class='op'>$</span><span class='fu'>set</span><span class='op'>(</span>echo <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>stars</span> <span class='op'>&lt;-</span> <span class='fu'>httr</span><span class='fu'>::</span><span class='fu'><a href='https://httr.r-lib.org/reference/GET.html'>GET</a></span><span class='op'>(</span><span class='st'>"https://adventofcode.com/2020/leaderboard/private/view/1032765.json"</span>,
                   <span class='fu'>httr</span><span class='fu'>::</span><span class='fu'><a href='https://httr.r-lib.org/reference/set_cookies.html'>set_cookies</a></span><span class='op'>(</span>session <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/Sys.getenv.html'>Sys.getenv</a></span><span class='op'>(</span><span class='st'>"session_cookie"</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
  <span class='fu'><a href='https://httr.r-lib.org/reference/content.html'>content</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
  <span class='fu'><a href='https://tibble.tidyverse.org/reference/as_tibble.html'>as_tibble</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
  <span class='fu'><a href='https://tidyr.tidyverse.org/reference/hoist.html'>hoist</a></span><span class='op'>(</span><span class='st'>"members"</span>,
        <span class='st'>"user_name"</span><span class='op'>=</span><span class='st'>"name"</span>,
        <span class='st'>"user_id"</span><span class='op'>=</span><span class='st'>"id"</span>,
        <span class='st'>"aoc_score"</span><span class='op'>=</span><span class='st'>"local_score"</span>,
        <span class='st'>"completed_stars"</span><span class='op'>=</span><span class='st'>"completion_day_level"</span>,
        <span class='st'>"total_stars"</span> <span class='op'>=</span> <span class='st'>"stars"</span>
        <span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
  <span class='fu'><a href='https://tidyr.tidyverse.org/reference/hoist.html'>unnest_longer</a></span><span class='op'>(</span><span class='st'>'completed_stars'</span>,indices_to <span class='op'>=</span> <span class='st'>"day"</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
  <span class='fu'><a href='https://tidyr.tidyverse.org/reference/hoist.html'>unnest_longer</a></span><span class='op'>(</span><span class='st'>"completed_stars"</span>,indices_to <span class='op'>=</span> <span class='st'>"star"</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
  <span class='fu'><a href='https://tidyr.tidyverse.org/reference/hoist.html'>unnest_longer</a></span><span class='op'>(</span><span class='st'>"completed_stars"</span>,indices_include <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/select.html'>select</a></span><span class='op'>(</span><span class='st'>"user_name"</span>,<span class='st'>"user_id"</span>,<span class='st'>"aoc_score"</span>,<span class='st'>"total_stars"</span>,<span class='st'>"day"</span>,<span class='st'>"star"</span>,<span class='st'>"timestamp"</span><span class='op'>=</span><span class='st'>"completed_stars"</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='op'>!</span><span class='fu'><a href='https://rdrr.io/r/base/NA.html'>is.na</a></span><span class='op'>(</span><span class='va'>star</span><span class='op'>)</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
  <span class='fu'><a href='https://tidyr.tidyverse.org/reference/pivot_wider.html'>pivot_wider</a></span><span class='op'>(</span>names_from <span class='op'>=</span> <span class='va'>star</span>, values_from <span class='op'>=</span> <span class='va'>timestamp</span>, names_glue <span class='op'>=</span> <span class='st'>"star{star}_ts"</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate_all.html'>mutate_at</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"star1_ts"</span>,<span class='st'>"star2_ts"</span><span class='op'>)</span>,<span class='op'>~</span> <span class='fu'><a href='https://rdrr.io/r/base/numeric.html'>as.numeric</a></span><span class='op'>(</span><span class='va'>.x</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> <span class='fu'>lubridate</span><span class='fu'>::</span><span class='fu'><a href='https://lubridate.tidyverse.org/reference/as_date.html'>as_datetime</a></span><span class='op'>(</span>tz <span class='op'>=</span> <span class='st'>"America/Toronto"</span><span class='op'>)</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>time_to_star2 <span class='op'>=</span> <span class='op'>(</span><span class='va'>star2_ts</span><span class='op'>-</span><span class='va'>star1_ts</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> <span class='fu'><a href='https://rdrr.io/r/base/Round.html'>round</a></span><span class='op'>(</span><span class='fl'>1</span><span class='op'>)</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/arrange.html'>arrange</a></span><span class='op'>(</span><span class='fu'><a href='https://dplyr.tidyverse.org/reference/desc.html'>desc</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/numeric.html'>as.numeric</a></span><span class='op'>(</span><span class='va'>day</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/select.html'>select</a></span><span class='op'>(</span><span class='va'>user_name</span>,<span class='va'>total_stars</span>,<span class='va'>aoc_score</span>,<span class='va'>day</span>,<span class='va'>star1_ts</span>,<span class='va'>star2_ts</span>,<span class='fu'><a href='https://tidyselect.r-lib.org/reference/everything.html'>everything</a></span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span>

<span class='va'>stars</span>
</code></pre>
</div>
<pre><code># A tibble: 735 x 8
   user_name       total_stars aoc_score day   star1_ts           
   &lt;chr&gt;                 &lt;int&gt;     &lt;int&gt; &lt;chr&gt; &lt;dttm&gt;             
 1 trang1618                50      5442 25    2020-12-25 01:00:32
 2 Farhan Reynaldo          50      5466 25    2020-12-25 04:48:36
 3 @_TanHo                  50      6040 25    2020-12-25 08:29:27
 4 @_mnar99                 44      4767 25    2020-12-25 15:55:09
 5 Colin Rundel             50      5953 25    2020-12-25 04:45:26
 6 @ClareHorscroft          50      6130 25    2020-12-25 04:14:47
 7 David Robinson           47      5548 25    2020-12-27 13:37:13
 8 Nathan Moore             50      5691 25    2020-12-26 06:13:33
 9 Tom Jemmett              50      5770 25    2020-12-30 16:41:27
10 Darrin Speegle           50      5839 25    2020-12-25 00:24:22
# ... with 725 more rows, and 3 more variables: star2_ts &lt;dttm&gt;,
#   user_id &lt;chr&gt;, time_to_star2 &lt;drtn&gt;</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>leaderboard</span> <span class='op'>&lt;-</span> <span class='va'>stars</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/group_by.html'>group_by</a></span><span class='op'>(</span><span class='va'>user_name</span>,<span class='va'>user_id</span>,<span class='va'>aoc_score</span>,<span class='va'>total_stars</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/summarise.html'>summarise</a></span><span class='op'>(</span>
    median_star2 <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/stats/median.html'>median</a></span><span class='op'>(</span><span class='va'>time_to_star2</span>,na.rm <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> <span class='fu'>`units&lt;-`</span><span class='op'>(</span><span class='st'>"mins"</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span>  <span class='fu'><a href='https://rdrr.io/r/base/Round.html'>round</a></span><span class='op'>(</span><span class='fl'>1</span><span class='op'>)</span>,
    mean_star2 <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>time_to_star2</span>,na.rm <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> <span class='fu'>`units&lt;-`</span><span class='op'>(</span><span class='st'>"mins"</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> <span class='fu'><a href='https://rdrr.io/r/base/Round.html'>round</a></span><span class='op'>(</span><span class='fl'>1</span><span class='op'>)</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/group_by.html'>ungroup</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/arrange.html'>arrange</a></span><span class='op'>(</span><span class='fu'><a href='https://dplyr.tidyverse.org/reference/desc.html'>desc</a></span><span class='op'>(</span><span class='va'>total_stars</span><span class='op'>)</span>,<span class='va'>median_star2</span><span class='op'>)</span>

<span class='va'>leaderboard</span>
</code></pre>
</div>
<pre><code># A tibble: 54 x 6
   user_name     user_id aoc_score total_stars median_star2 mean_star2
   &lt;chr&gt;         &lt;chr&gt;       &lt;int&gt;       &lt;int&gt; &lt;drtn&gt;       &lt;drtn&gt;    
 1 Colin Rundel  433087       5953          50  17.6 mins    89.0 mins
 2 Tom Jemmett   190599       5770          50  20.7 mins   219.8 mins
 3 Darrin Speeg~ 387786       5839          50  25.8 mins   320.7 mins
 4 Ildikó Czell~ 267475       5926          50  28.7 mins   412.5 mins
 5 pritikadasgu~ 1020187      5818          50  31.0 mins    96.1 mins
 6 Jaroslaw Nir~ 443063       6057          50  33.1 mins   447.1 mins
 7 Emil Hvitfel~ 433239       5922          50  34.5 mins   913.2 mins
 8 @ClareHorscr~ 1037870      6130          50  35.2 mins   594.9 mins
 9 @_TanHo       1032765      6040          50  86.0 mins   233.8 mins
10 Nerwosolek    1047933      5657          50 151.9 mins   653.2 mins
# ... with 44 more rows</code></pre>
</div>
<div class="sourceCode" id="cb123"><pre class="sourceCode r distill-force-highlighting-css"><code class="sourceCode r"></code></pre></div>
</div>
<div class="sourceCode" id="cb124"><pre class="sourceCode r distill-force-highlighting-css"><code class="sourceCode r"></code></pre></div>
<!--radix_placeholder_article_footer-->
<!--/radix_placeholder_article_footer-->
</div>

<div class="d-appendix">
</div>


<!--radix_placeholder_site_after_body-->
<!--/radix_placeholder_site_after_body-->
<!--radix_placeholder_appendices-->
<div class="appendix-bottom">
<h3 id="updates-and-corrections">Corrections</h3>
<p>If you see mistakes or want to suggest changes, please <a href="https://github.com/tanho63/advent_of_code/issues/new">create an issue</a> on the source repository.</p>
</div>
<!--/radix_placeholder_appendices-->
<!--radix_placeholder_navigation_after_body-->
<!--/radix_placeholder_navigation_after_body-->

</body>

</html>
